/*! JQuery Heavy Preloader | Daniele Fioroni | dfioroni91@gmail.com */(function(e,t,n,r){"use strict";if(!n)return console.error("jQuery is needed for $.fn.niteCrop() to work!"),r;var i={pipeline:!1,attributes:[],backgrounds:!1,playthrough:!1},s=function(e,n){var r=t.createElement(e);return r.canPlayType(e+"/"+n)},o={image:"jp[e]?g|gif|png|tif[f]?|bmp",audio:"mp3|ogg",video:"mp4|ogv|ogg|webm"},u=function(e){return/^data:/gi.test(e)?"":"#!nitePreloader"},a=function(e,t,r){var i=n.extend({warn:!1},r);e=e.toLowerCase().split("?")[0];if(e==="")return!1;var s=";base64,";if((new RegExp("(.("+o[t]+")$)|"+s,"g")).test(e)){if((new RegExp(s,"g")).test(e)){var u=e.match(new RegExp("^data:"+t+"/("+o[t]+")","g"));return!u||null===u?(console.warn(e+": base64 "+t+" format not recognized."),!1):(u=u[0],u.replace("data:"+t+"/g",""))}var a=e.match(new RegExp(o[t],"g"));return a?a[0]:!1}return i.warn&&console.warn(e+": file "+t+" not recognized."),!1},f=function(e,t,n,r){return e.on("load."+plugin_name+" error."+plugin_name,function(){r.call({type:"image",url:t,extension:n,naturalWidth:this.naturalWidth,naturalHeight:this.naturalHeight})}).attr("src",t).removeAttr("data-src"),e[0].complete===!0&&e.trigger("load."+plugin_name),e},l=function(e,t,r,i,s,o){var u=e[0],a=function(){f&&(u.currentTime=0);var s={};e.is("video")&&(s={naturalWidth:u.videoWidth,naturalHeight:u.videoHeight},u.naturalWidth=s.naturalWidth,u.naturalHeight=s.naturalHeight),i.call(n.extend(!0,{type:"audio/video",url:t,extension:r,duration:u.duration},s)),e.hasClass(plugin_name+"-temp")&&e.remove()},f=u.paused;return!0===s&&f&&u.load(),e.on("canplaythrough."+plugin_name,a).on("loadedmetadata."+plugin_name,function(){if(!o){a();return}f=u.paused,f&&u.currentTime++}).on("progress."+plugin_name,function(){if(!o)return;if(u.readyState>0&&!u.duration){a();return}f=u.paused,f&&u.currentTime++}),e},c=function(e,t,r){var i=n("<"+t+" />",{src:e,type:t+"/"+r,muted:!0,preload:"metadata"});return n("body").append(i.addClass(plugin_name+"-temp").css({width:2,height:1,visibility:"hidden",position:"absolute",left:-9999,top:-9999,zIndex:-1})),i},h=function(e){var t=this,r={},s=[];n.isArray(e)&&(s=e),typeof e=="string"&&s.push(e);var o=n.extend(!0,i,r),h=0,p=0,d=0,v=!1,m=function(){h++,d=h/y*100;if(h===y){t.done();return}o.pipeline===!0&&(p++,g(p,s[p]))},g=function(e,t){if(v)return;var r=n();switch(t.type){case"image":var i=!t.$el;r=i?n(new Image):t.$el,f(r,i?t.url+u(t.url):t.url,t.ext,function(){m.call({target:r,data:this})});break;case"audio/video":var s=!1;r=t.$el;if(!r.length)r=c(t.url+u(t.url),a(t.url,"audio")?"audio":"video",t.ext),s=!0;else{var h=r.find('source[type="audio/'+t.ext+'"], source[type="video/'+t.ext+'"]');h.length||(h=r.find('source[src*=".'+t.ext+'"], source[data-src*=".'+t.ext+'"]')),h.is("[src]")||(h.attr("src",t.url).removeAttr("data-src"),s=!0)}l(r,t.url,t.ext,function(){m.call({target:r,data:this})},s,o.playthrough)}},y=s.length;y?o.pipeline===!0?g(p,s[p]):n.each(s,g):this.done(),this.done=function(){},this.progress=function(){},this.abort=function(){}};n.nitePreload=h;var p=function(e,u){var f=n.extend(!0,i,u),l=[],c=function(e,t,r){if(!e||!t||!t.length)return;f.backgrounds&&(e=e.replace(/url\(\"|url\(\'|url\(|((\"|\')\)$)/igm,""));var i="_"+Math.round((new Date).getTime()+Math.random()*100)+"_";e=e.replace(new RegExp("("+o.image+"|"+o.audio+"|"+o.video+")(s|$|,)","igm"),function(e,t,n){return t+i}).split(new RegExp(i,"igm"));for(var u in e){var c=e[u],h=a(c,"audio"),p=a(c,"video"),d=a(c,"image");(d||p&&s("audio",h)||p&&s("audio",p))&&l.push(n.extend(!0,{$el:t},{url:c,type:r,ext:d||p||h}))}};f.attributes=typeof f.attributes=="string"?[f.attributes]:f.attributes;if(f.attributes&&!e.is("img")&&!e.is("audio")&&!e.is("video")&&!e.is("source"))for(var h in f.attributes){if(e.is("["+f.attributes[h]+"]")&&!e.is("img, audio, video, source")){var p=e.attr(f.attributes[h]);c(p,null,a(p,"image")?"image":"audio/video")}e.find("["+f.attributes[h]+"]:not(img, audio, video, source)").each(function(){var e=n(this).attr(f.attributes[h]);c(e,null,a(e,"image")?"image":"audio/video")})}if(e.is("video")||e.is("audio"))e.is("[src]")?c(n(this).attr("src"),e,"audio/video"):e.children("source").each(function(){var t=!1;n(this).is("[src]")&&(c(n(this).attr("src"),e,"audio/video"),t=!0);if(t)return!0;if(f.attributes)for(var i in f.attributes)n(this).is("["+f.attributes[i]+"]")&&(c(n(this).attr(f.attributes[i]),e,"audio/video"),t=!0);if(t)return!0;(r!==n.data(this,"src")||n(this).is("[data-src]"))&&c(n(this).data("src")||n(this).attr("data-src"),e,"audio/video")});if(e.is("source")){var d=!1;e.is("[src]")&&(c(e.attr("src"),e.closest("audio, video"),"audio/video"),d=!0);if(!d&&f.attributes)for(var h in f.attributes)e.is("["+f.attributes[h]+"]")&&(c(e.attr(f.attributes[h]),e.closest("audio, video"),"audio/video"),d=!0);!d&&(r!==n.data(e,"src")||e.is("[data-src]"))&&c(e.data("src")||e.attr("data-src"),e.closest("audio, video"),"audio/video")}e.find("video, audio").filter("[src]").each(function(){c(n(this).attr("src"),n(this),"audio/video")}).end().not("[src]").children("source").each(function(){var e=!1;n(this).is("[src]")&&(c(n(this).attr("src"),n(this).parent(),"audio/video"),e=!0);if(e)return!0;if(f.attributes)for(var t in f.attributes)n(this).is("["+f.attributes[t]+"]")&&(c(n(this).attr(f.attributes[t]),n(this).parent(),"audio/video"),e=!0);if(e)return!0;(r!==n.data(this,"src")||n(this).is("[data-src]"))&&c(n(this).data("src")||n(this).attr("data-src"),n(this).parent(),"audio/video")});if(e.is("img")){var d=!1;e.is("[src]")&&(c(e.attr("src"),e,"image"),d=!0),!d&&e.is("[srcset]")&&(c(e.prop("currentSrc")||e.prop("src"),e,"image"),d=!0);if(f.attributes)for(var h in f.attributes)e.is("["+f.attributes[h]+"]")&&(c(e.attr(f.attributes[h]),e,"image"),d=!0);!d&&(r!==n.data(e,"src")||e.is("[data-src]"))&&c(e.data("src")||e.attr("data-src"),e,"image")}return e.find("img").each(function(){var e=!1;n(this).is("[src]")&&(c(n(this).attr("src"),n(this),"image"),e=!0);if(e)return!0;n(this).is("[srcset]")&&(c(this.currentSrc||this.src,n(this),"image"),e=!0);if(e)return!0;if(f.attributes)for(var t in f.attributes)n(this).is("["+f.attributes[t]+"]")&&(c(n(this).attr(f.attributes[t]),n(this),"image"),e=!0);if(e)return!0;(r!==n.data(this,"src")||n(this).is("[data-src]"))&&c(n(this).data("src")||n(this).attr("data-src"),n(this),"image")}),f.backgrounds&&t!==e[0]&&e.css("background-image")!=="none"&&c(e.css("background-image"),null,"image"),f.backgrounds&&e.find("*:not(img)").filter(function(){return n(this).css("background-image")!=="none"}).each(function(){c(n(this).css("background-image"),null,"image")}),l};n.nitePreloaderFinder=p,n.fn.nitePreload=function(e,t){n.isFunction(e)&&r===t&&(t=e,e={});var s=n.extend(!0,i,e);return this.each(function(){var e=n(this),i=e.data("nitePreloader");r!==i&&i.abort(),i=new h(p(e,s)),i.progress(function(){}),i.done(function(){t.call(e[0])}),e.data("nitePreloader",i)})}})(window,document,jQuery);