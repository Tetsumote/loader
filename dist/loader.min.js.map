{"version":3,"sources":["loader.js"],"names":["_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","Constructor","protoProps","staticProps","prototype","_extends","assign","arguments","source","hasOwnProperty","call","_typeof","Symbol","iterator","obj","constructor","_classCallCheck","instance","TypeError","_toConsumableArray","arr","Array","isArray","arr2","from","global","factory","exports","module","define","amd","Loader","this","_polyfill","generateInstanceID","Math","floor","random","stringContains","heystack","needle","String","includes","indexOf","stringStartsWith","startsWith","substr","arrayFindIndex","filter","findIndex","index","hyphensToCamelCase","string","replace","g","toUpperCase","capitalize","charAt","slice","nodelistToArray","nodelist","concat","isInArray","privateCache","intersectionObserverSupported","window","pictureElementSupported","isVisible","element","intersectionRatio","getComputedStyle","bodyEl","document","getElementsByTagName","winWidth","innerWidth","documnt","documentElement","clientWidth","winHeight","innerHeight","clientHeight","rect","getBoundingClientRect","right","bottom","left","top","isHTMLElement","HTMLElement","e","nodeType","style","ownerDocument","isLoaded","currentSrc","complete","readyState","isFullyBuffered","media","buffered","round","end","seekable","pluginInstance","supportedExtensions","image","audio","video","supportedTags","privateEventsStorage","CustomEvent$1","CustomEvent","event","params","bubbles","cancelable","detail","undefined","evt","createEvent","initCustomEvent","Event","detachEventListener","events","eventNameWithNamespace","type","split","join","removeEventListener","handler","attachEventListener","once","count","_handler","addEventListener","SingleLoader","options","_this","_settings","srcAttr","srcsetAttr","playthrough","visible","Error","_id","_idEvent","_busy","_element","_resource","_format","_observer","_observing","_done","_success","_error","_callback","unobserve","src","push","thisArguments","apply","value","_this2","_exists","_consistent","naturalWidth","videoWidth","_originalElement","picture","closest","dataset","querySelectorAll","forEach","el","setAttribute","matches","isStandardPlaythrough","isFullPlaythrough","sources","callMediaLoad","thisSource","load","onProgressReplacementInterval","setInterval","isError","duration","currentTime","paused","play","clearInterval","pause","callback","status","resource","id","getAttribute","srcset","removeAttribute","set","data","_this3","info","output","format","extension","tag","consistent","formatCandidate","RegExp","test","matches64","match","tagName","toLowerCase","allTags","values","tags","decodeResource","_tag","createElement","IntersectionObserver","entries","observer","entry","process","root","rootMargin","threshold","observe","get","_collection","_collectionLoaded","_collectionInstances","_collectionPending","_resourcesLoaded","backgrounds","percentage","_progress","_loop","_abort","_loaded","_complete","_this4","sequentialMode","sequential","thisLoadId","thisLoadIndex","x","thisLoadInstance","done","aProgress","parseFloat","toFixed","thisResource","dispatchEvent","resources","thisInstance","abort","collection","_this5","collectedResources","findResources","err","item","settings","body","targetsExtended","targets","targetsFilter","targetsTags","children","targetSource","targetsBg","backgroundImage","url"],"mappings":"AAAA,aAEA,IAAIA,aAAe,WAAc,SAASC,EAAiBC,EAAQC,GAAS,IAAK,IAAIC,EAAI,EAAGA,EAAID,EAAME,OAAQD,IAAK,CAAE,IAAIE,EAAaH,EAAMC,GAAIE,EAAWC,WAAaD,EAAWC,aAAc,EAAOD,EAAWE,cAAe,EAAU,UAAWF,IAAYA,EAAWG,UAAW,GAAMC,OAAOC,eAAeT,EAAQI,EAAWM,IAAKN,IAAiB,OAAO,SAAUO,EAAaC,EAAYC,GAAiJ,OAA9HD,GAAYb,EAAiBY,EAAYG,UAAWF,GAAiBC,GAAad,EAAiBY,EAAaE,GAAqBF,GAA7gB,GAEfI,SAAWP,OAAOQ,QAAU,SAAUhB,GAAU,IAAK,IAAIE,EAAI,EAAGA,EAAIe,UAAUd,OAAQD,IAAK,CAAE,IAAIgB,EAASD,UAAUf,GAAI,IAAK,IAAIQ,KAAOQ,EAAcV,OAAOM,UAAUK,eAAeC,KAAKF,EAAQR,KAAQV,EAAOU,GAAOQ,EAAOR,IAAY,OAAOV,GAEnPqB,QAA4B,mBAAXC,QAAoD,iBAApBA,OAAOC,SAAwB,SAAUC,GAAO,cAAcA,GAAS,SAAUA,GAAO,OAAOA,GAAyB,mBAAXF,QAAyBE,EAAIC,cAAgBH,QAAUE,IAAQF,OAAOR,UAAY,gBAAkBU,GAEtQ,SAASE,gBAAgBC,EAAUhB,GAAe,KAAMgB,aAAoBhB,GAAgB,MAAM,IAAIiB,UAAU,qCAEhH,SAASC,mBAAmBC,GAAO,GAAIC,MAAMC,QAAQF,GAAM,CAAE,IAAK,IAAI5B,EAAI,EAAG+B,EAAOF,MAAMD,EAAI3B,QAASD,EAAI4B,EAAI3B,OAAQD,IAAO+B,EAAK/B,GAAK4B,EAAI5B,GAAM,OAAO+B,EAAe,OAAOF,MAAMG,KAAKJ,IAE1L,SAAWK,EAAQC,GACuD,YAAlD,oBAAZC,QAA0B,YAAchB,QAAQgB,WAA4C,oBAAXC,OAAyBA,OAAOD,QAAUD,IAA8B,mBAAXG,QAAyBA,OAAOC,IAAMD,OAAO,SAAUH,GAAWD,EAAOM,OAASL,IAD5O,CAEGM,KAAM,WAOL,IA8JQC,EA9JJC,EAAqB,WACrB,OAAOC,KAAKC,MAAsB,KAAhBD,KAAKE,UAA4B,KAQnDC,EAAiB,SAAwBC,EAAUC,GACnD,OAAOC,OAAOrC,UAAUsC,SAAWH,EAASG,SAASF,IAA2C,IAAjCD,EAASI,QAAQH,EAAQ,IAQxFI,EAAmB,SAA0BL,EAAUC,GACvD,OAAOC,OAAOrC,UAAUyC,WAAaN,EAASM,WAAWL,GAAUD,EAASO,OAAO,EAAGN,EAAO/C,UAAY+C,GAQzGO,EAAiB,SAAwBR,EAAUS,GACnD,OAAO3B,MAAMjB,UAAU6C,UAAYV,EAASU,UAAUD,GAAU,WAG5D,IAFA,IAAIvD,EAAS8C,EAAS9C,OAClByD,GAAS,IACJA,EAAQzD,GACb,GAAIuD,EAAOT,EAASW,GAAQA,EAAOX,GAC/B,OAAOW,EAGf,OAAQ,EARoD,IAgBhEC,EAAqB,SAA4BC,GACjD,OAAOA,EAAOC,QAAQ,YAAa,SAAUC,GACzC,OAAOA,EAAE,GAAGC,iBAQhBC,EAAa,SAAoBJ,GACjC,OAAOA,EAAOK,OAAO,GAAGF,cAAgBH,EAAOM,MAAM,IAOrDC,EAAkB,SAAyBC,GAC3C,SAAUC,OAAO1C,mBAAmByC,KAQpCE,EAAY,SAAmBtB,EAAQD,GACvC,OAAOA,EAASI,QAAQH,IAAW,GAGnCuB,KAEAC,EAAgC,yBAA0BC,OAC1DC,EAA0B,uBAAwBD,OAMlDE,EAAY,SAAmBC,GAC/B,GAAIJ,GAAiC,sBAAuBI,EACxD,OAAOA,EAAQC,kBAAoB,EAGvC,GAAoD,SAAhDJ,OAAOK,iBAAiBF,EAAS,WACjC,OAAO,EAGX,IAAIG,EAASC,SAASC,qBAAqB,QAAQ,GAC/CC,EAAWT,OAAOU,YAAcC,QAAQC,gBAAgBC,aAAeP,EAAOO,YAC9EC,EAAYd,OAAOe,aAAeJ,QAAQC,gBAAgBI,cAAgBV,EAAOU,aACjFC,EAAOd,EAAQe,wBAEnB,QAASD,EAAKE,MAAQ,GAAKF,EAAKG,OAAS,GAAKH,EAAKI,KAAOZ,GAAYQ,EAAKK,IAAMR,IAOjFS,EAAgB,SAAuBpB,GACvC,GAA0E,iBAAlD,IAAZA,EAA0B,YAAczD,QAAQyD,IACxD,OAAO,EAEX,IACI,OAAOA,aAAmBqB,YAC5B,MAAOC,GACL,OAA4B,IAArBtB,EAAQuB,UAA6C,WAA3BhF,QAAQyD,EAAQwB,QAA0D,WAAnCjF,QAAQyD,EAAQyB,iBAQ5FC,EAAW,SAAkBtF,GAC7B,MAAyB,iBAAXA,GAAuBsD,EAAUtD,EAAQuD,IAAiByB,EAAchF,IAAW,eAAgBA,GAAUA,EAAOuF,WAAWtG,OAAS,IAAM,aAAce,GAAUA,EAAOwF,UAAY,eAAgBxF,GAAUA,EAAOyF,YAAc,IAOtPC,EAAkB,SAAyBC,GAC3C,OAAOA,EAAMC,SAAS3G,QAAU0C,KAAKkE,MAAMF,EAAMC,SAASE,IAAI,IAAMnE,KAAKkE,MAAMF,EAAMI,SAASD,IAAI,KAAQ,GAW1GE,EAAiBtE,IAGjBuE,GACAC,MAAO,oEACPC,MAAO,0BACPC,MAAO,gBAGPC,GACAH,MAAO,qBACPC,MAAO,eACPC,MAAO,gBAGPE,KAEAC,EAAgB9C,OAAO+C,eACnB/E,EAAY,SAAmBgF,EAAOC,GACtCA,EAASA,IAAYC,SAAS,EAAOC,YAAY,EAAOC,YAAQC,GAChE,IAAIC,EAAM/C,SAASgD,YAAY,eAE/B,OADAD,EAAIE,gBAAgBR,EAAOC,EAAOC,QAASD,EAAOE,WAAYF,EAAOG,QAC9DE,IAEDnH,UAAY6D,OAAOyD,MAAMtH,UAC5B6B,GAQP0F,EAAsB,SAASA,EAAoBvD,EAASwD,GAC5D,GAAKxD,GAA6B,iBAAXwD,EAIvB,GAAIhF,EAAiBgF,EAAQ,KACzB,IAAK,IAAI5H,KAAO8G,EAAsB,CAClC,IAAIe,EAAyB7H,EAAIqD,QAvCT,gBAuCgD,KACpEf,EAAeuF,EAAwBD,IAAWd,EAAqB9G,GAAKoE,UAAYA,GACxFuD,EAAoBvD,EAASyD,OAGlC,CAGH,IAAIC,GAFJF,EAASA,EAAOG,MAAM,MAEJ,GACFH,EAAO,KAGnBA,EAASA,EAAOI,KAnDQ,kBAsDxBJ,KAAUd,IACV1C,EAAQ6D,oBAAoBH,EAAMhB,EAAqBc,GAAQM,gBACxDpB,EAAqBc,MAapCO,EAAsB,SAA6B/D,EAASwD,EAAQM,EAASE,GAC7E,GAAKhE,GAA6B,iBAAXwD,GAA0C,mBAAZM,EAArD,CAMA,IAAIJ,GAFJF,EAASA,EAAOG,MAAM,MAEJ,GASlB,GARgBH,EAAO,KAGnBA,EAASA,EAAOI,KAhFY,kBAmFhClB,EAAqBc,IAAYxD,QAASA,EAASiE,MAAO,EAAGD,MAAM,IAE/D,IAASA,EAAM,CACf,IAAIE,EAAWJ,EACfA,EAAU,SAAiBjB,GACvB,GAAIW,KAAUd,EAAsB,CAEhC,GADAA,EAAqBc,GAAQS,QACzBvB,EAAqBc,GAAQQ,MAAQtB,EAAqBc,GAAQS,MAAQ,EAC1E,OAEJC,EAAS5H,KAAKsB,KAAMiF,GAExBU,EAAoBvD,EAASwD,SAGjCQ,GAAO,EAGXtB,EAAqBc,GAAUvH,YAAayG,EAAqBc,IAAWM,QAASA,EAASE,KAAMA,IAEpGhE,EAAQmE,iBAAiBT,EAAMhB,EAAqBc,GAAQM,SAAWE,KAAMA,MAkF7EI,EAAe,WAIf,SAASA,EAAaC,GAClB,IAAIC,EAAQ1G,KAWZ,GATAhB,gBAAgBgB,KAAMwG,GAEtBxG,KAAK2G,UAAYtI,UACbuI,QAAS,WACTC,WAAY,cACZC,aAAa,EACbC,SAAS,GACVN,IAEE7F,EAAiBZ,KAAK2G,UAAUC,QAAS,WAAahG,EAAiBZ,KAAK2G,UAAUE,WAAY,SACnG,MAAM,IAAIG,MAAM,qFAGpBhH,KAAK4G,QAAUzF,EAAmBnB,KAAK2G,UAAUC,QAAQvF,QAAQ,QAAS,KAC1ErB,KAAK6G,WAAa1F,EAAmBnB,KAAK2G,UAAUE,WAAWxF,QAAQ,QAAS,KAEhFrB,KAAKiH,IAAM,KACXjH,KAAKkH,SAAW,KAChBlH,KAAKmH,OAAQ,EAEbnH,KAAKoH,SAAW,KAChBpH,KAAKqH,UAAY,KACjBrH,KAAKsH,QAAU,KACftH,KAAKuH,UAAY,KAEjBvH,KAAKwH,YAAa,EAElBxH,KAAKyH,MAAQ,aACbzH,KAAK0H,SAAW,aAChB1H,KAAK2H,OAAS,aAEd3H,KAAK4H,UAAY,SAAUlE,GACvBgD,EAAMS,OAAQ,EACV,OAAST,EAAMa,WACfb,EAAMa,UAAUM,UAAUnB,EAAMU,UAGpC,IAAIU,EAAMpB,EAAMU,SAASrD,YAAc2C,EAAMU,SAASU,IAEjDhG,EAAUgG,EAAK/F,IAChBA,EAAagG,KAAKD,GAGtB,IAAIE,GAAiBtB,EAAMU,SAAU1D,EAAEoC,KAAMgC,EAAKpB,EAAMO,KAExDP,EAAiB,UAAXhD,EAAEoC,KAAmB,WAAa,UAAUmC,MAAMvB,EAAOsB,GAC/DtB,EAAMe,MAAMQ,MAAMvB,EAAOsB,IAgSjC,OAvRA5K,aAAaoJ,IACTxI,IAAK,UACLkK,MAAO,WACHlI,KAAKwH,YAAa,KAGtBxJ,IAAK,YACLkK,MAAO,WACHlI,KAAKwH,YAAa,KAQtBxJ,IAAK,UAMLkK,MAAO,WACH,IAnRqB1J,EAmRjB2J,EAASnI,KAWb,GAAI8D,EAAS9D,KAAKoI,SAAWpI,KAAKqI,YAAcrI,KAAKoH,SAAWpH,KAAKqH,WAQjE,OAPKrH,KAAKmH,OAENxB,EAAoB3F,KAAKoH,SAAU,IAAMpH,KAAKkH,UAGlDlH,KAAK4H,UAAU,IAAI7C,GApSFvG,EAoS0BwB,KAAKoI,SAAWpI,KAAKqI,YAAcrI,KAAKoH,SAAWpH,KAAKqH,UAnSxGvD,EAAStF,KAAYgF,EAAchF,KAAY,iBAAkBA,GAA8C,IAApC2B,KAAKC,MAAM5B,EAAO8J,eAAuB,eAAgB9J,GAAgC,IAAtBA,EAAO+J,aAAuC,iBAAX/J,GAmSnD,QAAT,WAEzG,EACJ,GAAIwB,KAAKoI,SAAWpI,KAAK2G,UAAUI,UAAY5E,EAAUnC,KAAKwI,kBACjE,OAAO,EAEP,GAAqB,UAAjBxI,KAAKsH,QAAqB,CAC1BnB,EAAoBnG,KAAKoH,SAAU,QAAUpH,KAAKkH,SAAUlH,KAAK4H,WAAY5H,KAAKmH,OAClFhB,EAAoBnG,KAAKoH,SAAU,SAAWpH,KAAKkH,SAAUlH,KAAK4H,WAAY5H,KAAKmH,OAEnF,IAAIsB,EAAUzI,KAAKoH,SAASsB,QAAQ,WAEhCD,GAAWvG,UACJlC,KAAKoH,SAASuB,QAAQ3I,KAAK6G,mBAC3B7G,KAAKoH,SAASuB,QAAQ3I,KAAK4G,SAElC6B,EAAQG,iBAAiB,UAAY5I,KAAK2G,UAAUE,WAAa,KAAKgC,QAAQ,SAAUC,GACpFA,EAAGC,aAAa,SAAUD,EAAGH,QAAQR,EAAOvB,iBACrCkC,EAAGH,QAAQR,EAAOvB,aAGzB5G,KAAKoH,SAAS4B,QAAQ,IAAMhJ,KAAK2G,UAAUE,WAAa,OACxD7G,KAAKoH,SAAS2B,aAAa,SAAU/I,KAAKoH,SAASuB,QAAQ3I,KAAK6G,oBACzD7G,KAAKoH,SAASuB,QAAQ3I,KAAK6G,aAGlC7G,KAAKoH,SAAS4B,QAAQ,IAAMhJ,KAAK2G,UAAUC,QAAU,OACrD5G,KAAKoH,SAAS2B,aAAa,MAAO/I,KAAKoH,SAASuB,QAAQ3I,KAAK4G,iBACtD5G,KAAKoH,SAASuB,QAAQ3I,KAAK4G,eAGvC,CAAA,GAAqB,UAAjB5G,KAAKsH,SAAwC,UAAjBtH,KAAKsH,QA4FxC,OAAO,EA3FP,IAAI2B,GAAwB,IAASjJ,KAAK2G,UAAUG,YAChDoC,EAAoB,SAAWlJ,KAAK2G,UAAUG,YAC9CqC,EAAUnJ,KAAKoH,SAASwB,iBAAiB,UAEzCQ,GAAgB,EAEhBD,EACAA,EAAQN,QAAQ,SAAUrK,GAClBA,EAAOwK,QAAQ,IAAMb,EAAOxB,UAAUC,QAAU,OAChDpI,EAAOuK,aAAa,MAAOvK,EAAOmK,QAAQR,EAAOvB,iBAC1CpI,EAAOmK,QAAQR,EAAOtB,YAE7BuC,GAAgB,GAGpBjD,EAAoB3H,EAAQ,SAAW2J,EAAOjB,SAAU,SAAUxD,GAG9DlF,EAAOgG,EAAiB,0BAAwB,EAE5C2E,EAAQ1L,SAAWkE,EAAgBwH,GAASnI,OAAO,SAAUqI,GAC7D,OAAO,IAASA,EAAW7E,EAAiB,2BAC7C/G,QACC0K,EAAOP,UAAUlE,KAErByE,EAAOhB,SAGRnH,KAAKoH,SAAS4B,QAAQ,IAAMhJ,KAAK2G,UAAUC,QAAU,OAC5D5G,KAAKoH,SAAS2B,aAAa,MAAO/I,KAAKoH,SAASuB,QAAQ3I,KAAK4G,iBACtD5G,KAAKoH,SAASuB,QAAQ3I,KAAK4G,SAElCT,EAAoBnG,KAAKoH,SAAU,SAAWpH,KAAKkH,SAAUlH,KAAK4H,WAAY5H,KAAKmH,OAGnFiC,GAAgB,GAGhBA,GACApJ,KAAKoH,SAASkC,OAGlBnD,EAAoBnG,KAAKoH,SAAU,kBAAoBpH,KAAKkH,SAAU,WAKlE,GAJK+B,GAA0BC,GAC3Bf,EAAOP,UAAU,IAAI7C,EAAc,SAGnCmE,EAAmB,CACnB,IAAIK,EAAgCC,YAAY,WAC5C,IAAIC,EAAUtB,EAAOf,SAASnD,WAAa,IAAMkE,EAAOf,SAASsC,SAE7DD,GAAWvF,EAAgBiE,EAAOf,WAClCe,EAAOf,SAASuC,YAAc,GAEzBF,IAAYtB,EAAOhB,OAASgB,EAAOf,SAASwC,QAAUzB,EAAOf,SAAS4B,QAAQ,eAC/Eb,EAAOf,SAASyC,OAGpBC,cAAcP,GAEdpB,EAAOP,UAAU,IAAI7C,EAAe0E,EAAmB,QAAT,WAEzCtB,EAAOf,SAASwC,QACjBzB,EAAOf,SAAS2C,QAGf5B,EAAOhB,QACRgB,EAAOf,SAASuC,aAAe,KAGxC,KAEHxB,EAAOf,SAAS,kBAAoBe,EAAOjB,UAAYqC,KAE3DvJ,KAAKmH,OAGThB,EAAoBnG,KAAKoH,SAAU,WAAapH,KAAKkH,SAAU,WACvDgC,GAAqD,IAAhCf,EAAOf,SAASuC,cAAsBzF,EAAgBiE,EAAOf,WAClFe,EAAOf,SAASuC,gBAEpB3J,KAAKmH,OAGThB,EAAoBnG,KAAKoH,SAAU,kBAAoBpH,KAAKkH,SAAU,WAC9D+B,GACAd,EAAOP,UAAU,IAAI7C,EAAc,WAEvC/E,KAAKmH,OAajB,OAPSnH,KAAKmH,QACNnH,KAAKoH,SAAS5C,EAAiB,YAAcxE,KAAKkH,UAI1DlH,KAAKqH,UAAYrH,KAAKoH,SAASrD,YAAc/D,KAAKoH,SAASU,KAEnD9H,KAAKmH,SASjBnJ,IAAK,OACLkK,MAAO,SAAc8B,GACO,mBAAbA,IAIXhK,KAAKyH,MAAQ,SAAUrF,EAAS6H,EAAQC,EAAUC,GAC9CH,EAAS/B,MAAMjI,MAAOoC,EAAS6H,EAAQC,EAAUC,SASzDnM,IAAK,QACLkK,MAAO,WAGH,GAFAvC,EAAoB3F,KAAKoH,SAAU,IAAMpH,KAAKkH,WAE1CpD,EAAS9D,KAAKoI,QAAUpI,KAAKoH,SAAWpH,KAAKqH,WAAjD,CAIA,IAAIS,EAAM9H,KAAKoH,SAASgD,aAAa,UACjCC,EAASrK,KAAKoH,SAASgD,aAAa,YAEpC9E,IAAcwC,IACd9H,KAAKoH,SAASuB,QAAQ3I,KAAK4G,SAAWkB,EACtC9H,KAAKoH,SAAS2B,aAAa/I,KAAK2G,UAAUC,QAASkB,GACnD9H,KAAKoH,SAASkD,gBAAgB,OAC9BtK,KAAKoH,SAASkD,gBAAgB,gBAG9BhF,IAAc+E,IACdrK,KAAKoH,SAASuB,QAAQ3I,KAAK6G,YAAcwD,EACzCrK,KAAKoH,SAAS2B,aAAa/I,KAAK2G,UAAUE,WAAYwD,GACtDrK,KAAKoH,SAASkD,gBAAgB,OAC9BtK,KAAKoH,SAASkD,gBAAgB,eAItCtM,IAAK,WACLuM,IAAK,SAAaC,GACd,IAAIC,EAASzK,KAEb,GAAoE,iBAA/C,IAATwK,EAAuB,YAAc7L,QAAQ6L,KAAuB,OAAQA,GAAQ,YAAaA,GAAQ,aAAcA,EAAM,CACrIxK,KAAKiH,IAAMuD,EAAKL,GAChBnK,KAAKoH,SAAWoD,EAAKpI,QACrBpC,KAAKqH,UAAYmD,EAAKN,SAEtBlK,KAAKmH,WAA0B7B,IAAlBtF,KAAKkH,SAIlB,IAAIwD,EAtXC,SAAwBR,GACzC,IAAIS,GAAWC,OAAQ,KAAMC,UAAW,KAAMC,IAAK,KAAMC,YAAY,GAIrE,IAAK,IAAIC,KAFTd,EAASA,SAAWA,EAASA,SAASnE,MAAM,KAAK,GACjDmE,EAASA,SAAWA,EAASA,SAASnE,MAAM,KAAK,GACrBtB,EAGxB,GAAI,IAAIwG,OAAO,MAAQxG,EAAoBuG,GAAmB,eAAwB,KAAKE,KAAKhB,EAASA,UAAW,CAChH,GAAI,IAAIe,OAHQ,WAGc,KAAKC,KAAKhB,EAASA,UAAW,CACxD,IAAIiB,EAAYjB,EAASA,SAASkB,MAAM,IAAIH,OAAO,SAAWD,EAAkB,KAAOvG,EAAoBuG,GAAmB,IAAK,MAEnI,GAAI,OAASG,EACT,OAGJA,EAAYA,EAAU,GAEtBR,EAAOC,OAASI,EAChBL,EAAOE,UAAYM,EAAU9J,QAAQ,QAAU2J,EAAkB,IAAK,IACtEL,EAAOG,IAAMjG,EAAcmG,GAE3B,MAEA,IAAIhC,EAAUkB,EAASA,SAASkB,MAAM,IAAIH,OAAOxG,EAAoBuG,GAAkB,MAEvF,GAAIhC,EAAS,CACT2B,EAAOC,OAASI,EAChBL,EAAOE,UAAY7B,EAAQ,GAC3B2B,EAAOG,IAAMjG,EAAcmG,GAE3B,OAMhB,GAAIxH,EAAc0G,EAAS9H,SAAU,CACjC,IAAIiJ,EAAUnB,EAAS9H,QAAQiJ,QAAQC,cACnCC,EAAU,GAQd,GANAzN,OAAO0N,OAAO3G,GAAegE,QAAQ,SAAU4C,GAC3CF,GAAW,IAAME,IAGrBF,EAAUA,EAAQxF,MAAM,KAEpBjE,EAAUuJ,EAASE,KACnBZ,EAAOG,IAAMO,EACbV,EAAOI,YAAa,EACE,OAAlBJ,EAAOC,QACP,IAAK,IAAIA,KAAU/F,EACf,GAAIvE,EAAeuE,EAAc+F,GAASD,EAAOG,KAAM,CACnDH,EAAOC,OAASA,EAChB,OAWpB,OAJItK,EAAeqK,EAAOG,IAAK,OAC3BH,EAAOG,IAAMH,EAAOG,IAAI/E,MAAM,KAAK,IAGhC4E,EAqTgBe,EACPxB,SAAUlK,KAAKqH,UACfjF,QAASpC,KAAKoH,WAElBpH,KAAK2L,KAAOjB,EAAKI,IACjB9K,KAAKqI,YAAcqC,EAAKK,WACxB/K,KAAKsH,QAAUoD,EAAKE,OACpB5K,KAAKoI,QAA4B,OAAlBpI,KAAKoH,SACpBpH,KAAKwI,iBAAmBxI,KAAKoH,SAExBpH,KAAKoI,SAAYpI,KAAKqI,cACvBrI,KAAKoH,SAAW5E,SAASoJ,cAAc5L,KAAK2L,MAC5C3L,KAAKoH,SAASuB,QAAQ3I,KAAK4G,SAAW5G,KAAKqH,WAG/CrH,KAAKkH,SAAWlH,KAAKmH,MAAQnH,KAAKoH,SAAS5C,EAAiB,YAAc,yBAA2BxE,KAAKoH,SAASiE,QAAU,IAAMnL,IAI/HF,KAAKoI,SAAWpI,KAAK2G,UAAUI,SAAW/E,IAC1ChC,KAAKuH,UAAY,IAAIsE,qBAAqB,SAAUC,EAASC,GACzDD,EAAQjD,QAAQ,SAAUmD,GACtBA,EAAM1O,OAAO+E,kBAAoB2J,EAAM3J,kBAEnCoI,EAAOjD,YACPiD,EAAOwB,cAIfC,KAAM,KACNC,WAAY,MACZC,UAAW,KAEfpM,KAAKuH,UAAU8E,QAAQrM,KAAKwI,qBAIxC8D,IAAK,WACD,OAAOtM,KAAKqH,cAIbb,EArVQ,GAquBnB,OApYa,WAIT,SAASzG,EAAO0G,GAmBZ,GAlBAzH,gBAAgBgB,KAAMD,GAEtBC,KAAKuM,eACLvM,KAAKwM,qBACLxM,KAAKyM,wBACLzM,KAAK0M,sBACL1M,KAAK2M,oBAEL3M,KAAKwH,YAAa,EAElBxH,KAAK2G,UAAYtI,UACbuI,QAAS,WACTC,WAAY,cACZC,aAAa,EACbC,SAAS,EACT6F,aAAa,GACdnG,IAEE7F,EAAiBZ,KAAK2G,UAAUC,QAAS,WAAahG,EAAiBZ,KAAK2G,UAAUE,WAAY,SACnG,MAAM,IAAIG,MAAM,qFAGpBhH,KAAK4G,QAAUzF,EAAmBnB,KAAK2G,UAAUC,QAAQvF,QAAQ,QAAS,KAC1ErB,KAAK6G,WAAa1F,EAAmBnB,KAAK2G,UAAUE,WAAWxF,QAAQ,QAAS,KAEhFrB,KAAK6M,WAAa,EAElB7M,KAAKyH,MAAQ,aACbzH,KAAK8M,UAAY,aACjB9M,KAAK0H,SAAW,aAChB1H,KAAK2H,OAAS,aACd3H,KAAK+M,MAAQ/M,KAAKsJ,KAElBtJ,KAAKgN,QAAS,EACdhN,KAAKiN,QAAU,EACfjN,KAAKkN,WAAY,EACjBlN,KAAKmH,OAAQ,EAwVjB,OA9UA/J,aAAa2C,IACT/B,IAAK,UACLkK,MAAO,eAOPlK,IAAK,UACLkK,MAAO,WACHlI,KAAKwH,YAAa,KAGtBxJ,IAAK,YACLkK,MAAO,WACHlI,KAAKwH,YAAa,KAQtBxJ,IAAK,OACLkK,MAAO,WACH,IAAIiF,EAASnN,KAERA,KAAKuM,YAAY9O,QAClBuC,KAAKyH,MAAM/I,KAAKsB,KAAMA,KAAK2M,kBAI/B3M,KAAK0M,sBAsFL,IApFA,IAAIU,GAAiB,IAASpN,KAAK2G,UAAU0G,WAEzCN,EAAQ,SAAevP,GACvB,GAAI2P,EAAOH,OACP,MAAO,QAGX,IAAIM,EAAaH,EAAOZ,YAAY/O,GAAG2M,GACnCoD,EAAgBxM,EAAeoM,EAAOV,qBAAsB,SAAUe,GACtE,OAAOA,EAAErD,KAAOmD,IAEhBG,EAAmB,IAAIjH,EAAa2G,EAAOxG,WAE3CwG,EAAO3F,YACPiG,EAAiBpB,WAGE,IAAnBkB,GACAJ,EAAOV,qBAAqB1E,MACxBoC,GAAImD,EACJrO,SAAUwO,IAEdF,EAAgBxM,EAAeoM,EAAOV,qBAAsB,SAAUe,GAClE,OAAOA,EAAErD,KAAOmD,KAGpBH,EAAOV,qBAAqBc,GAAetO,SAAWwO,EAG1DA,EAAiBvD,SAAWiD,EAAOZ,YAAY/O,GAE/CiQ,EAAiBC,KAAK,SAAUtL,EAAS6H,EAAQC,EAAUC,GACvD,IAAIgD,EAAOD,YAAaC,EAAOH,OAA/B,CAIA,IAAIW,GAAa7L,EAAUqI,EAAIgD,EAAOX,mBAEtC,GAAImB,EAAW,CACXR,EAAOX,kBAAkBzE,KAAKoC,GAC9BgD,EAAOhG,OAAQ,EAEfgG,EAAOF,UACPE,EAAON,WAAaM,EAAOF,QAAUE,EAAOZ,YAAY9O,OAAS,IACjE0P,EAAON,WAAae,WAAWT,EAAON,WAAWgB,QAAQ,IAEzD,IAAIC,GACA5D,SAAUA,EACVD,OAAQA,EACR7H,QAASA,GAEb+K,EAAOR,iBAAiB5E,KAAK+F,GAC7BX,EAAOL,UAAUpO,KAAKyO,EAAQW,GAC9BX,EAAkB,UAAXlD,EAAqB,WAAa,UAAUvL,KAAKyO,EAAQW,GAEhE1L,EAAQ2L,cAAc,IAAI/I,YAAY,WAAaxD,EAAWyI,IAAW5E,OAAQyI,KACjFtL,SAASuL,cAAc,IAAI/I,YAAY,WAAaxD,EAAWyI,IAAW5E,OAAQyI,KAGlFX,EAAOF,UAAYE,EAAOZ,YAAY9O,QACtC0P,EAAO1F,MAAM/I,KAAKyO,EAAQA,EAAOR,kBAEjCQ,EAAOD,WAAY,GACZS,GAAaP,GAAkBD,EAAOT,mBAAmBjP,SAChE0P,EAAOT,mBAAqBS,EAAOT,mBAAmB1L,OAAO,SAAUwM,GACnE,OAAOA,EAAErD,KAAOA,IAGhBgD,EAAOT,mBAAmBjP,SAC1B0P,EAAOhG,MAAQgG,EAAOT,mBAAmB,GAAGzN,SAASgN,gBAK5DmB,GAAkBA,IAAmBD,EAAOhG,MAC7CgG,EAAOhG,MAAQsG,EAAiBxB,UACzBmB,GAAkBD,EAAOhG,SAAWgG,EAAOxG,UAAUI,UAAY0G,EAAiBrF,SAAW+E,EAAOxG,UAAUI,SAAW0G,EAAiBrF,SAAWjG,EAAUsL,EAAiBjF,oBACvL2E,EAAOT,mBAAmB3E,MACtBoC,GAAImD,EACJrO,SAAUwO,KAKbjQ,EAAI,EAAGA,EAAIwC,KAAKuM,YAAY9O,OAAQD,IAAK,CAG9C,GAAa,UAFFuP,EAAMvP,GAEK,UAU9BQ,IAAK,OACLkK,MAAO,SAAc8B,GACO,mBAAbA,IAIXhK,KAAKyH,MAAQ,SAAUuG,GACnBhE,EAAStL,KAAKsB,KAAMgO,QAU5BhQ,IAAK,WACLkK,MAAO,SAAkB8B,GACG,mBAAbA,IAIXhK,KAAK8M,UAAY,SAAU5C,GACvBF,EAAStL,KAAKsB,KAAMkK,QAU5BlM,IAAK,UACLkK,MAAO,SAAiB8B,GACI,mBAAbA,IAIXhK,KAAK0H,SAAW,SAAUwC,GACtBF,EAAStL,KAAKsB,KAAMkK,QAU5BlM,IAAK,QACLkK,MAAO,SAAe8B,GACM,mBAAbA,IAIXhK,KAAK2H,OAAS,SAAUuC,GACpBF,EAAStL,KAAKsB,KAAMkK,QAS5BlM,IAAK,QACLkK,MAAO,WACHlI,KAAKyM,qBAAqB5D,QAAQ,SAAUoF,GACxCA,EAAahP,SAASiP,UAG1BlO,KAAKgN,QAAS,KAGlBhP,IAAK,aACLuM,IAAK,SAAa4D,GACd,IAAIC,EAASpO,KAETqO,EAAqBF,EAEzB,IACIE,EAAqBtO,EAAOuO,cAAcH,EAAYnO,KAAK2G,WAC7D,MAAO4H,IAETF,EAAmBxF,QAAQ,SAAU2F,GACjC,IAAIpM,GACA8H,SAAU,GACV9H,QAAS,KACT+H,GAAIjK,KAGR,GAAoB,iBAATsO,EACPpM,EAAQ8H,SAAWsE,MAChB,CAAA,KAAoE,iBAA/C,IAATA,EAAuB,YAAc7P,QAAQ6P,KAAuB,aAAcA,GAGjG,OAFApM,EAAU/D,YAAa+D,EAASoM,GAKpCJ,EAAO7B,YAAYxE,KAAK3F,MAQhCkK,IAAK,WACD,OAAOtM,KAAKuM,iBAGhBvO,IAAK,gBACLkK,MAAO,SAAuB9F,EAASqE,GACnC,IAAIgI,GACA7H,QAAS,MACTC,WAAY,SACZ+F,aAAa,GAGjB,GAA0E,iBAAlD,IAAZxK,EAA0B,YAAczD,QAAQyD,UAA0BkD,IAAcmB,EAChG,IAAK,IAAIzI,KAAOyQ,EACZ,GAAIzQ,KAAOoE,EAAS,CAChBqE,EAAUrE,EACVA,OAAUkD,EACV,MASZ,QAJIA,IAAclD,GAAWA,IAAYI,WACrCJ,EAAUI,SAASkM,OAGlBlL,EAAcpB,GACf,MAAM,IAAI4E,MAAM,cAAgB5E,EAAU,gCAG9C,IAAIiM,KAEJI,EAAWpQ,YAAaoQ,EAAUhI,GAElC,IACIkI,EAAkBC,qCAClBC,EAAgB,IAAMJ,EAAS7H,QAAU,OAAS6H,EAAS5H,WAAa,IAExEiI,EAAcnN,EAAgBS,EAAQwG,iBAJ5B,sBAkCd,GA5BIxG,EAAQ4G,QAAQ2F,IAChBG,EAAY/G,KAAK3F,IAGrB0M,EAAcA,EAAY9N,OAAO,SAAU1D,GACvC,IAAIyR,EAAWpN,EAAgBrE,EAAOyR,UAOtC,OAHAA,GAHAA,EAAWA,EAAS/N,OAAO,SAAUwM,GACjC,OAAOA,EAAExE,QAAQ2F,MAED3N,OAAO,SAAUwM,GACjC,OAAOA,EAAExE,QAAQ6F,KAEdvR,EAAO0L,QAAQ6F,IAAkBE,EAAStR,UAEzCoL,QAAQ,SAAUvL,GAC1B,IAAI0R,EAAe1R,EAEd0R,EAAahG,QAAQ6F,KACtBG,EAAeA,EAAapG,iBAAiBiG,GAC7CG,KAAkBnN,OAAO1C,mBAAmB6P,IAAe,IAG/DX,EAAmBtG,MACf3F,QAAS9E,EACT4M,SAAU8E,EAAa5E,aAAaqE,EAAS7H,UAAYoI,EAAa5E,aAAaqE,EAAS5H,iBAIhG,IAAS4H,EAAS7B,YAAa,CAC/B,IAAIqC,EAAYtN,EAAgBS,EAAQwG,iBAAiB,MACzDqG,EAAUlH,KAAK3F,IAIf6M,GAHAA,EAAYA,EAAUjO,OAAO,SAAU1D,GACnC,OAAQA,EAAO0L,QAAQ2F,MAEL3N,OAAO,SAAU1D,GACnC,MAAoD,SAA7CgF,iBAAiBhF,GAAQ4R,mBAE1BrG,QAAQ,SAAUvL,GACxB,IAAI6R,EAAM7M,iBAAiBhF,GAAQ4R,gBAAgB9D,MAAM,aAErD,OAAS+D,GAAOA,EAAI1R,QAAU,GAC9B4Q,EAAmBtG,MACf3F,QAAS9E,EACT4M,SAAUiF,EAAI,GAAG9N,QAAQ,SAAU,QAMnD,OAAOgN,MAIRtO,EAjYE","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define('Loader', factory) :\n    (global.Loader = factory());\n}(this, (function () { 'use strict';\n\n    /**\n     * @returns {string}\n     */\n    const generateInstanceID = () => {\n        return Math.floor(Math.random() * (9999 - 1000)) + 1000;\n    };\n\n    /**\n     * @param {string} heystack\n     * @param {string} needle\n     * @returns {boolean}\n     */\n    const stringContains = (heystack, needle) => {\n        return String.prototype.includes ? heystack.includes(needle) : heystack.indexOf(needle, 0) !== -1;\n    };\n\n    /**\n     * @param {string} heystack\n     * @param {string} needle\n     * @returns {boolean}\n     */\n    const stringStartsWith = (heystack, needle) => {\n        return String.prototype.startsWith ? heystack.startsWith(needle) : heystack.substr(0, needle.length) === needle;\n    };\n\n    /**\n     * @param {Array} heystack\n     * @param {Function} filter\n     * @returns {number}\n     */\n    const arrayFindIndex = (heystack, filter) => {\n        return Array.prototype.findIndex\n            ? heystack.findIndex(filter)\n            : (() => {\n                  let length = heystack.length,\n                      index = -1;\n                  while (++index < length) {\n                      if (filter(heystack[index], index, heystack)) {\n                          return index;\n                      }\n                  }\n                  return -1;\n              })();\n    };\n\n    /**\n     * @param {string} string\n     * @returns {string}\n     */\n    const hyphensToCamelCase = string => {\n        return string.replace(/-([a-z])/g, g => g[1].toUpperCase());\n    };\n\n    /**\n     * @param {string} string\n     * @returns {string}\n     */\n    const capitalize = string => {\n        return string.charAt(0).toUpperCase() + string.slice(1);\n    };\n\n    /**\n     * @param {NodeList} nodelist\n     * @returns {Array}\n     */\n    const nodelistToArray = nodelist => {\n        return [...nodelist];\n    };\n\n    /**\n     * @param {String|number} needle\n     * @param {Array} heystack\n     * @returns {boolean}\n     */\n    const isInArray = (needle, heystack) => {\n        return heystack.indexOf(needle) > -1;\n    };\n\n    let privateCache = [];\n\n    const intersectionObserverSupported = 'IntersectionObserver' in window;\n    const pictureElementSupported = 'HTMLPictureElement' in window;\n\n    /**\n     * @param {HTMLElement} element\n     * @returns {boolean}\n     */\n    const isVisible = element => {\n        if (intersectionObserverSupported && 'intersectionRatio' in element) {\n            return element.intersectionRatio > 0;\n        }\n\n        if (window.getComputedStyle(element, 'display') === 'none') {\n            return false;\n        }\n\n        const bodyEl = document.getElementsByTagName('body')[0];\n        const winWidth = window.innerWidth || documnt.documentElement.clientWidth || bodyEl.clientWidth;\n        const winHeight = window.innerHeight || documnt.documentElement.clientHeight || bodyEl.clientHeight;\n        const rect = element.getBoundingClientRect();\n\n        return !(rect.right < 0 || rect.bottom < 0 || rect.left > winWidth || rect.top > winHeight);\n    };\n\n    /**\n     * @param {HTMLElement} element\n     * @returns {boolean}\n     */\n    const isHTMLElement = element => {\n        if (typeof element !== 'object') {\n            return false;\n        }\n        try {\n            return element instanceof HTMLElement;\n        } catch (e) {\n            return element.nodeType === 1 && typeof element.style === 'object' && typeof element.ownerDocument === 'object';\n        }\n    };\n\n    /**\n     * @param {(string|HTMLVideoElement|HTMLAudioElement|HTMLImageElement)} source\n     * @returns {boolean}\n     */\n    const isLoaded = source => {\n        return (\n            (typeof source === 'string' && isInArray(source, privateCache)) ||\n            (isHTMLElement(source) &&\n                ('currentSrc' in source && source.currentSrc.length > 0) &&\n                (('complete' in source && source.complete) || ('readyState' in source && source.readyState >= 2)))\n        );\n    };\n\n    /**\n     * @param {(HTMLVideoElement|HTMLAudioElement)} source\n     * @returns {boolean}\n     */\n    const isFullyBuffered = media => {\n        return media.buffered.length && Math.round(media.buffered.end(0)) / Math.round(media.seekable.end(0)) === 1;\n    };\n\n    /**\n     * @param {(string|HTMLElement)} source\n     * @returns {boolean}\n     */\n    const isBroken = source => {\n        return (\n            isLoaded(source) &&\n            ((isHTMLElement(source) && (('naturalWidth' in source && Math.floor(source.naturalWidth) === 0) || ('videoWidth' in source && source.videoWidth === 0))) ||\n                typeof source === 'string')\n        );\n    };\n\n    const pluginInstance = generateInstanceID();\n    const eventNamespaceParserSeparator = '__namespace__';\n\n    const supportedExtensions = {\n        image: 'jp[e]?g|jpe|jif|jfif|jfi|gif|png|tif[f]?|bmp|dib|webp|ico|cur|svg',\n        audio: 'mp3|ogg|oga|spx|ogg|wav',\n        video: 'mp4|ogv|webm'\n    };\n\n    const supportedTags = {\n        image: 'img|picture|source',\n        audio: 'audio|source',\n        video: 'video|source'\n    };\n\n    let privateEventsStorage = {};\n\n    const CustomEvent$1 =\n        window.CustomEvent ||\n        (() => {\n            const _polyfill = (event, params) => {\n                params = params || { bubbles: false, cancelable: false, detail: undefined };\n                const evt = document.createEvent('CustomEvent');\n                evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n                return evt;\n            };\n            _polyfill.prototype = window.Event.prototype;\n            return _polyfill;\n        })();\n\n    /**\n     * @param {HTMLElement} element\n     * @param {string} events\n     * @returns {undefined}\n     */\n    const detachEventListener = (element, events) => {\n        if (!element || typeof events !== 'string') {\n            return;\n        }\n\n        if (stringStartsWith(events, '.')) {\n            for (let key in privateEventsStorage) {\n                const eventNameWithNamespace = key.replace(eventNamespaceParserSeparator, '.');\n                if (stringContains(eventNameWithNamespace, events) && privateEventsStorage[key].element === element) {\n                    detachEventListener(element, eventNameWithNamespace);\n                }\n            }\n        } else {\n            events = events.split('.');\n\n            const type = events[0],\n                namespace = events[1];\n\n            if (namespace) {\n                events = events.join(eventNamespaceParserSeparator);\n            }\n\n            if (events in privateEventsStorage) {\n                element.removeEventListener(type, privateEventsStorage[events].handler);\n                delete privateEventsStorage[events];\n            }\n        }\n    };\n\n    /**\n     * @param {HTMLElement} element\n     * @param {string} events\n     * @param {Function} handler\n     * @param {boolean} once\n     * @returns {undefined}\n     */\n    // TODO: Class EventListener .on .one .off .trigger jQuery-like...\n    const attachEventListener = (element, events, handler, once) => {\n        if (!element || typeof events !== 'string' || typeof handler !== 'function') {\n            return;\n        }\n\n        events = events.split('.');\n\n        const type = events[0];\n        const namespace = events[1];\n\n        if (namespace) {\n            events = events.join(eventNamespaceParserSeparator);\n        }\n\n        privateEventsStorage[events] = { element: element, count: 0, once: false };\n\n        if (true === once) {\n            let _handler = handler;\n            handler = function(event) {\n                if (events in privateEventsStorage) {\n                    privateEventsStorage[events].count++;\n                    if (privateEventsStorage[events].once && privateEventsStorage[events].count > 1) {\n                        return;\n                    }\n                    _handler.call(this, event);\n                }\n                detachEventListener(element, events);\n            };\n        } else {\n            once = false;\n        }\n\n        privateEventsStorage[events] = {\n            ...privateEventsStorage[events],\n            ...{ handler: handler, once: once }\n        };\n\n        element.addEventListener(type, privateEventsStorage[events].handler, { once: once });\n    };\n\n    /**\n     * @param {Object} resource\n     * @returns {Object}\n     */\n    const decodeResource = resource => {\n        let output = { format: null, extension: null, tag: null, consistent: false };\n\n        resource.resource = resource.resource.split('?')[0];\n        resource.resource = resource.resource.split('#')[0];\n        for (let formatCandidate in supportedExtensions) {\n            const base64Heading = ';base64,';\n\n            if (new RegExp('(.(' + supportedExtensions[formatCandidate] + ')$)|' + base64Heading, 'g').test(resource.resource)) {\n                if (new RegExp(base64Heading, 'g').test(resource.resource)) {\n                    let matches64 = resource.resource.match(new RegExp('^data:' + formatCandidate + '/(' + supportedExtensions[formatCandidate] + ')', 'g'));\n\n                    if (null === matches64) {\n                        return;\n                    }\n\n                    matches64 = matches64[0];\n\n                    output.format = formatCandidate;\n                    output.extension = matches64.replace('data:' + formatCandidate + '/', '');\n                    output.tag = supportedTags[formatCandidate];\n\n                    break;\n                } else {\n                    let matches = resource.resource.match(new RegExp(supportedExtensions[formatCandidate], 'g'));\n\n                    if (matches) {\n                        output.format = formatCandidate;\n                        output.extension = matches[0];\n                        output.tag = supportedTags[formatCandidate];\n\n                        break;\n                    }\n                }\n            }\n        }\n\n        if (isHTMLElement(resource.element)) {\n            let tagName = resource.element.tagName.toLowerCase();\n            let allTags = '';\n\n            Object.values(supportedTags).forEach(tags => {\n                allTags += '|' + tags;\n            });\n\n            allTags = allTags.split('|');\n\n            if (isInArray(tagName, allTags)) {\n                output.tag = tagName;\n                output.consistent = true;\n                if (output.format === null) {\n                    for (let format in supportedTags) {\n                        if (stringContains(supportedTags[format], output.tag)) {\n                            output.format = format;\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n\n        if (stringContains(output.tag, '|')) {\n            output.tag = output.tag.split('|')[0];\n        }\n\n        return output;\n    };\n\n    // TODO: Promise support\n    // TODO: think about useful vars in callback args (this class is not public but its vars are returned in .progress() callback)\n    /** TODO: description of the MyClass constructor function.\n     * @class\n     * @classdesc TODO: description of the SingleLoader class.\n     */\n    class SingleLoader {\n        /**\n         * @param {Object} [options={ srcAttr: 'data-src', srcsetAttr: 'data-srcset', playthrough: false, visible: false }]\n         */\n        constructor(options) {\n            this._settings = {\n                ...{\n                    srcAttr: 'data-src',\n                    srcsetAttr: 'data-srcset',\n                    playthrough: false,\n                    visible: false\n                },\n                ...options\n            };\n\n            if (!stringStartsWith(this._settings.srcAttr, 'data-') || !stringStartsWith(this._settings.srcsetAttr, 'data-')) {\n                throw new Error('Wrong arguments format: srcAttr and srcsetAttr parameters must be dataset values.');\n            }\n\n            this.srcAttr = hyphensToCamelCase(this._settings.srcAttr.replace('data-', ''));\n            this.srcsetAttr = hyphensToCamelCase(this._settings.srcsetAttr.replace('data-', ''));\n\n            this._id = null;\n            this._idEvent = null;\n            this._busy = false;\n\n            this._element = null;\n            this._resource = null;\n            this._format = null;\n            this._observer = null;\n\n            this._observing = false;\n\n            this._done = () => {};\n            this._success = () => {};\n            this._error = () => {};\n\n            this._callback = e => {\n                this._busy = false;\n                if (null !== this._observer) {\n                    this._observer.unobserve(this._element);\n                }\n\n                const src = this._element.currentSrc || this._element.src;\n\n                if (!isInArray(src, privateCache)) {\n                    privateCache.push(src);\n                }\n\n                let thisArguments = [this._element, e.type, src, this._id];\n\n                this[e.type !== 'error' ? '_success' : '_error'].apply(this, thisArguments);\n                this._done.apply(this, thisArguments);\n            };\n        }\n\n        /**\n         * @param {Object} data\n         */\n        set resource(data) {\n            if (typeof data === 'object' && 'id' in data && 'element' in data && 'resource' in data) {\n                this._id = data.id;\n                this._element = data.element;\n                this._resource = data.resource;\n\n                this._busy = this._idEvent !== undefined;\n\n                // TODO: FIXME: if this.busy, ottieni tutte le variabili seguenti da una cache.\n\n                let info = decodeResource({\n                    resource: this._resource,\n                    element: this._element\n                });\n                this._tag = info.tag;\n                this._consistent = info.consistent; // wrong tag for resource type...\n                this._format = info.format;\n                this._exists = this._element !== null;\n                this._originalElement = this._element;\n\n                if (!this._exists || !this._consistent) {\n                    this._element = document.createElement(this._tag);\n                    this._element.dataset[this.srcAttr] = this._resource;\n                }\n\n                this._idEvent = this._busy ? this._element[pluginInstance + '_IDEvent'] : 'resourceLoader_unique_' + this._element.tagName + '_' + generateInstanceID();\n\n                //TODO: FIXME: this._lazy = this._busy ? this._lazy : !!(this._element.dataset[this.srcAttr] || this._element.dataset[this.srcsetAttr]);\n\n                if (this._exists && this._settings.visible && intersectionObserverSupported) {\n                    this._observer = new IntersectionObserver(\n                        (entries, observer) => {\n                            entries.forEach(entry => {\n                                entry.target.intersectionRatio = entry.intersectionRatio;\n\n                                if (this._observing) {\n                                    this.process();\n                                }\n                            });\n                        },\n                        {\n                            root: null,\n                            rootMargin: '0px',\n                            threshold: 0.1\n                        }\n                    );\n                    this._observer.observe(this._originalElement);\n                }\n            }\n        }\n\n        observe() {\n            this._observing = true;\n        }\n        unobserve() {\n            this._observing = false;\n        }\n\n        /**\n         * @returns {string}\n         */\n        get resource() {\n            return this._resource;\n        }\n\n        /**\n         * @returns {boolean} se ha preso in carico il caricamento oppure no per vari motivi (è già caricato, non è nella viewport etc)\n         */\n        process() {\n            // TODO: FIXME: (3) check for placeholders / non-lazy resources\n            // if isLoaded(this._exists && this._consistent ? this._element : this._resource) &&\n            // (\n            //    ( this._lazy && ( data-xyz-src === src || data-xyz-srcset === srcset ) ) // TODO: capire come\n            //    ||\n            //    !this._lazy\n            // )\n\n            //TODO: remove elseif else when returning?\n            if (isLoaded(this._exists && this._consistent ? this._element : this._resource)) {\n                if (!this._busy) {\n                    // TODO: mayabe this should be called in this._callback\n                    detachEventListener(this._element, '.' + this._idEvent);\n                }\n\n                this._callback(new CustomEvent$1(!isBroken(this._exists && this._consistent ? this._element : this._resource) ? 'load' : 'error'));\n\n                return false;\n            } else if (this._exists && this._settings.visible && !isVisible(this._originalElement)) {\n                return false;\n            } else {\n                if (this._format === 'image') {\n                    attachEventListener(this._element, 'load.' + this._idEvent, this._callback, !this._busy);\n                    attachEventListener(this._element, 'error.' + this._idEvent, this._callback, !this._busy);\n\n                    const picture = this._element.closest('picture');\n\n                    if (picture && pictureElementSupported) {\n                        delete this._element.dataset[this.srcsetAttr];\n                        delete this._element.dataset[this.srcAttr];\n\n                        picture.querySelectorAll('source[' + this._settings.srcsetAttr + ']').forEach(el => {\n                            el.setAttribute('srcset', el.dataset[this.srcAttr]);\n                            delete el.dataset[this.srcAttr];\n                        });\n                    } else {\n                        if (this._element.matches('[' + this._settings.srcsetAttr + ']')) {\n                            this._element.setAttribute('srcset', this._element.dataset[this.srcsetAttr]);\n                            delete this._element.dataset[this.srcsetAttr];\n                        }\n\n                        if (this._element.matches('[' + this._settings.srcAttr + ']')) {\n                            this._element.setAttribute('src', this._element.dataset[this.srcAttr]);\n                            delete this._element.dataset[this.srcAttr];\n                        }\n                    }\n                } else if (this._format === 'video' || this._format === 'audio') {\n                    const isStandardPlaythrough = true === this._settings.playthrough;\n                    const isFullPlaythrough = 'full' === this._settings.playthrough;\n                    const sources = this._element.querySelectorAll('source');\n\n                    let callMediaLoad = false;\n\n                    if (sources) {\n                        sources.forEach(source => {\n                            if (source.matches('[' + this._settings.srcAttr + ']')) {\n                                source.setAttribute('src', source.dataset[this.srcAttr]);\n                                delete source.dataset[this.srcsetAttr];\n\n                                callMediaLoad = true;\n                            }\n\n                            attachEventListener(\n                                source,\n                                'error.' + this._idEvent,\n                                e => {\n                                    const sourcesErrorId = 'resourceLoader_error';\n\n                                    source[pluginInstance + '_' + sourcesErrorId] = true;\n\n                                    if (sources.length === nodelistToArray(sources).filter(thisSource => true === thisSource[pluginInstance + '_' + sourcesErrorId]).length) {\n                                        this._callback(e);\n                                    }\n                                },\n                                !this._busy // true -> once, false -> on\n                            );\n                        });\n                    } else if (this._element.matches('[' + this._settings.srcAttr + ']')) {\n                        this._element.setAttribute('src', this._element.dataset[this.srcAttr]);\n                        delete this._element.dataset[this.srcAttr];\n\n                        attachEventListener(\n                            this._element,\n                            'error.' + this._idEvent,\n                            this._callback,\n                            !this._busy // true -> once, false -> on\n                        );\n\n                        callMediaLoad = true;\n                    }\n\n                    if (callMediaLoad) {\n                        this._element.load();\n                    }\n\n                    attachEventListener(\n                        this._element,\n                        'loadedmetadata.' + this._idEvent,\n                        () => {\n                            if (!isStandardPlaythrough && !isFullPlaythrough) {\n                                this._callback(new CustomEvent$1('load'));\n                            }\n\n                            if (isFullPlaythrough) {\n                                let onProgressReplacementInterval = setInterval(() => {\n                                    let isError = this._element.readyState > 0 && !this._element.duration;\n\n                                    if (isError || isFullyBuffered(this._element)) {\n                                        this._element.currentTime = 0;\n\n                                        if (!isError && !this._busy && this._element.paused && this._element.matches('[autoplay]')) {\n                                            this._element.play();\n                                        }\n\n                                        clearInterval(onProgressReplacementInterval);\n\n                                        this._callback(new CustomEvent$1(!isError ? 'load' : 'error'));\n                                    } else {\n                                        if (!this._element.paused) {\n                                            this._element.pause();\n                                        }\n\n                                        if (!this._busy) {\n                                            this._element.currentTime += 2;\n                                        }\n                                    }\n                                }, 500);\n\n                                this._element['resourceLoader_' + this._idEvent] = onProgressReplacementInterval;\n                            }\n                        },\n                        !this._busy // true -> once, false -> on\n                    );\n\n                    attachEventListener(\n                        this._element,\n                        'canplay.' + this._idEvent,\n                        () => {\n                            if (isFullPlaythrough && this._element.currentTime === 0 && !isFullyBuffered(this._element)) {\n                                this._element.currentTime++;\n                            }\n                        },\n                        !this._busy // true -> once, false -> on\n                    );\n\n                    attachEventListener(\n                        this._element,\n                        'canplaythrough.' + this._idEvent,\n                        () => {\n                            if (isStandardPlaythrough) {\n                                this._callback(new CustomEvent$1('load'));\n                            }\n                        },\n                        !this._busy // true -> once, false -> on\n                    );\n                } else {\n                    return false;\n                }\n\n                if (!this._busy) {\n                    this._element[pluginInstance + '_IDEvent'] = this._idEvent;\n                }\n            }\n\n            this._resource = this._element.currentSrc || this._element.src;\n\n            return !this._busy;\n        }\n\n        /**\n         * @param {Function} callback\n         * @returns {undefined}\n         */\n        done(callback) {\n            if (typeof callback !== 'function') {\n                return;\n            }\n\n            this._done = function(element, status, resource, id) {\n                callback.apply(this, [element, status, resource, id]);\n            };\n        }\n\n        /**\n         * @returns {undefined}\n         */\n        abort() {\n            detachEventListener(this._element, '.' + this._idEvent);\n\n            if (isLoaded(this._exists ? this._element : this._resource)) {\n                return;\n            }\n\n            const src = this._element.getAttribute('srcset'),\n                srcset = this._element.getAttribute('src');\n\n            if (undefined !== src) {\n                this._element.dataset[this.srcAttr] = src;\n                this._element.setAttribute(this._settings.srcAttr, src);\n                this._element.removeAttribute('src');\n                this._element.removeAttribute('srcset');\n            }\n\n            if (undefined !== srcset) {\n                this._element.dataset[this.srcsetAttr] = srcset;\n                this._element.setAttribute(this._settings.srcsetAttr, srcset);\n                this._element.removeAttribute('src');\n                this._element.removeAttribute('srcset');\n            }\n        }\n    }\n\n    // TODO: Promise support\n    // TODO: private vars\n    // TODO: refactory succes/done/progress code...\n    /** TODO: description of the MyClass constructor function.\n     * @class\n     * @classdesc TODO: description of the Loader class.\n     */\n    class Loader {\n        /**\n         * @param {Object} [options={srcAttr: 'data-src', srcsetAttr: 'data-srcset', playthrough: false, visible: false, backgrounds: false }]\n         */\n        constructor(options) {\n            this._collection = [];\n            this._collectionLoaded = [];\n            this._collectionInstances = [];\n            this._collectionPending = [];\n            this._resourcesLoaded = [];\n\n            this._observing = false;\n\n            this._settings = {\n                ...{\n                    srcAttr: 'data-src',\n                    srcsetAttr: 'data-srcset',\n                    playthrough: false,\n                    visible: false,\n                    backgrounds: false\n                },\n                ...options\n            };\n\n            if (!stringStartsWith(this._settings.srcAttr, 'data-') || !stringStartsWith(this._settings.srcsetAttr, 'data-')) {\n                throw new Error('Wrong arguments format: srcAttr and srcsetAttr parameters must be dataset values.');\n            }\n\n            this.srcAttr = hyphensToCamelCase(this._settings.srcAttr.replace('data-', ''));\n            this.srcsetAttr = hyphensToCamelCase(this._settings.srcsetAttr.replace('data-', ''));\n\n            this.percentage = 0;\n\n            this._done = () => {};\n            this._progress = () => {};\n            this._success = () => {};\n            this._error = () => {};\n            this._loop = this.load;\n\n            this._abort = false;\n            this._loaded = 0;\n            this._complete = false;\n            this._busy = false;\n        }\n\n        /**\n         *\n         * @param {HTMLElement} [element=document.body]\n         * @param {Object} [options={ srcAttr: 'src', srcsetAttr: 'srcset', backgrounds: false }]\n         */\n        static findResources(element, options) {\n            let settings = {\n                srcAttr: 'src',\n                srcsetAttr: 'srcset',\n                backgrounds: false\n            };\n\n            if (typeof element === 'object' && undefined === options) {\n                for (let key in settings) {\n                    if (key in element) {\n                        options = element;\n                        element = undefined;\n                        break;\n                    }\n                }\n            }\n\n            if (undefined === element || element === document) {\n                element = document.body;\n            }\n\n            if (!isHTMLElement(element)) {\n                throw new Error('TypeError: ' + element + ' is not of type HTMLElement.');\n            }\n\n            let collectedResources = [];\n\n            settings = {\n                ...settings,\n                ...options\n            };\n\n            const targets = 'img, video, audio';\n            const targetsExtended = targets + ', picture, source';\n            const targetsFilter = '[' + settings.srcAttr + '], [' + settings.srcsetAttr + ']';\n\n            let targetsTags = nodelistToArray(element.querySelectorAll(targets));\n\n            if (element.matches(targetsExtended)) {\n                targetsTags.push(element);\n            }\n\n            targetsTags = targetsTags.filter(target => {\n                let children = nodelistToArray(target.children);\n                children = children.filter(x => x.matches(targetsExtended));\n                children = children.filter(x => x.matches(targetsFilter));\n                return target.matches(targetsFilter) || children.length;\n            });\n            targetsTags.forEach(target => {\n                let targetSource = target;\n\n                if (!targetSource.matches(targetsFilter)) {\n                    targetSource = targetSource.querySelectorAll(targetsFilter);\n                    targetSource = [...targetSource][0];\n                }\n\n                collectedResources.push({\n                    element: target,\n                    resource: targetSource.getAttribute(settings.srcAttr) || targetSource.getAttribute(settings.srcsetAttr)\n                });\n            });\n\n            if (true === settings.backgrounds) {\n                let targetsBg = nodelistToArray(element.querySelectorAll('*'));\n                targetsBg.push(element);\n                targetsBg = targetsBg.filter(target => !target.matches(targetsExtended));\n                targetsBg = targetsBg.filter(target => getComputedStyle(target).backgroundImage !== 'none');\n                targetsBg.forEach(target => {\n                    const url = getComputedStyle(target).backgroundImage.match(/\\((.*?)\\)/);\n\n                    if (null !== url && url.length >= 2) {\n                        collectedResources.push({\n                            element: target,\n                            resource: url[1].replace(/('|\")/g, '')\n                        });\n                    }\n                });\n            }\n\n            return collectedResources;\n        }\n\n        observe() {\n        }\n\n        /**\n         * @param {(Array.<String>|HTMLElement)} collection\n         */\n        set collection(collection) {\n            let collectedResources = collection;\n\n            try {\n                collectedResources = Loader.findResources(collection, this._settings);\n            } catch (err) {}\n\n            collectedResources.forEach(item => {\n                let element = {\n                    resource: '',\n                    element: null,\n                    id: generateInstanceID()\n                };\n\n                if (typeof item === 'string') {\n                    element.resource = item;\n                } else if (typeof item === 'object' && 'resource' in item) {\n                    element = { ...element, ...item };\n                } else {\n                    return;\n                }\n\n                this._collection.push(element);\n            });\n        }\n\n        /**\n         * @returns {Array} collection\n         */\n        get collection() {\n            return this._collection;\n        }\n\n        observe() {\n            this._observing = true;\n        }\n        unobserve() {\n            this._observing = false;\n        }\n\n        /**\n         * @returns {undefined}\n         */\n        load() {\n            if (!this._collection.length) {\n                this._done.call(this, this._resourcesLoaded);\n            }\n\n            // resets pending elements (sequential opt helper array) every time we loop\n            this._collectionPending = [];\n\n            const sequentialMode = true === this._settings.sequential;\n\n            for (let i = 0; i < this._collection.length; i++) {\n                if (this._abort) {\n                    break;\n                }\n\n                let thisLoadId = this._collection[i].id;\n                let thisLoadIndex = arrayFindIndex(this._collectionInstances, x => x.id === thisLoadId);\n                let thisLoadInstance = new SingleLoader(this._settings);\n\n                if (this._observing) {\n                    thisLoadInstance.observe();\n                }\n\n                if (thisLoadIndex === -1) {\n                    this._collectionInstances.push({\n                        id: thisLoadId,\n                        instance: thisLoadInstance\n                    });\n                    thisLoadIndex = arrayFindIndex(this._collectionInstances, x => x.id === thisLoadId);\n                } else {\n                    this._collectionInstances[thisLoadIndex].instance = thisLoadInstance;\n                }\n\n                thisLoadInstance.resource = this._collection[i];\n\n                thisLoadInstance.done((element, status, resource, id) => {\n                    if (this._complete || this._abort) {\n                        return;\n                    }\n\n                    const aProgress = !isInArray(id, this._collectionLoaded);\n\n                    if (aProgress) {\n                        this._collectionLoaded.push(id);\n                        this._busy = false;\n\n                        this._loaded++;\n                        this.percentage = (this._loaded / this._collection.length) * 100;\n                        this.percentage = parseFloat(this.percentage.toFixed(4));\n\n                        const thisResource = {\n                            resource: resource,\n                            status: status,\n                            element: element\n                        };\n                        this._resourcesLoaded.push(thisResource);\n                        this._progress.call(this, thisResource);\n                        this[status !== 'error' ? '_success' : '_error'].call(this, thisResource);\n\n                        element.dispatchEvent(new CustomEvent('resource' + capitalize(status), { detail: thisResource }));\n                        document.dispatchEvent(new CustomEvent('resource' + capitalize(status), { detail: thisResource }));\n                    }\n\n                    if (this._loaded === this._collection.length) {\n                        this._done.call(this, this._resourcesLoaded);\n\n                        this._complete = true;\n                    } else if (aProgress && sequentialMode && this._collectionPending.length) {\n                        this._collectionPending = this._collectionPending.filter(x => x.id !== id);\n\n                        if (this._collectionPending.length) {\n                            this._busy = this._collectionPending[0].instance.process();\n                        }\n                    }\n                });\n\n                if (!sequentialMode || (sequentialMode && !this._busy)) {\n                    this._busy = thisLoadInstance.process();\n                } else if (\n                    sequentialMode &&\n                    this._busy &&\n                    (!this._settings.visible || !thisLoadInstance._exists || (this._settings.visible && thisLoadInstance._exists && isVisible(thisLoadInstance._originalElement)))\n                ) {\n                    this._collectionPending.push({\n                        id: thisLoadId,\n                        instance: thisLoadInstance\n                    });\n                }\n            }\n        }\n\n        /**\n         * @param {Function} callback\n         * @returns {undefined}\n         */\n        done(callback) {\n            if (typeof callback !== 'function') {\n                return;\n            }\n\n            this._done = function(resources) {\n                callback.call(this, resources);\n            };\n        }\n\n        /**\n         * @param {Function} callback\n         * @returns {undefined}\n         */\n        progress(callback) {\n            if (typeof callback !== 'function') {\n                return;\n            }\n\n            this._progress = function(resource) {\n                callback.call(this, resource);\n            };\n        }\n\n        /**\n         * @param {Function} callback\n         * @returns {undefined}\n         */\n        success(callback) {\n            if (typeof callback !== 'function') {\n                return;\n            }\n\n            this._success = function(resource) {\n                callback.call(this, resource);\n            };\n        }\n\n        /**\n         * @param {Function} callback\n         * @returns {undefined}\n         */\n        error(callback) {\n            if (typeof callback !== 'function') {\n                return;\n            }\n\n            this._error = function(resource) {\n                callback.call(this, resource);\n            };\n        }\n\n        /**\n         * @returns {undefined}\n         */\n        abort() {\n            this._collectionInstances.forEach(thisInstance => {\n                thisInstance.instance.abort();\n            });\n\n            this._abort = true;\n        }\n    }\n\n    return Loader;\n\n})));\n"],"file":"loader.min.js"}