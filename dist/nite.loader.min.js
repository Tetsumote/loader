'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _typeof=typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"?function(obj){return typeof obj;}:function(obj){return obj&&typeof Symbol==="function"&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj;};function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}(function(a,b,c){'use strict';var d=Math.floor;var e='nite',f=e+'Load',g=f+'er';if(function(a){a.console||(a.console={});var b=void 0,c=void 0,d=a.console,e=function e(){},f=['memory'],g=['assert','clear','count','debug','dir','dirxml','error','exception','group','groupCollapsed','groupEnd','info','log','markTimeline','profile','profiles','profileEnd','show','table','time','timeEnd','timeline','timelineEnd','timeStamp','trace','warn'];for(;b=f.pop();){d[b]||(d[b]={});}for(;c=g.pop();){d[c]||(d[c]=e);}}(a),!c)return console.error('jQuery is needed for '+g+' to work!'),void 0;(function(){function c(a,c){c=c||{bubbles:!1,cancelable:!1,detail:void 0};var d=b.createEvent('CustomEvent');return d.initCustomEvent(a,c.bubbles,c.cancelable,c.detail),d;}return'function'!=typeof a.CustomEvent&&void(c.prototype=a.Event.prototype,a.CustomEvent=c);})(),Array.prototype.findIndex=Array.prototype.findIndex||function(a){if(null===this)throw new TypeError('Array.prototype.findIndex called on null or undefined');else if('function'!=typeof a)throw new TypeError('callback must be a function');var b=Object(this),c=b.length>>>0,d=arguments[1];for(var _e=0;_e<c;_e++){if(a.call(d,b[_e],_e,b))return _e;}return-1;},[].filter||(Array.prototype.filter=function(f,a,b,c,d){for(d in b=this,c=[],b){~~d+''==d&&0<=d&&f.call(a,b[d],+d,b)&&c.push(b[d]);}return c;});var h=[];var i=function i(a){return a.charAt(0).toUpperCase()+a.slice(1);},j=c(b),k=c(a),l=function l(){return c.nite&&'uniqueId'in c.nite?c.nite.uniqueId():d(8999*Math.random())+1e3;},m=function m(a){var b=c(a);var d=!1;if(c.nite&&'inViewport'in c.nite)d=c.nite.inViewport(a).ratio;else{var _b=a.getBoundingClientRect();d=!(0>_b.right||0>_b.bottom||_b.left>k.width()||_b.top>k.height());}return d&&b.is(':visible')&&'hidden'!==b.css('visibility');},n=function n(a){if('object'!=(typeof a==='undefined'?'undefined':_typeof(a)))return!1;try{return a instanceof HTMLElement;}catch(b){return 1===a.nodeType&&'object'==_typeof(a.style)&&'object'==_typeof(a.ownerDocument);}},o=function o(a){return'string'==typeof a&&-1<c.inArray(a,h)||n(a)&&'currentSrc'in a&&a.currentSrc.length&&('complete'in a&&a.complete||'readyState'in a&&2<=a.readyState);},p=function p(a){return o(a)&&('object'==(typeof a==='undefined'?'undefined':_typeof(a))&&('naturalWidth'in a&&0===d(a.naturalWidth)||'videoWidth'in a&&0===a.videoWidth)||'string'==typeof a);},q=function q(a,b){var d={image:'jp[e]?g||jpe|jif|jfif|jfi|gif|png|tif[f]?|bmp|dib|webp|ico|cur|svg',audio:'mp3|ogg|oga|spx|ogg|wav',video:'mp4|ogv|webm'},e=Object.keys(d);var f={format:null,extension:null};if('string'==typeof a){if(a=a.split('?')[0],a=a.split('#')[0],''===a)return!1;var _c=void 0===b?e:[b];for(var _b2 in _c){if(_c.hasOwnProperty(_b2)&&new RegExp('(.('+d[_c[_b2]]+')$)|'+';base64,','g').test(a))if(/;base64,/g.test(a)){var _e2=a.match(new RegExp('^data:'+_c[_b2]+'/('+d[_c[_b2]]+')','g'));if(!_e2||null===_e2)continue;_e2=_e2[0],f.format=_c[_b2],f.extension=_e2.replace('data:'+_c[_b2]+'/','');break;}else{var _e3=a.match(new RegExp(d[_c[_b2]],'g'));if(_e3){f.format=_c[_b2],f.extension=_e3[0];break;}}}}if(n(a)){var _b3=a.tagName.toLowerCase();-1<c.inArray(_b3,e)&&(f.format=a.tagName.toLowerCase()),'img'===_b3&&(f.format='image');}return f;};var r=function(){function r(a){var _this=this;_classCallCheck(this,r);this._settings=c.extend(!0,{srcAttr:'data-src',srcsetAttr:'data-srcset',playthrough:!1,visible:!1},a),this._id=null,this._id_event=null,this._element=null,this._$element=c(),this._resource=null,this._busy=!1,this._format=null,this._done=c.noop,this._success=c.noop,this._error=c.noop,this._callback=function(a){_this._$element.removeData(g),_this._busy=!1;var b=_this._element.currentSrc||_this._element.src;-1===c.inArray(b,h)&&h.push(b);var d=[_this._element,a.type,b,_this._id];_this['error'===a.type?'_error':'_success'].apply(_this,d),_this._done.apply(_this,d);};}_createClass(r,[{key:'process',value:function process(){var _this2=this;var b=this._settings.srcAttr,d=this._settings.srcAttr.replace('data-','');if(o(this._exists?this._element:this._resource))return this._busy||this._$element.off('.'+this._id_event),this._callback(new CustomEvent(p(this._exists?this._element:this._resource)?'error':'load')),!1;if(this._exists&&this._settings.visible&&!m(this._element))return!1;if('image'===this._format){this._$element[this._busy?'on':'one']('load.'+this._id_event+' error.'+this._id_event,this._callback);var _c2=this._$element.closest('picture'),_e4=this._settings.srcsetAttr,_f=this._settings.srcsetAttr.replace('data-','');_c2.length&&'HTMLPictureElement'in a?(this._$element.removeData(_f).removeAttr(_e4).removeData(d).removeAttr(b),_c2.find('source['+_e4+']').attr('srcset',_c2.data(_f)).removeData(_f).removeAttr(_e4)):(this._$element.is('['+_e4+']')&&this._$element.attr('srcset',this._$element.data(_f)).removeData(_f).removeAttr(_e4),this._$element.is('['+b+']')&&this._$element.attr('src',this._$element.data(d)).removeData(d).removeAttr(b));}else if('video'===this._format||'audio'===this._format){var _a=!0===this._settings.playthrough,_e5='full'===this._settings.playthrough,_f2=this._$element.find('source'),_h=function _h(a){var b=Math.round;return a.buffered.length&&1==b(a.buffered.end(0))/b(a.seekable.end(0));};var _i=!1;if(_f2.length){var _a2=this;_f2.each(function(){var a=c(this);a.is('['+b+']')&&(a.attr('src',a.data(d)).removeData(d).removeAttr(b),_i=!0);})[this._busy?'on':'one']('error.'+this._id_event,function(b){var d=g+'_error';c(this).data(d,!0),_f2.length===_f2.filter(function(){return!0===c(this).data(d);}).length&&_a2._callback(b);});}else this._$element.is('['+b+']')&&(this._$element.attr('src',this._$element.data(d)).removeData(d).removeAttr(b)[this._busy?'on':'one']('error.'+this._id_event,this._callback),_i=!0);_i&&this._element.load(),this._$element[this._busy?'on':'one']('loadedmetadata.'+this._id_event,function(){if(_a||_e5||_this2._callback(new CustomEvent('load')),_e5){var _a3=setInterval(function(){var b=0<_this2._element.readyState&&!_this2._element.duration;b||_h(_this2._element)?(_this2._element.currentTime=0,!b&&!_this2._busy&&_this2._element.paused&&_this2._$element.is('[autoplay]')&&_this2._element.play(),clearInterval(_a3),_this2._callback(new CustomEvent(b?'error':'load'))):(!_this2._element.paused&&_this2._element.pause(),!_this2._busy&&(_this2._element.currentTime+=2));},500);_this2._$element.data(_this2._id_event,_a3);}})[this._busy?'on':'one']('canplay.'+this._id_event,function(){_e5&&0===_this2._element.currentTime&&!_h(_this2._element)&&_this2._element.currentTime++;})[this._busy?'on':'one']('canplaythrough.'+this._id_event,function(){_a&&_this2._callback(new CustomEvent('load'));});}else return!1;return this._busy||this._$element.data(g,this._id_event),this._resource=this._element.currentSrc||this._element.src,!this._busy;}},{key:'done',value:function done(a){c.isFunction(a)&&(this._done=function(b,c,d,e){a.apply(this,[b,c,d,e]);});}},{key:'abort',value:function abort(){if(this._$element.off('.'+this._id_event),!o(this._exists?this._element:this._resource)){var _a4=this._$element.attr('srcset'),_b4=this._$element.attr('src');void 0!==_a4&&this._$element.data(this._settings.srcAttr,_a4).attr(this._settings.srcAttr,_a4).removeAttr('src').removeAttr('srcset'),void 0!==_b4&&this._$element.data(this._settings.srcsetAttr,_b4).attr(this._settings.srcsetAttr,_b4).removeAttr('src').removeAttr('srcset');}}},{key:'resource',set:function set(a){var d=n(a.resource),e='string'==typeof a.resource;if(d||e){if(this._id=a.id,this._format=q(a.resource).format,this._exists=d,e){var _c3='image'===this._format;this._element=b.createElement(_c3?'img':this._format),_c3&&(this._settings.srcsetAttr='data-srcset'),this._settings.srcAttr='data-src',this._resource=a.resource;}d&&(this._element=a.resource),this._$element=c(this._element),e&&this._$element.data(this._settings.srcAttr.replace('data-',''),this._resource).data(this._settings.srcsetAttr.replace('data-',''),this._resource).attr(this._settings.srcAttr,this._resource).attr(this._settings.srcsetAttr,this._resource),this._id_event=this._$element.data(g),this._busy=void 0!==this._id_event,this._id_event=this._busy?this._id_event:g+'_unique_'+this._element.tagName+'_'+l();}}}]);return r;}();var s=function(){function s(a,b){var _this3=this;_classCallCheck(this,s);if(this._collection=[],this._collection_loaded=[],this._collection_instances=[],this._collection_pending=[],this._resources_loaded=[],c.isArray(a)&&('string'==typeof a[0]||n(a[0])))for(var _b5 in a){a.hasOwnProperty(_b5)&&this._collection.push({id:l(),resource:a[_b5]});}('string'==typeof a||n(a))&&this._collection.push({id:l(),resource:a}),this._settings=c.extend(!0,{srcAttr:'data-src',srcsetAttr:'data-srcset',playthrough:!1,visible:!1},b),this.percentage=0,this._done=c.noop,this._progress=c.noop,this._success=c.noop,this._error=c.noop,this._abort=!1,this._loaded=0,this._complete=!1,this._busy=!1,(this._loop=function(){setTimeout(function(){_this3.loop();},25);})();}_createClass(s,[{key:'loop',value:function loop(){var _this4=this;this._collection_pending=[];var a=!0===this._settings.sequential;var _loop=function _loop(_b6){var d=_this4._collection[_b6].id,f=_this4._collection_instances.findIndex(function(a){return a.id===d;}),g=new r(_this4._settings);-1===f?(_this4._collection_instances.push({id:d,instance:g}),f=_this4._collection_instances.findIndex(function(a){return a.id===d;})):_this4._collection_instances[f].instance=g,g.resource=_this4._collection[_b6],g.done(function(b,d,f,g){if(!(_this4._complete||_this4._abort)){var _h2=-1===c.inArray(g,_this4._collection_loaded);if(_h2){_this4._collection_loaded.push(g),_this4._busy=!1,_this4._loaded++,_this4.percentage=100*(_this4._loaded/_this4._collection.length),_this4.percentage=parseFloat(_this4.percentage.toFixed(4));var _a5={resource:f,status:d};_this4._resources_loaded.push(_a5),_this4._progress.call(_this4,_a5),_this4['error'===d?'_error':'_success'].call(_this4,_a5),c(b).trigger(e+i(d)+'.'+e,[b,f]);}_this4._loaded===_this4._collection.length?(_this4._done.call(_this4,_this4._resources_loaded),_this4._complete=!0):_h2&&a&&_this4._collection_pending.length&&(_this4._collection_pending=_this4._collection_pending.filter(function(a){return a.id!==g;}),_this4._collection_pending=_this4._collection_pending.filter(function(a){return a.id!==g;}),_this4._collection_pending.length&&(_this4._busy=_this4._collection_pending[0].instance.process()));}}),a&&(!a||_this4._busy)?a&&_this4._busy&&(!_this4._settings.visible||_this4._settings.visible&&m(g._element))&&_this4._collection_pending.push({id:d,instance:g}):_this4._busy=g.process();};for(var _b6=0;_b6<this._collection.length&&!this._abort;_b6++){_loop(_b6);}}},{key:'done',value:function done(a){if(c.isFunction(a)){var _b7=function _b7(b){a.call(this,b);};this._collection.length?(this._done=_b7,this._loop()):_b7();}}},{key:'progress',value:function progress(a){if(c.isFunction(a)){this._collection.length&&(this._progress=function(b){a.call(this,b);},this._loop());}}},{key:'success',value:function success(a){if(c.isFunction(a)){this._collection.length&&(this._success=function(b){a.call(this,b);},this._loop());}}},{key:'error',value:function error(a){if(c.isFunction(a)){this._collection.length&&(this._error=function(b){a.call(this,b);},this._loop());}}},{key:'abort',value:function abort(){for(var _a6 in this._collection_instances){this._collection_instances[_a6].instance.abort();}this._collection.length&&(this._abort=!0);}}]);return s;}();var t=function(){function t(a,b){_classCallCheck(this,t);this._$element=a,this._element=a[0],this._settings=c.extend(!0,{srcAttr:'data-src',srcsetAttr:'data-srcset',backgrounds:!1,attributes:[]},b);}_createClass(t,[{key:'collect',value:function collect(a){var b=[];var d='plain'===a,e=this._settings.srcAttr,f=this._settings.srcsetAttr,g='img, video, audio',h=g+', picture, source';var i=this._$element.find(g);if(this._$element.is(g)&&(i=i.add(this._$element)),i=i.filter(function(){var a=c(this),b='['+e+'], ['+f+']';return a.is(b)||a.children(h).filter(b).length;}),i.each(function(){var a={element:this,resource:c(this).attr(e)||c(this).attr(f)};d&&(a=a.element),b.push(a);}),!0===this._settings.backgrounds&&this._$element.find('*').addBack().not(h).filter(function(){return'none'!==c(this).css('background-image');}).each(function(){var a=c(this).css('background-image').match(/\((.*?)\)/);if(null===a||2>a.length)return!0;var e={element:this,resource:a[1].replace(/('|")/g,'')};d&&(e=e.resource),b.push(e);}),this._settings.attributes.length){var _loop2=function(_a7){if(this._settings.attributes.hasOwnProperty(_a7)&&(this._$element.find('['+_a7+']:not('+h+')').each(function(){let e={element:this,resource:c(this).attr(_a7)};d&&(e=e.resource),b.push(e);}),this._$element.is('['+_a7+']')&&!this._$element.is(h))){let c={element:this._element,resource:this._$element.attr(_a7)};d&&(c=c.resource),b.push(c);}};for(const _a7 in this._settings.attributes){_loop2(_a7);}}return b;}}]);return t;}();c[f]=s;var u=[];c.fn[f]=function(a){var b=a;'object'!=(typeof a==='undefined'?'undefined':_typeof(a))&&(a={});var d=c.extend(!0,{srcAttr:'data-src',srcsetAttr:'data-srcset',visible:!1,sequential:!1,backgrounds:!1,extraAttrs:[],playthrough:!1,early:!1,earlyTimeout:0,onProgress:c.noop,onLoad:c.noop,onError:c.noop,onComplete:c.noop},a),f=d.onComplete;return c.isFunction(b)&&(f=b),c.isArray(d.attributes)||(d.attributes=[]),'string'==typeof d.attributes&&(d.attributes=d.attributes.split(' ')),this.each(function(){var a=this,b=c(a),h=new t(b,d).collect('plain'),m=g+'_'+l(),n=new s(h,d);if(u.push({id:m,instance:n,element:a,timeout:null}),n.progress(function(f){b.trigger(e+'Progress.'+e,[a,f]);var g=[n,f];c.isFunction(d.onProgress)&&d.onProgress.apply(a,g);var h=i(f.status);c.isFunction(d['on'+h])&&d['on'+h].apply(a,g);}),n.done(function(g){b.trigger(e+'Complete.'+e,[a,g]),f.apply(a,[n,g]),d.visible&&c(c.nite&&'scroll'in c.nite?j:k).off('scroll.'+m),u=u.filter(function(a){return a.id!==m;}),u.forEach(function(a){b.is(a.element)&&a.instance.loop();});}),d.visible)if(c.nite&&'scroll'in c.nite)c.nite.scroll(m,function(){n.loop();},{fps:25});else{k.on('scroll.'+m,function(a,b){var c=Date.now();return function(){0>c+b-Date.now()&&(a(),c=Date.now());};}(function(){n.loop();},1e3));}if(!0===d.early){var _loop3=function(_a8){var b=u[_a8];if(u[_a8].id===m){clearTimeout(b.timeout),b.timeout=setTimeout(function(){b.instance._settings.visible=!1,b.instance._settings.sequential=!0,b.instance.loop();},c.isNumeric(d.earlyTimeout)?parseInt(d.earlyTimeout):0);return'break';}};for(let _a8 in u){var _ret3=_loop3(_a8);if(_ret3==='break')break;}}});};})(window,document,jQuery);
//# sourceMappingURL=nite.loader.min.js.map
