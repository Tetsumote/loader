!function(t,e,s,i){"use strict";!function(){t.console||(t.console={});let e,s,i=t.console,r=()=>{},n=["memory"],o="assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(",");for(;e=n.pop();)i[e]||(i[e]={});for(;s=o.pop();)i[s]||(i[s]=r)}(),function(){if("function"==typeof t.CustomEvent)return!1;function s(t,s){s=s||{bubbles:!1,cancelable:!1,detail:i};const r=e.createEvent("CustomEvent");return r.initCustomEvent(t,s.bubbles,s.cancelable,s.detail),r}s.prototype=t.Event.prototype,t.CustomEvent=s}(),Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');let e=Object(this),s=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");let i=arguments[1],r=0;for(;r<s;){let s=e[r];if(t.call(i,s,r,e))return r;r++}return-1},configurable:!0,writable:!0}),Array.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Array.prototype.filter=Array.prototype.filter||function(t,e){if("Function"!=typeof t&&"function"!=typeof t||!this)throw new TypeError;let s=this.length>>>0,r=new Array(s),n=this,o=0,c=-1;if(e===i)for(;++c!==s;)if(c in this)if(t(n[c],c,n))r[o++]=n[c];else for(;++c!==s;)c in this&&t.call(e,n[c],c,n)&&(r[o++]=n[c]);return r.length=o,r},String.prototype.startsWith=String.prototype.startsWith||function(t,e){return this.substr(!e||e<0?0:+e,t.length)===t},String.prototype.includes=String.prototype.includes||function(t,e){return"number"!=typeof e&&(e=0),!(e+t.length>this.length)&&-1!==this.indexOf(t,e)};const r=function(){return Math.floor(8999*Math.random())+1e3},n="niteLoader",o=r();t[n+"Cache"]=[];let c={};const l=(t,e)=>{if(t&&"string"==typeof e)if(e.startsWith("."))Object.keys(c).forEach(s=>{s.replace("__namespace__",".").includes(e)&&c[s].element===t&&l(t,s.replace("__namespace__","."))});else{const s=(e=e.split("."))[0];e[1]&&(e=e.join("__namespace__")),e in c&&(t.removeEventListener(s,c[e].handler),delete c[e])}},h=(t,e,s,i)=>{if(!t||"string"!=typeof e||"function"!=typeof s)return;const r=(e=e.split("."))[0];if(e[1]&&(e=e.join("__namespace__")),c[e]={element:t,count:0,once:!1},!0===i){let i=s;s=function(s){c[e].count++,c[e].once&&c[e].count>1||(i.call(this,s),l(t,e))}}else i=!1;c[e]={...c[e],...{handler:s,once:i}},t.addEventListener(r,c[e].handler,{once:i})},a=t=>t.replace(/-([a-z])/g,t=>t[1].toUpperCase()),_=(t,e)=>e.indexOf(t)>-1,u=t=>t.charAt(0).toUpperCase()+t.slice(1),d=s=>{if("none"===t.getComputedStyle(s,"display"))return!1;const i=e.getElementsByTagName("body")[0],r=t.innerWidth||documnt.documentElement.clientWidth||i.clientWidth,n=t.innerHeight||documnt.documentElement.clientHeight||i.clientHeight,o=s.getBoundingClientRect();return!(o.right<0||o.bottom<0||o.left>r||o.top>n)},m=function(t){if("object"!=typeof t)return!1;try{return t instanceof HTMLElement}catch(e){return 1===t.nodeType&&"object"==typeof t.style&&"object"==typeof t.ownerDocument}},f=function(e){return"string"==typeof e&&_(e,t[n+"Cache"])||m(e)&&"currentSrc"in e&&e.currentSrc.length&&("complete"in e&&e.complete||"readyState"in e&&e.readyState>=2)},p=function(t){return f(t)&&("object"==typeof t&&("naturalWidth"in t&&0===Math.floor(t.naturalWidth)||"videoWidth"in t&&0===t.videoWidth)||"string"==typeof t)},g=function(t,e){const s={image:"jp[e]?g||jpe|jif|jfif|jfi|gif|png|tif[f]?|bmp|dib|webp|ico|cur|svg",audio:"mp3|ogg|oga|spx|ogg|wav",video:"mp4|ogv|webm"},r=Object.keys(s);let n={format:null,extension:null};if("string"==typeof t){if(""===(t=(t=t.split("?")[0]).split("#")[0]))return!1;let o=i!==e?[e]:r;for(const e in o)if(o.hasOwnProperty(e)&&new RegExp("(.("+s[o[e]]+")$)|;base64,","g").test(t)){if(new RegExp(";base64,","g").test(t)){let i=t.match(new RegExp("^data:"+o[e]+"/("+s[o[e]]+")","g"));if(!i||null===i)continue;i=i[0],n.format=o[e],n.extension=i.replace("data:"+o[e]+"/","");break}{let i=t.match(new RegExp(s[o[e]],"g"));if(i){n.format=o[e],n.extension=i[0];break}}}}if(m(t)){let e=t.tagName.toLowerCase();_(e,r)&&(n.format=t.tagName.toLowerCase()),"img"===e&&(n.format="image")}return n};class A{constructor(e){this._settings={...{srcAttr:"data-src",srcsetAttr:"data-srcset",playthrough:!1,visible:!1},...e},this.srcAttr="",this.srcsetAttr="",this._settings.srcAttr.startsWith("data-")?this.srcAttr=this._settings.srcAttr.replace("data-",""):(this.srcAttr=this._settings.srcAttr,this._settings.srcAttr="data-"+this._settings.srcAttr),this._settings.srcsetAttr.startsWith("data-")?this.srcsetAttr=this._settings.srcsetAttr.replace("data-",""):(this.srcsetAttr=this._settings.srcsetAttr,this._settings.srcsetAttr="data-"+this._settings.srcsetAttr),this.srcAttr=a(this.srcAttr),this.srcsetAttr=a(this.srcsetAttr),this._id=null,this._idEvent=null,this._element=null,this._resource=null,this._busy=!1,this._format=null,this._done=(()=>{}),this._success=(()=>{}),this._error=(()=>{}),this._callback=(e=>{this._busy=!1;const s=this._element.currentSrc||this._element.src;_(s,t[n+"Cache"])||t[n+"Cache"].push(s);let i=[this._element,e.type,s,this._id];this["error"!==e.type?"_success":"_error"].apply(this,i),this._done.apply(this,i)})}set resource(t){const s=m(t.resource),c="string"==typeof t.resource;if(s||c){if(this._id=t.id,this._format=g(t.resource).format,this._exists=s,c){let s="image"===this._format;this._element=e.createElement(s?"img":this._format),s&&(this.srcsetAttr="srcset",this._settings.srcsetAttr="data-"+this.srcsetAttr,this.srcsetAttr=a(this.srcsetAttr)),this.srcAttr="src",this._settings.srcAttr="data-"+this.srcAttr,this.srcAttr=a(this.srcAttr),this._resource=t.resource}s&&(this._element=t.resource),c&&(this._element.dataset[this.srcAttr]=this._resource,this._element.dataset[this.srcsetAttr]=this._resource,this._element.setAttribute(this._settings.srcAttr,this._resource),this._element.setAttribute(this._settings.srcsetAttr,this._resource)),this._idEvent=this._element[o+"_IDEvent"],this._busy=this._idEvent!==i,this._idEvent=this._busy?this._idEvent:n+"_unique_"+this._element.tagName+"_"+r()}}process(){if(f(this._exists?this._element:this._resource))return this._busy||l(this._element,"."+this._idEvent),this._callback(new CustomEvent(p(this._exists?this._element:this._resource)?"error":"load")),!1;if(this._exists&&this._settings.visible&&!d(this._element))return!1;if("image"===this._format){h(this._element,"load."+this._idEvent,this._callback,!this._busy),h(this._element,"error."+this._idEvent,this._callback,!this._busy);const e=this._element.closest("picture");e&&"HTMLPictureElement"in t?(delete this._element.dataset[this.srcsetAttr],delete this._element.dataset[this.srcAttr],e.querySelectorAll("source["+this._settings.srcsetAttr+"]").forEach(t=>{t.setAttribute("srcset",t.dataset[this.srcAttr]),delete t.dataset[this.srcAttr]})):(this._element.matches("["+this._settings.srcsetAttr+"]")&&(this._element.setAttribute("srcset",this._element.dataset[this.srcsetAttr]),delete this._element.dataset[this.srcsetAttr]),this._element.matches("["+this._settings.srcAttr+"]")&&(this._element.setAttribute("src",this._element.dataset[this.srcAttr]),delete this._element.dataset[this.srcAttr]))}else{if("video"!==this._format&&"audio"!==this._format)return!1;{const t=!0===this._settings.playthrough,e="full"===this._settings.playthrough,s=this._element.querySelectorAll("source"),i=function(t){return t.buffered.length&&Math.round(t.buffered.end(0))/Math.round(t.seekable.end(0))==1};let r=!1;s?s.forEach(t=>{t.matches("["+this._settings.srcAttr+"]")&&(t.setAttribute("src",t.dataset[this.srcAttr]),delete t.dataset[this.srcsetAttr],r=!0),h(t,"error."+this._idEvent,e=>{const i=n+"_error";t[o+"_"+i]=!0,s.length===[...s].filter(t=>!0===t[o+"_"+i]).length&&this._callback(e)},!this._busy)}):this._element.matches("["+src+"]")&&(this._element.setAttribute("src",this._element.dataset[this.srcAttr]),delete this._element.dataset[this.srcAttr],h(this._element,"error."+this._idEvent,this._callback,!this._busy),r=!0),r&&this._element.load(),h(this._element,"loadedmetadata."+this._idEvent,()=>{if(t||e||this._callback(new CustomEvent("load")),e){let t=setInterval(()=>{let e=this._element.readyState>0&&!this._element.duration;e||i(this._element)?(this._element.currentTime=0,!e&&!this._busy&&this._element.paused&&this._element.matches("[autoplay]")&&this._element.play(),clearInterval(t),this._callback(new CustomEvent(e?"error":"load"))):(this._element.paused||this._element.pause(),this._busy||(this._element.currentTime+=2))},500);this._element[n+"_"+this._idEvent]=t}},!this._busy),h(this._element,"canplay."+this._idEvent,()=>{e&&0===this._element.currentTime&&!i(this._element)&&this._element.currentTime++},!this._busy),h(this._element,"canplaythrough."+this._idEvent,()=>{t&&this._callback(new CustomEvent("load"))},!this._busy)}}return this._busy||(this._element[o+"_IDEvent"]=this._idEvent),this._resource=this._element.currentSrc||this._element.src,!this._busy}done(t){"function"==typeof t&&(this._done=function(e,s,i,r){t.apply(this,[e,s,i,r])})}abort(){if(l(this._element,"."+this._idEvent),f(this._exists?this._element:this._resource))return;const t=this._element.getAttribute("srcset"),e=this._element.getAttribute("src");i!==t&&(this._element.dataset[this.srcAttr]=t,this._element.setAttribute(this._settings.srcAttr,t),this._element.removeAttribute("src"),this._element.removeAttribute("srcset")),i!==e&&(this._element.dataset[this.srcsetAttr]=e,this._element.setAttribute(this._settings.srcsetAttr,e),this._element.removeAttribute("src"),this._element.removeAttribute("srcset"))}}class y{constructor(t,e){if(this._collection=[],this._collectionLoaded=[],this._collectionInstances=[],this._collectionPending=[],this._resourcesLoaded=[],Array.isArray(t)&&("string"==typeof t[0]||m(t[0])))for(const e in t)t.hasOwnProperty(e)&&this._collection.push({id:r(),resource:t[e]});("string"==typeof t||m(t))&&this._collection.push({id:r(),resource:t}),this._settings={...{srcAttr:"data-src",srcsetAttr:"data-srcset",playthrough:!1,visible:!1},...e},this.srcAttr="",this.srcsetAttr="",this._settings.srcAttr.startsWith("data-")?this.srcAttr=this._settings.srcAttr.replace("data-",""):(this.srcAttr=this._settings.srcAttr,this._settings.srcAttr="data-"+this._settings.srcAttr),this._settings.srcsetAttr.startsWith("data-")?this.srcsetAttr=this._settings.srcsetAttr.replace("data-",""):(this.srcsetAttr=this._settings.srcsetAttr,this._settings.srcsetAttr="data-"+this._settings.srcsetAttr),this.srcAttr=a(this.srcAttr),this.srcsetAttr=a(this.srcsetAttr),this.percentage=0,this._done=(()=>{}),this._progress=(()=>{}),this._success=(()=>{}),this._error=(()=>{}),this._abort=!1,this._loaded=0,this._complete=!1,this._busy=!1,(this._loop=(()=>setTimeout(()=>this.loop(),25)))()}loop(){this._collectionPending=[];const t=!0===this._settings.sequential;for(let e=0;e<this._collection.length&&!this._abort;e++){let s=this._collection[e].id,i=this._collectionInstances.findIndex(t=>t.id===s),r=new A(this._settings);-1===i?(this._collectionInstances.push({id:s,instance:r}),i=this._collectionInstances.findIndex(t=>t.id===s)):this._collectionInstances[i].instance=r,r.resource=this._collection[e],r.done((e,s,i,r)=>{if(this._complete||this._abort)return;const n=!_(r,this._collectionLoaded);if(n){this._collectionLoaded.push(r),this._busy=!1,this._loaded++,this.percentage=this._loaded/this._collection.length*100,this.percentage=parseFloat(this.percentage.toFixed(4));const t={resource:i,status:s,element:e};this._resourcesLoaded.push(t),this._progress.call(this,t),this["error"!==s?"_success":"_error"].call(this,t)}this._loaded===this._collection.length?(this._done.call(this,this._resourcesLoaded),this._complete=!0):n&&t&&this._collectionPending.length&&(this._collectionPending=this._collectionPending.filter(t=>t.id!==r),this._collectionPending=this._collectionPending.filter(t=>t.id!==r),this._collectionPending.length&&(this._busy=this._collectionPending[0].instance.process()))}),!t||t&&!this._busy?this._busy=r.process():t&&this._busy&&(!this._settings.visible||this._settings.visible&&d(r._element))&&this._collectionPending.push({id:s,instance:r})}}done(t){if("function"!=typeof t)return;const e=function(e){t.call(this,e)};this._collection.length?(this._done=e,this._loop()):e()}progress(t){if("function"!=typeof t)return;const e=function(e){t.call(this,e)};this._collection.length&&(this._progress=e,this._loop())}success(t){if("function"!=typeof t)return;const e=function(e){t.call(this,e)};this._collection.length&&(this._success=e,this._loop())}error(t){if("function"!=typeof t)return;const e=function(e){t.call(this,e)};this._collection.length&&(this._error=e,this._loop())}abort(){for(const t in this._collectionInstances)this._collectionInstances[t].instance.abort();this._collection.length&&(this._abort=!0)}}"function"==typeof define&&define.amd?define(u("niteLoad"),y):"object"==typeof exports?module.exports[u("niteLoad")]=y:t[u("niteLoad")]=y;if(!s)return i;s.niteLoad=y;s(e);const b=s(t),v=(t,e,s=this)=>{let i=null,r=null;const n=()=>{t.apply(s,r),i=null};return function(){i||(r=arguments,i=setTimeout(n,e))}};let E=[];s.fn.niteLoad=function(t){let e=t;"object"!=typeof t&&(t={});let i={...{srcAttr:"data-src",srcsetAttr:"data-srcset",visible:!1,sequential:!1,backgrounds:!1,extraAttrs:[],playthrough:!1,early:!1,earlyTimeout:0,onProgress:()=>{},onLoad:()=>{},onError:()=>{},onComplete:()=>{}},...t};i.srcAttr.startsWith("data-")||(i.srcAttr="data-"+i.srcAttr),i.srcsetAttr.startsWith("data-")||(i.srcsetAttr="data-"+i.srcsetAttr);let n=i.onComplete;return s.isFunction(e)&&(n=e),s.isArray(i.attributes)||(i.attributes=[]),"string"==typeof i.attributes&&(i.attributes=i.attributes.split(" ")),this.each(function(t){const e=this,o=s(e),c=new class{constructor(t,e){this._$element=t,this._element=t[0],this._settings={...{srcAttr:"data-src",srcsetAttr:"data-srcset",backgrounds:!1,attributes:[]},...e},this._settings.srcAttr.startsWith("data-")||(this._settings.srcAttr="data-"+this._settings.srcAttr),this._settings.srcsetAttr.startsWith("data-")||(this._settings.srcsetAttr="data-"+this._settings.srcsetAttr)}collect(t){let e=[];const i="plain"===t,r=this._settings.srcAttr,n=this._settings.srcsetAttr,o="img, video, audio",c=o+", picture, source";let l=this._$element.find(o);if(this._$element.is(o)&&(l=l.add(this._$element)),(l=l.filter(function(){let t=s(this),e="["+r+"], ["+n+"]";return t.is(e)||t.children(c).filter(e).length})).each(function(){let t={element:this,resource:s(this).attr(r)||s(this).attr(n)};i&&(t=t.element),e.push(t)}),!0===this._settings.backgrounds&&this._$element.find("*").addBack().not(c).filter(function(){return"none"!==s(this).css("background-image")}).each(function(){const t=s(this).css("background-image").match(/\((.*?)\)/);if(null===t||t.length<2)return!0;let r={element:this,resource:t[1].replace(/('|")/g,"")};i&&(r=r.resource),e.push(r)}),this._settings.attributes.length)for(const t in this._settings.attributes)if(this._settings.attributes.hasOwnProperty(t)&&(this._$element.find("["+t+"]:not("+c+")").each(function(){let r={element:this,resource:s(this).attr(t)};i&&(r=r.resource),e.push(r)}),this._$element.is("["+t+"]")&&!this._$element.is(c))){let s={element:this._element,resource:this._$element.attr(t)};i&&(s=s.resource),e.push(s)}return e}}(o,i).collect("plain"),l=r()+t,h=new y(c,i);if(E.push({id:l,instance:h,element:e,timeout:null}),h.progress(t=>{s(t.element).trigger("nite"+u(t.status)+".nite",[t.element,t.resource]),o.trigger("niteProgress.nite",[e,t]);const r=[h,t];"function"==typeof i.onProgress&&i.onProgress.apply(e,r);let n=u(t.status);"function"==typeof i["on"+n]&&i["on"+n].apply(e,r)}),h.done(t=>{o.trigger("niteComplete.nite",[e,t]),n.apply(e,[h,t]),i.visible&&b.off("scroll."+l),(E=E.filter(t=>t.id!==l)).forEach(t=>{o.is(t.element)&&t.instance.loop()})}),i.visible&&b.on("scroll."+l,v(()=>h.loop(),250)),!0===i.early)for(let t in E){let e=E[t];if(E[t].id===l){clearTimeout(e.timeout);let t=parseInt(i.earlyTimeout);e.timeout=setTimeout(function(){e.instance._settings.visible=!1,e.instance._settings.sequential=!0,e.instance.loop()},!isNaN(t)&&isFinite(t)?t:0);break}}})}}(window,document,jQuery);
//# sourceMappingURL=nite.loader.min.js.map
