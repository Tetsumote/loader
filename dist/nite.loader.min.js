!function(t,e,s,i){"use strict";!function(){t.console||(t.console={});let e,s,i=t.console,n=function(){},r=["memory"],o="assert,clear,count,debug,dir,dirxml,error,exception,group,groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn".split(",");for(;e=r.pop();)i[e]||(i[e]={});for(;s=o.pop();)i[s]||(i[s]=n)}(),function(){if("function"==typeof t.CustomEvent)return!1;function s(t,s){s=s||{bubbles:!1,cancelable:!1,detail:i};let n=e.createEvent("CustomEvent");return n.initCustomEvent(t,s.bubbles,s.cancelable,s.detail),n}s.prototype=t.Event.prototype,t.CustomEvent=s}(),Array.prototype.findIndex=Array.prototype.findIndex||function(t){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");const e=Object(this),s=e.length>>>0,i=arguments[1];for(let n=0;n<s;n++)if(t.call(i,e[n],n,e))return n;return-1},Array.isArray=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},[].filter||(Array.prototype.filter=function(t,e,s,i,n){for(n in i=[],s=this)~~n+""==n&&n>=0&&t.call(e,s[n],+n,s)&&i.push(s[n]);return i});const n=function(){return Math.floor(8999*Math.random())+1e3},r="nite",o=r+"Load",l=o+"er",c=n();t[l+"Cache"]=[];let h={};const a=(t,e)=>{const s=e.split(","),i=s[1];i&&(t.removeEventListener(s[0],h[e].callback),delete h[i])},_=(t,e,s,i)=>{let n=s;s=(t=>{i&&t.target.removeEventListener(t.type,arguments.callee),n()});const r=e.split(","),o=r[1];o&&(h[o]={eventName:e,callback:s},e=r[0]),t.addEventListener(e,s)},u=(t,e)=>e.indexOf(t)>-1,d=t=>t.charAt(0).toUpperCase()+t.slice(1),m=s=>{const i=e.getElementsByTagName("body")[0],n=t.innerWidth||documnt.documentElement.clientWidth||i.clientWidth,r=t.innerHeight||documnt.documentElement.clientHeight||i.clientHeight,o=s.getBoundingClientRect();return!(o.right<0||o.bottom<0||o.left>n||o.top>r)&&"none"!==t.getComputedStyle(s,"display")},p=function(t){if("object"!=typeof t)return!1;try{return t instanceof HTMLElement}catch(e){return 1===t.nodeType&&"object"==typeof t.style&&"object"==typeof t.ownerDocument}},f=function(e){return"string"==typeof e&&u(e,t[l+"Cache"])||p(e)&&"currentSrc"in e&&e.currentSrc.length&&("complete"in e&&e.complete||"readyState"in e&&e.readyState>=2)},g=function(t){return f(t)&&("object"==typeof t&&("naturalWidth"in t&&0===Math.floor(t.naturalWidth)||"videoWidth"in t&&0===t.videoWidth)||"string"==typeof t)},b=function(t,e){const s={image:"jp[e]?g||jpe|jif|jfif|jfi|gif|png|tif[f]?|bmp|dib|webp|ico|cur|svg",audio:"mp3|ogg|oga|spx|ogg|wav",video:"mp4|ogv|webm"},n=Object.keys(s);let r={format:null,extension:null};if("string"==typeof t){if(""===(t=(t=t.split("?")[0]).split("#")[0]))return!1;let o=i!==e?[e]:n;for(const e in o)if(o.hasOwnProperty(e)&&new RegExp("(.("+s[o[e]]+")$)|;base64,","g").test(t)){if(new RegExp(";base64,","g").test(t)){let i=t.match(new RegExp("^data:"+o[e]+"/("+s[o[e]]+")","g"));if(!i||null===i)continue;i=i[0],r.format=o[e],r.extension=i.replace("data:"+o[e]+"/","");break}{let i=t.match(new RegExp(s[o[e]],"g"));if(i){r.format=o[e],r.extension=i[0];break}}}}if(p(t)){let e=t.tagName.toLowerCase();u(e,n)&&(r.format=t.tagName.toLowerCase()),"img"===e&&(r.format="image")}return r};class y{constructor(e){this._settings={srcAttr:"data-src",srcsetAttr:"data-srcset",playthrough:!1,visible:!1},this._settings={...this._settings,...e},this._id=null,this._id_event=null,this._element=null,this._resource=null,this._busy=!1,this._format=null,this._done=(()=>{}),this._success=(()=>{}),this._error=(()=>{}),this._callback=(e=>{this._busy=!1;const s=this._element.currentSrc||this._element.src;u(s,t[l+"Cache"])||t[l+"Cache"].push(s);let i=[this._element,e.type,s,this._id];this["error"!==e.type?"_success":"_error"].apply(this,i),this._done.apply(this,i)})}set resource(t){const s=p(t.resource),r="string"==typeof t.resource;if(s||r){if(this._id=t.id,this._format=b(t.resource).format,this._exists=s,r){let s="image"===this._format;this._element=e.createElement(s?"img":this._format),s&&(this._settings.srcsetAttr="data-srcset"),this._settings.srcAttr="data-src",this._resource=t.resource}s&&(this._element=t.resource),r&&(this._element.dataset[this._settings.srcAttr.replace("data-","")]=this._resource,this._element.dataset[this._settings.srcsetAttr.replace("data-","")]=this._resource,this._element.setAttribute(this._settings.srcAttr,this._resourc),this._element.setAttribute(this._settings.srcsetAttr,this._resourc)),this._id_event=this._element[c+"_IDEvent"],this._busy=this._id_event!==i,this._id_event=this._busy?this._id_event:l+"_unique_"+this._element.tagName+"_"+n()}}process(){const e=this._settings.srcAttr,s=this._settings.srcAttr.replace("data-","");if(f(this._exists?this._element:this._resource))return this._busy||a(this._elemnt,"."+this._id_event),this._callback(new CustomEvent(g(this._exists?this._element:this._resource)?"error":"load")),!1;if(this._exists&&this._settings.visible&&!m(this._element))return!1;if("image"===this._format){_(this._element,"load."+this._id_event,this._callback,!this._busy),_(this._element,"error."+this._id_event,this._callback,!this._busy);const i=this._element.closest("picture"),n=this._settings.srcsetAttr,r=this._settings.srcsetAttr.replace("data-","");i&&"HTMLPictureElement"in t?(delete this._element.dataset[r],delete this._element.dataset[s],this._element.removeAttribute(n),this._element.removeAttribute(e),i.queryAll("source["+n+"]").forEach(t=>{t.addAttribute("srcset",this._element.dataset[r]),delete this._element.dataset[r],t.removeAttribute(n)})):(this._element.matches("["+n+"]")&&(this._element.addAttribute("srcset",this._element.dataset[r]),delete this._element.dataset[r],this._element.removeAttribute(n)),this._element.matches("["+e+"]")&&(this._element.addAttribute("src",this._element.dataset[s]),delete this._element.dataset[s],this._element.removeAttribute(e)))}else{if("video"!==this._format&&"audio"!==this._format)return!1;{const t=!0===this._settings.playthrough,i="full"===this._settings.playthrough,n=this._element.queryAll("source"),r=function(t){return t.buffered.length&&Math.round(t.buffered.end(0))/Math.round(t.seekable.end(0))==1};let o=!1;n?n.forEach(t=>{t.matches("["+e+"]")&&(t.setAttribute("src",t.dataset[s]),delete t.dataset[s],t.removeAttribute(e),o=!0),_(t,"error."+this._id_event,e=>{const s=l+"_error";t[c+"_"+s]=!0,n.length===n.filter(()=>!0===t[c+"_"+s]).length&&this._callback(e)},!this._busy)}):this._element.matches("["+e+"]")&&(this._element.setAttribute("src",this._$element.data(s)),delete this._element.dataset[s],this._element.removeAttribute(e),_(this._element,"error."+this._id_event,this._callback,!this._busy),o=!0),o&&this._element.load(),_(this._element,"loadedmetadata."+this._id_event,()=>{if(t||i||this._callback(new CustomEvent("load")),i){let t=setInterval(()=>{let e=this._element.readyState>0&&!this._element.duration;e||r(this._element)?(this._element.currentTime=0,!e&&!this._busy&&this._element.paused&&this._element.matches("[autoplay]")&&this._element.play(),clearInterval(t),this._callback(new CustomEvent(e?"error":"load"))):(this._element.paused||this._element.pause(),this._busy||(this._element.currentTime+=2))},500);this._element[l+"_"+this._id_event]=t}},!this._busy),_(this._element,"canplay."+this._id_event,()=>{i&&0===this._element.currentTime&&!r(this._element)&&this._element.currentTime++},!this._busy),_(this._element,"canplaythrough."+this._id_event,()=>{t&&this._callback(new CustomEvent("load"))},!this._busy)}}return this._busy||(this._element[c+"_IDEvent"]=this._id_event),this._resource=this._element.currentSrc||this._element.src,!this._busy}done(t){"function"==typeof t&&(this._done=function(e,s,i,n){t.apply(this,[e,s,i,n])})}abort(){if(a(this._elemnt,"."+this._id_event),f(this._exists?this._element:this._resource))return;const t=this._element.getAttribute("srcset"),e=this._element.getAttribute("src");i!==t&&(this._element.dataset[t]=this._settings.srcAttr,this._element.setAttribute(this._settings.srcAttr,t),this._element.removeAttribute("src"),this._element.removeAttribute("srcset")),i!==e&&(this._element.dataset[e]=this._settings.srcsetAttr,this._element.setAttribute(this._settings.srcsetAttr,e),this._element.removeAttribute("src"),this._element.removeAttribute("srcset"))}}class v{constructor(t,e){if(this._collection=[],this._collection_loaded=[],this._collection_instances=[],this._collection_pending=[],this._resources_loaded=[],Array.isArray(t)&&("string"==typeof t[0]||p(t[0])))for(const e in t)t.hasOwnProperty(e)&&this._collection.push({id:n(),resource:t[e]});("string"==typeof t||p(t))&&this._collection.push({id:n(),resource:t}),this._settings={srcAttr:"data-src",srcsetAttr:"data-srcset",playthrough:!1,visible:!1},this._settings={...this._settings,...e},this.percentage=0,this._done=(()=>{}),this._progress=(()=>{}),this._success=(()=>{}),this._error=(()=>{}),this._abort=!1,this._loaded=0,this._complete=!1,this._busy=!1,(this._loop=(()=>setTimeout(()=>this.loop(),25)))()}loop(){this._collection_pending=[];const t=!0===this._settings.sequential;for(let e=0;e<this._collection.length&&!this._abort;e++){let i=this._collection[e].id,n=this._collection_instances.findIndex(t=>t.id===i),o=new y(this._settings);-1===n?(this._collection_instances.push({id:i,instance:o}),n=this._collection_instances.findIndex(t=>t.id===i)):this._collection_instances[n].instance=o,o.resource=this._collection[e],o.done((e,i,n,o)=>{if(this._complete||this._abort)return;let l=!u(o,this._collection_loaded);if(l){this._collection_loaded.push(o),this._busy=!1,this._loaded++,this.percentage=this._loaded/this._collection.length*100,this.percentage=parseFloat(this.percentage.toFixed(4));let t={resource:n,status:i};this._resources_loaded.push(t),this._progress.call(this,t),this["error"!==i?"_success":"_error"].call(this,t),s&&s(e).trigger(r+d(i)+"."+r,[e,n])}this._loaded===this._collection.length?(this._done.call(this,this._resources_loaded),this._complete=!0):l&&t&&this._collection_pending.length&&(this._collection_pending=this._collection_pending.filter(t=>t.id!==o),this._collection_pending=this._collection_pending.filter(t=>t.id!==o),this._collection_pending.length&&(this._busy=this._collection_pending[0].instance.process()))}),!t||t&&!this._busy?this._busy=o.process():t&&this._busy&&(!this._settings.visible||this._settings.visible&&m(o._element))&&this._collection_pending.push({id:i,instance:o})}}done(t){if("function"!=typeof t)return;const e=function(e){t.call(this,e)};this._collection.length?(this._done=e,this._loop()):e()}progress(t){if("function"!=typeof t)return;const e=function(e){t.call(this,e)};this._collection.length&&(this._progress=e,this._loop())}success(t){if("function"!=typeof t)return;const e=function(e){t.call(this,e)};this._collection.length&&(this._success=e,this._loop())}error(t){if("function"!=typeof t)return;const e=function(e){t.call(this,e)};this._collection.length&&(this._error=e,this._loop())}abort(){for(const t in this._collection_instances)this._collection_instances[t].instance.abort();this._collection.length&&(this._abort=!0)}}if("function"==typeof define&&define.amd?define(o,o):"object"==typeof exports?module.exports[o]=o:t[o]=o,!s)return i;s[o]=v;s(e);const A=s(t),E=(t,e,s=this)=>{let i=null,n=null;const r=()=>{t.apply(s,n),i=null};return function(){i||(n=arguments,i=setTimeout(r,e))}};let w=[];s.fn[o]=function(t){let e=t;"object"!=typeof t&&(t={});let i={srcAttr:"data-src",srcsetAttr:"data-srcset",visible:!1,sequential:!1,backgrounds:!1,extraAttrs:[],playthrough:!1,early:!1,earlyTimeout:0,onProgress:()=>{},onLoad:()=>{},onError:()=>{},onComplete:()=>{}},o=(i={...i,...t}).onComplete;return s.isFunction(e)&&(o=e),s.isArray(i.attributes)||(i.attributes=[]),"string"==typeof i.attributes&&(i.attributes=i.attributes.split(" ")),this.each(function(t){const e=this,l=s(e),c=new class{constructor(t,e){this._$element=t,this._element=t[0],this._settings={srcAttr:"data-src",srcsetAttr:"data-srcset",backgrounds:!1,attributes:[]},this._settings={...this._settings,...e}}collect(t){let e=[];const i="plain"===t,n=this._settings.srcAttr,r=this._settings.srcsetAttr,o="img, video, audio",l=o+", picture, source";let c=this._$element.find(o);if(this._$element.is(o)&&(c=c.add(this._$element)),(c=c.filter(function(){let t=s(this),e="["+n+"], ["+r+"]";return t.is(e)||t.children(l).filter(e).length})).each(function(){let t={element:this,resource:s(this).attr(n)||s(this).attr(r)};i&&(t=t.element),e.push(t)}),!0===this._settings.backgrounds&&this._$element.find("*").addBack().not(l).filter(function(){return"none"!==s(this).css("background-image")}).each(function(){const t=s(this).css("background-image").match(/\((.*?)\)/);if(null===t||t.length<2)return!0;let n={element:this,resource:t[1].replace(/('|")/g,"")};i&&(n=n.resource),e.push(n)}),this._settings.attributes.length)for(const t in this._settings.attributes)if(this._settings.attributes.hasOwnProperty(t)&&(this._$element.find("["+t+"]:not("+l+")").each(function(){let n={element:this,resource:s(this).attr(t)};i&&(n=n.resource),e.push(n)}),this._$element.is("["+t+"]")&&!this._$element.is(l))){let s={element:this._element,resource:this._$element.attr(t)};i&&(s=s.resource),e.push(s)}return e}}(l,i).collect("plain"),h=n()+t,a=new v(c,i);if(w.push({id:h,instance:a,element:e,timeout:null}),a.progress(function(t){l.trigger(r+"Progress."+r,[e,t]);const s=[a,t];"function"==typeof i.onProgress&&i.onProgress.apply(e,s);let n=d(t.status);"function"==typeof i["on"+n]&&i["on"+n].apply(e,s)}),a.done(function(t){l.trigger(r+"Complete."+r,[e,t]),o.apply(e,[a,t]),i.visible&&A.off("scroll."+h),(w=w.filter(t=>t.id!==h)).forEach(t=>{l.is(t.element)&&t.instance.loop()})}),i.visible&&A.on("scroll."+h,E(()=>a.loop(),250)),!0===i.early)for(let t in w){let e=w[t];if(w[t].id===h){clearTimeout(e.timeout);let t=parseInt(i.earlyTimeout);e.timeout=setTimeout(function(){e.instance._settings.visible=!1,e.instance._settings.sequential=!0,e.instance.loop()},!isNaN(t)&&isFinite(t)?t:0);break}}})}}(window,document,jQuery);
//# sourceMappingURL=nite.loader.min.js.map
