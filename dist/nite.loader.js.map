{"version":3,"sources":["nite.loader.js"],"names":["global","factory","exports","module","define","amd","NiteLoader","generateInstanceID","Math","floor","random","stringContains","heystack","needle","String","prototype","includes","indexOf","stringStartsWith","startsWith","substr","length","arrayFindIndex","filter","Array","findIndex","index","hyphensToCamelCase","string","replace","g","toUpperCase","capitalize","charAt","slice","nodelistToArray","nodelist","isInArray","throttle","callback","wait","context","undefined","timeout","callbackArgs","later","apply","arguments","setTimeout","privateCache","intersectionObserverSupported","window","pictureElementSupported","jQueryIncluded","isVisible","element","intersectionRatio","getComputedStyle","bodyEl","document","getElementsByTagName","winWidth","innerWidth","documnt","documentElement","clientWidth","winHeight","innerHeight","clientHeight","rect","getBoundingClientRect","right","bottom","left","top","isHTMLElement","HTMLElement","e","nodeType","style","ownerDocument","isLoaded","source","currentSrc","complete","readyState","isFullyBuffered","media","buffered","round","end","seekable","isBroken","naturalWidth","videoWidth","pluginPrefix","pluginMethod","pluginName","pluginInstance","eventNamespaceParserSeparator","supportedExtensions","image","audio","video","supportedTags","privateEventsStorage","CustomEvent","_polyfill","event","params","bubbles","cancelable","detail","evt","createEvent","initCustomEvent","Event","detachEventListener","events","key","eventNameWithNamespace","split","type","namespace","join","removeEventListener","handler","attachEventListener","once","count","_handler","call","addEventListener","decodeResource","output","format","extension","tag","consistent","resource","formatCandidate","base64Heading","RegExp","test","matches64","match","matches","tagName","toLowerCase","allTags","Object","values","forEach","tags","SingleLoader","options","_settings","srcAttr","srcsetAttr","playthrough","visible","Error","_id","_idEvent","_busy","_element","_resource","_format","_observer","_done","_success","_error","_callback","unobserve","src","push","thisArguments","_exists","_consistent","_originalElement","picture","closest","dataset","querySelectorAll","el","setAttribute","isStandardPlaythrough","isFullPlaythrough","sources","callMediaLoad","sourcesErrorId","thisSource","load","onProgressReplacementInterval","setInterval","isError","duration","currentTime","paused","play","clearInterval","pause","status","id","getAttribute","srcset","removeAttribute","data","info","_tag","createElement","IntersectionObserver","entries","observer","entry","target","root","rootMargin","threshold","observe","Loader","_collection","_collectionLoaded","_collectionInstances","_collectionPending","_resourcesLoaded","backgrounds","percentage","_progress","_loop","_abort","_loaded","_complete","sequentialMode","sequential","i","thisLoadId","thisLoadIndex","x","thisLoadInstance","instance","done","aProgress","parseFloat","toFixed","thisResource","resources","thisInstance","abort","collection","collectedResources","findResources","err","item","settings","body","targets","targetsExtended","targetsFilter","targetsTags","children","targetSource","targetsBg","backgroundImage","url","$","jQuery","$window","methodCollection","fn","originalUserOptions","early","earlyTimeout","onProgress","onLoad","onError","onComplete","isFunction","each","$element","uniqueMethodPluginName","progress","trigger","eventName","off","is","thisMethodCollection","on","breakLoop","clearTimeout","parseInt","isNaN","isFinite"],"mappings":"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","file":"nite.loader.js","sourcesContent":["(function (global, factory) {\n    typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n    typeof define === 'function' && define.amd ? define('NiteLoader', factory) :\n    (global.NiteLoader = factory());\n}(this, (function () { 'use strict';\n\n    /**\n     * @returns {string}\n     */\n    const generateInstanceID = () => {\n        return Math.floor(Math.random() * (9999 - 1000)) + 1000;\n    };\n\n    /**\n     * @param {string} heystack\n     * @param {string} needle\n     * @returns {boolean}\n     */\n    const stringContains = (heystack, needle) => {\n        return String.prototype.includes ? heystack.includes(needle) : heystack.indexOf(needle, 0) !== -1;\n    };\n\n    /**\n     * @param {string} heystack\n     * @param {string} needle\n     * @returns {boolean}\n     */\n    const stringStartsWith = (heystack, needle) => {\n        return String.prototype.startsWith ? heystack.startsWith(needle) : heystack.substr(0, needle.length) === needle;\n    };\n\n    /**\n     * @param {Array} heystack\n     * @param {Function} filter\n     * @returns {number}\n     */\n    const arrayFindIndex = (heystack, filter) => {\n        return Array.prototype.findIndex\n            ? heystack.findIndex(filter)\n            : (() => {\n                  let length = heystack.length,\n                      index = -1;\n                  while (++index < length) {\n                      if (filter(heystack[index], index, heystack)) {\n                          return index;\n                      }\n                  }\n                  return -1;\n              })();\n    };\n\n    /**\n     * @param {string} string\n     * @returns {string}\n     */\n    const hyphensToCamelCase = string => {\n        return string.replace(/-([a-z])/g, g => g[1].toUpperCase());\n    };\n\n    /**\n     * @param {string} string\n     * @returns {string}\n     */\n    const capitalize = string => {\n        return string.charAt(0).toUpperCase() + string.slice(1);\n    };\n\n    /**\n     * @param {NodeList} nodelist\n     * @returns {Array}\n     */\n    const nodelistToArray = nodelist => {\n        return [...nodelist];\n    };\n\n    /**\n     * @param {String|number} needle\n     * @param {Array} heystack\n     * @returns {boolean}\n     */\n    const isInArray = (needle, heystack) => {\n        return heystack.indexOf(needle) > -1;\n    };\n\n    // thanks https://gist.github.com/beaucharman/e46b8e4d03ef30480d7f4db5a78498ca\n    const throttle = (callback, wait, context = undefined) => {\n        let timeout = null;\n        let callbackArgs = null;\n        const later = () => {\n            callback.apply(context, callbackArgs);\n            timeout = null;\n        };\n        return function() {\n            if (!timeout) {\n                callbackArgs = arguments;\n                timeout = setTimeout(later, wait);\n            }\n        };\n    };\n\n    let privateCache = [];\n\n    const intersectionObserverSupported = 'IntersectionObserver' in window;\n    const pictureElementSupported = 'HTMLPictureElement' in window;\n    const jQueryIncluded = 'jQuery' in window;\n\n    /**\n     * @param {HTMLElement} element\n     * @returns {boolean}\n     */\n    const isVisible = element => {\n        if (intersectionObserverSupported && 'intersectionRatio' in element) {\n            return element.intersectionRatio > 0;\n        }\n\n        if (window.getComputedStyle(element, 'display') === 'none') {\n            return false;\n        }\n\n        const bodyEl = document.getElementsByTagName('body')[0];\n        const winWidth = window.innerWidth || documnt.documentElement.clientWidth || bodyEl.clientWidth;\n        const winHeight = window.innerHeight || documnt.documentElement.clientHeight || bodyEl.clientHeight;\n        const rect = element.getBoundingClientRect();\n\n        return !(rect.right < 0 || rect.bottom < 0 || rect.left > winWidth || rect.top > winHeight);\n    };\n\n    /**\n     * @param {HTMLElement} element\n     * @returns {boolean}\n     */\n    const isHTMLElement = element => {\n        if (typeof element !== 'object') {\n            return false;\n        }\n        try {\n            return element instanceof HTMLElement;\n        } catch (e) {\n            return element.nodeType === 1 && typeof element.style === 'object' && typeof element.ownerDocument === 'object';\n        }\n    };\n\n    /**\n     * @param {(string|HTMLVideoElement|HTMLAudioElement|HTMLImageElement)} source\n     * @returns {boolean}\n     */\n    const isLoaded = source => {\n        return (\n            (typeof source === 'string' && isInArray(source, privateCache)) ||\n            (isHTMLElement(source) &&\n                ('currentSrc' in source && source.currentSrc.length > 0) &&\n                (('complete' in source && source.complete) || ('readyState' in source && source.readyState >= 2)))\n        );\n    };\n\n    /**\n     * @param {(HTMLVideoElement|HTMLAudioElement)} source\n     * @returns {boolean}\n     */\n    const isFullyBuffered = media => {\n        return media.buffered.length && Math.round(media.buffered.end(0)) / Math.round(media.seekable.end(0)) === 1;\n    };\n\n    /**\n     * @param {(string|HTMLElement)} source\n     * @returns {boolean}\n     */\n    const isBroken = source => {\n        return (\n            isLoaded(source) &&\n            ((isHTMLElement(source) && (('naturalWidth' in source && Math.floor(source.naturalWidth) === 0) || ('videoWidth' in source && source.videoWidth === 0))) ||\n                typeof source === 'string')\n        );\n    };\n\n    const pluginPrefix = 'nite';\n    const pluginMethod = pluginPrefix + 'Load';\n    const pluginName = pluginMethod + 'er';\n    const pluginInstance = generateInstanceID();\n    const eventNamespaceParserSeparator = '__namespace__';\n\n    const supportedExtensions = {\n        image: 'jp[e]?g|jpe|jif|jfif|jfi|gif|png|tif[f]?|bmp|dib|webp|ico|cur|svg',\n        audio: 'mp3|ogg|oga|spx|ogg|wav',\n        video: 'mp4|ogv|webm'\n    };\n\n    const supportedTags = {\n        image: 'img|picture|source',\n        audio: 'audio|source',\n        video: 'video|source'\n    };\n\n    let privateEventsStorage = {};\n\n    const CustomEvent =\n        window.CustomEvent ||\n        (() => {\n            const _polyfill = (event, params) => {\n                params = params || { bubbles: false, cancelable: false, detail: undefined };\n                const evt = document.createEvent('CustomEvent');\n                evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n                return evt;\n            };\n            _polyfill.prototype = window.Event.prototype;\n            return _polyfill;\n        })();\n\n    /**\n     * @param {HTMLElement} element\n     * @param {string} events\n     * @returns {undefined}\n     */\n    const detachEventListener = (element, events) => {\n        if (!element || typeof events !== 'string') {\n            return;\n        }\n\n        if (stringStartsWith(events, '.')) {\n            for (let key in privateEventsStorage) {\n                const eventNameWithNamespace = key.replace(eventNamespaceParserSeparator, '.');\n                if (stringContains(eventNameWithNamespace, events) && privateEventsStorage[key].element === element) {\n                    detachEventListener(element, eventNameWithNamespace);\n                }\n            }\n        } else {\n            events = events.split('.');\n\n            const type = events[0],\n                namespace = events[1];\n\n            if (namespace) {\n                events = events.join(eventNamespaceParserSeparator);\n            }\n\n            if (events in privateEventsStorage) {\n                element.removeEventListener(type, privateEventsStorage[events].handler);\n                delete privateEventsStorage[events];\n            }\n        }\n    };\n\n    /**\n     * @param {HTMLElement} element\n     * @param {string} events\n     * @param {Function} handler\n     * @param {boolean} once\n     * @returns {undefined}\n     */\n    // TODO: Class EventListener .on .one .off .trigger jQuery-like...\n    const attachEventListener = (element, events, handler, once) => {\n        if (!element || typeof events !== 'string' || typeof handler !== 'function') {\n            return;\n        }\n\n        events = events.split('.');\n\n        const type = events[0];\n        const namespace = events[1];\n\n        if (namespace) {\n            events = events.join(eventNamespaceParserSeparator);\n        }\n\n        privateEventsStorage[events] = { element: element, count: 0, once: false };\n\n        if (true === once) {\n            let _handler = handler;\n            handler = function(event) {\n                if (events in privateEventsStorage) {\n                    privateEventsStorage[events].count++;\n                    if (privateEventsStorage[events].once && privateEventsStorage[events].count > 1) {\n                        return;\n                    }\n                    _handler.call(this, event);\n                }\n                detachEventListener(element, events);\n            };\n        } else {\n            once = false;\n        }\n\n        privateEventsStorage[events] = {\n            ...privateEventsStorage[events],\n            ...{ handler: handler, once: once }\n        };\n\n        element.addEventListener(type, privateEventsStorage[events].handler, { once: once });\n    };\n\n    /**\n     * @param {Object} resource\n     * @returns {Object}\n     */\n    const decodeResource = resource => {\n        let output = { format: null, extension: null, tag: null, consistent: false };\n\n        resource.resource = resource.resource.split('?')[0];\n        resource.resource = resource.resource.split('#')[0];\n        for (let formatCandidate in supportedExtensions) {\n            const base64Heading = ';base64,';\n\n            if (new RegExp('(.(' + supportedExtensions[formatCandidate] + ')$)|' + base64Heading, 'g').test(resource.resource)) {\n                if (new RegExp(base64Heading, 'g').test(resource.resource)) {\n                    let matches64 = resource.resource.match(new RegExp('^data:' + formatCandidate + '/(' + supportedExtensions[formatCandidate] + ')', 'g'));\n\n                    if (null === matches64) {\n                        return;\n                    }\n\n                    matches64 = matches64[0];\n\n                    output.format = formatCandidate;\n                    output.extension = matches64.replace('data:' + formatCandidate + '/', '');\n                    output.tag = supportedTags[formatCandidate];\n\n                    break;\n                } else {\n                    let matches = resource.resource.match(new RegExp(supportedExtensions[formatCandidate], 'g'));\n\n                    if (matches) {\n                        output.format = formatCandidate;\n                        output.extension = matches[0];\n                        output.tag = supportedTags[formatCandidate];\n\n                        break;\n                    }\n                }\n            }\n        }\n\n        if (isHTMLElement(resource.element)) {\n            let tagName = resource.element.tagName.toLowerCase();\n            let allTags = '';\n\n            Object.values(supportedTags).forEach(tags => {\n                allTags += '|' + tags;\n            });\n\n            allTags = allTags.split('|');\n\n            if (isInArray(tagName, allTags)) {\n                output.tag = tagName;\n                output.consistent = true;\n                if (output.format === null) {\n                    for (let format in supportedTags) {\n                        if (stringContains(supportedTags[format], output.tag)) {\n                            output.format = format;\n                            break;\n                        }\n                    }\n                }\n            }\n        }\n\n        if (stringContains(output.tag, '|')) {\n            output.tag = output.tag.split('|')[0];\n        }\n\n        return output;\n    };\n\n    // TODO: Promise support\n    // TODO: think about useful vars in callback args (this class is not public but its vars are returned in .progress() callback)\n    /** TODO: description of the MyClass constructor function.\n     * @class\n     * @classdesc TODO: description of the SingleLoader class.\n     */\n    class SingleLoader {\n        /**\n         * @param {Object} [options={ srcAttr: 'data-src', srcsetAttr: 'data-srcset', playthrough: false, visible: false }]\n         */\n        constructor(options) {\n            this._settings = {\n                ...{\n                    srcAttr: 'data-src',\n                    srcsetAttr: 'data-srcset',\n                    playthrough: false,\n                    visible: false\n                },\n                ...options\n            };\n\n            if (!stringStartsWith(this._settings.srcAttr, 'data-') || !stringStartsWith(this._settings.srcsetAttr, 'data-')) {\n                throw new Error('Wrong arguments format: srcAttr and srcsetAttr parameters must be dataset values.');\n            }\n\n            this.srcAttr = hyphensToCamelCase(this._settings.srcAttr.replace('data-', ''));\n            this.srcsetAttr = hyphensToCamelCase(this._settings.srcsetAttr.replace('data-', ''));\n\n            this._id = null;\n            this._idEvent = null;\n            this._busy = false;\n\n            this._element = null;\n            this._resource = null;\n            this._format = null;\n            this._observer = null;\n\n            this._done = () => {};\n            this._success = () => {};\n            this._error = () => {};\n\n            this._callback = e => {\n                this._busy = false;\n                if (null !== this._observer) {\n                    this._observer.unobserve(this._element);\n                }\n\n                const src = this._element.currentSrc || this._element.src;\n\n                if (!isInArray(src, privateCache)) {\n                    privateCache.push(src);\n                }\n\n                let thisArguments = [this._element, e.type, src, this._id];\n\n                this[e.type !== 'error' ? '_success' : '_error'].apply(this, thisArguments);\n                this._done.apply(this, thisArguments);\n            };\n        }\n\n        /**\n         * @param {Object} data\n         */\n        set resource(data) {\n            if (typeof data === 'object' && 'id' in data && 'element' in data && 'resource' in data) {\n                this._id = data.id;\n                this._element = data.element;\n                this._resource = data.resource;\n\n                this._busy = this._idEvent !== undefined;\n\n                // TODO: FIXME: if this.busy, ottieni tutte le variabili seguenti da una cache.\n\n                let info = decodeResource({\n                    resource: this._resource,\n                    element: this._element\n                });\n                this._tag = info.tag;\n                this._consistent = info.consistent; // wrong tag for resource type...\n                this._format = info.format;\n                this._exists = this._element !== null;\n                this._originalElement = this._element;\n\n                if (!this._exists || !this._consistent) {\n                    this._element = document.createElement(this._tag);\n                    this._element.dataset[this.srcAttr] = this._resource;\n                }\n\n                this._idEvent = this._busy ? this._element[pluginInstance + '_IDEvent'] : pluginName + '_unique_' + this._element.tagName + '_' + generateInstanceID();\n\n                //TODO: FIXME: this._lazy = this._busy ? this._lazy : !!(this._element.dataset[this.srcAttr] || this._element.dataset[this.srcsetAttr]);\n\n                if (this._exists && this._settings.visible && intersectionObserverSupported) {\n                    this._observer = new IntersectionObserver(\n                        (entries, observer) => {\n                            entries.forEach(entry => (entry.target.intersectionRatio = entry.intersectionRatio));\n                        },\n                        {\n                            root: null,\n                            rootMargin: '0px',\n                            threshold: 0.1\n                        }\n                    );\n                    this._observer.observe(this._originalElement);\n                }\n            }\n        }\n\n        /**\n         * @returns {string}\n         */\n        get resource() {\n            return this._resource;\n        }\n\n        /**\n         * @returns {boolean} se ha preso in carico il caricamento oppure no per vari motivi (è già caricato, non è nella viewport etc)\n         */\n        load() {\n            // TODO: FIXME: (3) check for placeholders / non-lazy resources\n            // if isLoaded(this._exists && this._consistent ? this._element : this._resource) &&\n            // (\n            //    ( this._lazy && ( data-xyz-src === src || data-xyz-srcset === srcset ) ) // TODO: capire come\n            //    ||\n            //    !this._lazy\n            // )\n\n            //TODO: remove elseif else when returning?\n            if (isLoaded(this._exists && this._consistent ? this._element : this._resource)) {\n                if (!this._busy) {\n                    // TODO: mayabe this should be called in this._callback\n                    detachEventListener(this._element, '.' + this._idEvent);\n                }\n\n                this._callback(new CustomEvent(!isBroken(this._exists && this._consistent ? this._element : this._resource) ? 'load' : 'error'));\n\n                return false;\n            } else if (this._exists && this._settings.visible && !isVisible(this._originalElement)) {\n                return false;\n            } else {\n                if (this._format === 'image') {\n                    attachEventListener(this._element, 'load.' + this._idEvent, this._callback, !this._busy);\n                    attachEventListener(this._element, 'error.' + this._idEvent, this._callback, !this._busy);\n\n                    const picture = this._element.closest('picture');\n\n                    if (picture && pictureElementSupported) {\n                        delete this._element.dataset[this.srcsetAttr];\n                        delete this._element.dataset[this.srcAttr];\n\n                        picture.querySelectorAll('source[' + this._settings.srcsetAttr + ']').forEach(el => {\n                            el.setAttribute('srcset', el.dataset[this.srcAttr]);\n                            delete el.dataset[this.srcAttr];\n                        });\n                    } else {\n                        if (this._element.matches('[' + this._settings.srcsetAttr + ']')) {\n                            this._element.setAttribute('srcset', this._element.dataset[this.srcsetAttr]);\n                            delete this._element.dataset[this.srcsetAttr];\n                        }\n\n                        if (this._element.matches('[' + this._settings.srcAttr + ']')) {\n                            this._element.setAttribute('src', this._element.dataset[this.srcAttr]);\n                            delete this._element.dataset[this.srcAttr];\n                        }\n                    }\n                } else if (this._format === 'video' || this._format === 'audio') {\n                    const isStandardPlaythrough = true === this._settings.playthrough;\n                    const isFullPlaythrough = 'full' === this._settings.playthrough;\n                    const sources = this._element.querySelectorAll('source');\n\n                    let callMediaLoad = false;\n\n                    if (sources) {\n                        sources.forEach(source => {\n                            if (source.matches('[' + this._settings.srcAttr + ']')) {\n                                source.setAttribute('src', source.dataset[this.srcAttr]);\n                                delete source.dataset[this.srcsetAttr];\n\n                                callMediaLoad = true;\n                            }\n\n                            attachEventListener(\n                                source,\n                                'error.' + this._idEvent,\n                                e => {\n                                    const sourcesErrorId = pluginName + '_error';\n\n                                    source[pluginInstance + '_' + sourcesErrorId] = true;\n\n                                    if (sources.length === nodelistToArray(sources).filter(thisSource => true === thisSource[pluginInstance + '_' + sourcesErrorId]).length) {\n                                        this._callback(e);\n                                    }\n                                },\n                                !this._busy // true -> once, false -> on\n                            );\n                        });\n                    } else if (this._element.matches('[' + this._settings.srcAttr + ']')) {\n                        this._element.setAttribute('src', this._element.dataset[this.srcAttr]);\n                        delete this._element.dataset[this.srcAttr];\n\n                        attachEventListener(\n                            this._element,\n                            'error.' + this._idEvent,\n                            this._callback,\n                            !this._busy // true -> once, false -> on\n                        );\n\n                        callMediaLoad = true;\n                    }\n\n                    if (callMediaLoad) {\n                        this._element.load();\n                    }\n\n                    attachEventListener(\n                        this._element,\n                        'loadedmetadata.' + this._idEvent,\n                        () => {\n                            if (!isStandardPlaythrough && !isFullPlaythrough) {\n                                this._callback(new CustomEvent('load'));\n                            }\n\n                            if (isFullPlaythrough) {\n                                let onProgressReplacementInterval = setInterval(() => {\n                                    let isError = this._element.readyState > 0 && !this._element.duration;\n\n                                    if (isError || isFullyBuffered(this._element)) {\n                                        this._element.currentTime = 0;\n\n                                        if (!isError && !this._busy && this._element.paused && this._element.matches('[autoplay]')) {\n                                            this._element.play();\n                                        }\n\n                                        clearInterval(onProgressReplacementInterval);\n\n                                        this._callback(new CustomEvent(!isError ? 'load' : 'error'));\n                                    } else {\n                                        if (!this._element.paused) {\n                                            this._element.pause();\n                                        }\n\n                                        if (!this._busy) {\n                                            this._element.currentTime += 2;\n                                        }\n                                    }\n                                }, 500);\n\n                                this._element[pluginName + '_' + this._idEvent] = onProgressReplacementInterval;\n                            }\n                        },\n                        !this._busy // true -> once, false -> on\n                    );\n\n                    attachEventListener(\n                        this._element,\n                        'canplay.' + this._idEvent,\n                        () => {\n                            if (isFullPlaythrough && this._element.currentTime === 0 && !isFullyBuffered(this._element)) {\n                                this._element.currentTime++;\n                            }\n                        },\n                        !this._busy // true -> once, false -> on\n                    );\n\n                    attachEventListener(\n                        this._element,\n                        'canplaythrough.' + this._idEvent,\n                        () => {\n                            if (isStandardPlaythrough) {\n                                this._callback(new CustomEvent('load'));\n                            }\n                        },\n                        !this._busy // true -> once, false -> on\n                    );\n                } else {\n                    return false;\n                }\n\n                if (!this._busy) {\n                    this._element[pluginInstance + '_IDEvent'] = this._idEvent;\n                }\n            }\n\n            this._resource = this._element.currentSrc || this._element.src;\n\n            return !this._busy;\n        }\n\n        /**\n         * @param {Function} callback\n         * @returns {undefined}\n         */\n        done(callback) {\n            if (typeof callback !== 'function') {\n                return;\n            }\n\n            this._done = function(element, status, resource, id) {\n                callback.apply(this, [element, status, resource, id]);\n            };\n        }\n\n        /**\n         * @returns {undefined}\n         */\n        abort() {\n            detachEventListener(this._element, '.' + this._idEvent);\n\n            if (isLoaded(this._exists ? this._element : this._resource)) {\n                return;\n            }\n\n            const src = this._element.getAttribute('srcset'),\n                srcset = this._element.getAttribute('src');\n\n            if (undefined !== src) {\n                this._element.dataset[this.srcAttr] = src;\n                this._element.setAttribute(this._settings.srcAttr, src);\n                this._element.removeAttribute('src');\n                this._element.removeAttribute('srcset');\n            }\n\n            if (undefined !== srcset) {\n                this._element.dataset[this.srcsetAttr] = srcset;\n                this._element.setAttribute(this._settings.srcsetAttr, srcset);\n                this._element.removeAttribute('src');\n                this._element.removeAttribute('srcset');\n            }\n        }\n    }\n\n    // TODO: Promise support\n    // TODO: private vars\n    // TODO: refactory succes/done/progress code...\n    /** TODO: description of the MyClass constructor function.\n     * @class\n     * @classdesc TODO: description of the Loader class.\n     */\n    class Loader {\n        /**\n         * @param {Object} [options={srcAttr: 'data-src', srcsetAttr: 'data-srcset', playthrough: false, visible: false, backgrounds: false }]\n         */\n        constructor(options) {\n            this._collection = [];\n            this._collectionLoaded = [];\n            this._collectionInstances = [];\n            this._collectionPending = [];\n            this._resourcesLoaded = [];\n\n            this._settings = {\n                ...{\n                    srcAttr: 'data-src',\n                    srcsetAttr: 'data-srcset',\n                    playthrough: false,\n                    visible: false,\n                    backgrounds: false\n                },\n                ...options\n            };\n\n            if (!stringStartsWith(this._settings.srcAttr, 'data-') || !stringStartsWith(this._settings.srcsetAttr, 'data-')) {\n                throw new Error('Wrong arguments format: srcAttr and srcsetAttr parameters must be dataset values.');\n            }\n\n            this.srcAttr = hyphensToCamelCase(this._settings.srcAttr.replace('data-', ''));\n            this.srcsetAttr = hyphensToCamelCase(this._settings.srcsetAttr.replace('data-', ''));\n\n            this.percentage = 0;\n\n            this._done = () => {};\n            this._progress = () => {};\n            this._success = () => {};\n            this._error = () => {};\n            this._loop = this.load;\n\n            this._abort = false;\n            this._loaded = 0;\n            this._complete = false;\n            this._busy = false;\n        }\n\n        /**\n         *\n         * @param {HTMLElement} [element=document.body]\n         * @param {Object} [options={ srcAttr: 'src', srcsetAttr: 'srcset', backgrounds: false }]\n         */\n        static findResources(element, options) {\n            let settings = {\n                srcAttr: 'src',\n                srcsetAttr: 'srcset',\n                backgrounds: false\n            };\n\n            if (typeof element === 'object' && undefined === options) {\n                for (let key in settings) {\n                    if (key in element) {\n                        options = element;\n                        element = undefined;\n                        break;\n                    }\n                }\n            }\n\n            if (undefined === element || element === document) {\n                element = document.body;\n            }\n\n            if (!isHTMLElement(element)) {\n                throw new Error('TypeError: ' + element + ' is not of type HTMLElement.');\n            }\n\n            let collectedResources = [];\n\n            settings = {\n                ...settings,\n                ...options\n            };\n\n            const targets = 'img, video, audio';\n            const targetsExtended = targets + ', picture, source';\n            const targetsFilter = '[' + settings.srcAttr + '], [' + settings.srcsetAttr + ']';\n\n            let targetsTags = nodelistToArray(element.querySelectorAll(targets));\n\n            if (element.matches(targetsExtended)) {\n                targetsTags.push(element);\n            }\n\n            targetsTags = targetsTags.filter(target => {\n                let children = nodelistToArray(target.children);\n                children = children.filter(x => x.matches(targetsExtended));\n                children = children.filter(x => x.matches(targetsFilter));\n                return target.matches(targetsFilter) || children.length;\n            });\n            targetsTags.forEach(target => {\n                let targetSource = target;\n\n                if (!targetSource.matches(targetsFilter)) {\n                    targetSource = targetSource.querySelectorAll(targetsFilter);\n                    targetSource = [...targetSource][0];\n                }\n\n                collectedResources.push({\n                    element: target,\n                    resource: targetSource.getAttribute(settings.srcAttr) || targetSource.getAttribute(settings.srcsetAttr)\n                });\n            });\n\n            if (true === settings.backgrounds) {\n                let targetsBg = nodelistToArray(element.querySelectorAll('*'));\n                targetsBg.push(element);\n                targetsBg = targetsBg.filter(target => !target.matches(targetsExtended));\n                targetsBg = targetsBg.filter(target => getComputedStyle(target).backgroundImage !== 'none');\n                targetsBg.forEach(target => {\n                    const url = getComputedStyle(target).backgroundImage.match(/\\((.*?)\\)/);\n\n                    if (null !== url && url.length >= 2) {\n                        collectedResources.push({\n                            element: target,\n                            resource: url[1].replace(/('|\")/g, '')\n                        });\n                    }\n                });\n            }\n\n            return collectedResources;\n        }\n\n        /**\n         * @param {(Array.<String>|HTMLElement)} collection\n         */\n        set collection(collection) {\n            let collectedResources = collection;\n\n            try {\n                collectedResources = Loader.findResources(collection, this._settings);\n            } catch (err) {}\n\n            collectedResources.forEach(item => {\n                let element = {\n                    resource: '',\n                    element: null,\n                    id: generateInstanceID()\n                };\n\n                if (typeof item === 'string') {\n                    element.resource = item;\n                } else if (typeof item === 'object' && 'resource' in item) {\n                    element = { ...element, ...item };\n                } else {\n                    return;\n                }\n\n                this._collection.push(element);\n            });\n        }\n\n        /**\n         * @returns {Array} collection\n         */\n        get collection() {\n            return this._collection;\n        }\n\n        /**\n         * @returns {undefined}\n         */\n        load() {\n            if (!this._collection.length) {\n                this._done.call(this, this._resourcesLoaded);\n            }\n\n            // resets pending elements (sequential opt helper array) every time we loop\n            this._collectionPending = [];\n\n            const sequentialMode = true === this._settings.sequential;\n\n            for (let i = 0; i < this._collection.length; i++) {\n                if (this._abort) {\n                    break;\n                }\n\n                let thisLoadId = this._collection[i].id;\n                let thisLoadIndex = arrayFindIndex(this._collectionInstances, x => x.id === thisLoadId);\n                let thisLoadInstance = new SingleLoader(this._settings);\n\n                if (thisLoadIndex === -1) {\n                    this._collectionInstances.push({\n                        id: thisLoadId,\n                        instance: thisLoadInstance\n                    });\n                    thisLoadIndex = arrayFindIndex(this._collectionInstances, x => x.id === thisLoadId);\n                } else {\n                    this._collectionInstances[thisLoadIndex].instance = thisLoadInstance;\n                }\n\n                thisLoadInstance.resource = this._collection[i];\n\n                thisLoadInstance.done((element, status, resource, id) => {\n                    if (this._complete || this._abort) {\n                        return;\n                    }\n\n                    const aProgress = !isInArray(id, this._collectionLoaded);\n\n                    if (aProgress) {\n                        this._collectionLoaded.push(id);\n                        this._busy = false;\n\n                        this._loaded++;\n                        this.percentage = (this._loaded / this._collection.length) * 100;\n                        this.percentage = parseFloat(this.percentage.toFixed(4));\n\n                        const thisResource = {\n                            resource: resource,\n                            status: status,\n                            element: element\n                        };\n                        this._resourcesLoaded.push(thisResource);\n                        this._progress.call(this, thisResource);\n                        this[status !== 'error' ? '_success' : '_error'].call(this, thisResource);\n                        // TODO: dispatch event on element maybe?\n                        // element.dispatchEvent(new CustomEvent(pluginPrefix + capitalize(status) + '.' + pluginPrefix));\n                    }\n\n                    if (this._loaded === this._collection.length) {\n                        this._done.call(this, this._resourcesLoaded);\n\n                        this._complete = true;\n                    } else if (aProgress && sequentialMode && this._collectionPending.length) {\n                        this._collectionPending = this._collectionPending.filter(x => x.id !== id);\n\n                        if (this._collectionPending.length) {\n                            this._busy = this._collectionPending[0].instance.load();\n                        }\n                    }\n                });\n\n                if (!sequentialMode || (sequentialMode && !this._busy)) {\n                    this._busy = thisLoadInstance.load();\n                } else if (\n                    sequentialMode &&\n                    this._busy &&\n                    (!this._settings.visible || !thisLoadInstance._exists || (this._settings.visible && thisLoadInstance._exists && isVisible(thisLoadInstance._originalElement)))\n                ) {\n                    this._collectionPending.push({\n                        id: thisLoadId,\n                        instance: thisLoadInstance\n                    });\n                }\n            }\n        }\n\n        /**\n         * @param {Function} callback\n         * @returns {undefined}\n         */\n        done(callback) {\n            if (typeof callback !== 'function') {\n                return;\n            }\n\n            this._done = function(resources) {\n                callback.call(this, resources);\n            };\n        }\n\n        /**\n         * @param {Function} callback\n         * @returns {undefined}\n         */\n        progress(callback) {\n            if (typeof callback !== 'function') {\n                return;\n            }\n\n            this._progress = function(resource) {\n                callback.call(this, resource);\n            };\n        }\n\n        /**\n         * @param {Function} callback\n         * @returns {undefined}\n         */\n        success(callback) {\n            if (typeof callback !== 'function') {\n                return;\n            }\n\n            this._success = function(resource) {\n                callback.call(this, resource);\n            };\n        }\n\n        /**\n         * @param {Function} callback\n         * @returns {undefined}\n         */\n        error(callback) {\n            if (typeof callback !== 'function') {\n                return;\n            }\n\n            this._error = function(resource) {\n                callback.call(this, resource);\n            };\n        }\n\n        /**\n         * @returns {undefined}\n         */\n        abort() {\n            this._collectionInstances.forEach(thisInstance => {\n                thisInstance.instance.abort();\n            });\n\n            this._abort = true;\n        }\n    }\n\n    // TODO: think about a better and more elegant module-oriented way\n    if (jQueryIncluded) {\n        const $ = jQuery;\n\n        const $window = $(window);\n\n        $[capitalize(pluginName)] = Loader;\n\n        let methodCollection = [];\n\n        $.fn[pluginMethod] = function(options) {\n            let originalUserOptions = options;\n\n            if (typeof options !== 'object') {\n                options = {};\n            }\n\n            let settings = {\n                ...{\n                    srcAttr: 'data-src',\n                    srcsetAttr: 'data-srcset',\n\n                    visible: false,\n                    sequential: false,\n\n                    backgrounds: false,\n                    playthrough: false,\n\n                    early: false,\n                    earlyTimeout: 0,\n\n                    onProgress: () => {},\n                    onLoad: () => {},\n                    onError: () => {},\n\n                    onComplete: () => {}\n                },\n                ...options\n            };\n\n            let callback = settings.onComplete;\n            if ($.isFunction(originalUserOptions)) {\n                callback = originalUserOptions;\n            }\n\n            return this.each(function(i) {\n                // TODO: mutation observer when new children are appended\n\n                const $element = $(this);\n                const uniqueMethodPluginName = generateInstanceID() + i;\n                const thisLoadInstance = new Loader(settings);\n\n                thisLoadInstance.collection = this;\n\n                methodCollection.push({\n                    id: uniqueMethodPluginName,\n                    instance: thisLoadInstance,\n                    element: this,\n                    timeout: null\n                });\n\n                thisLoadInstance.progress(resource => {\n                    $(resource.element).trigger(pluginPrefix + capitalize(resource.status) + '.' + pluginPrefix, [resource.element, resource.resource]);\n                    $element.trigger(pluginPrefix + 'Progress.' + pluginPrefix, [this, resource]);\n\n                    const thisArguments = [thisLoadInstance, resource];\n\n                    if (typeof settings.onProgress === 'function') {\n                        settings.onProgress.apply(this, thisArguments);\n                    }\n\n                    let eventName = capitalize(resource.status);\n                    if (typeof settings['on' + eventName] === 'function') {\n                        settings['on' + eventName].apply(this, thisArguments);\n                    }\n                });\n\n                thisLoadInstance.done(resources => {\n                    $element.trigger(pluginPrefix + 'Complete.' + pluginPrefix, [this, resources]);\n                    callback.apply(this, [thisLoadInstance, resources]);\n\n                    if (settings.visible) {\n                        $window.off('scroll.' + uniqueMethodPluginName);\n                    }\n\n                    // refresh other method calls for same el (omitting this one)\n                    methodCollection = methodCollection.filter(x => x.id !== uniqueMethodPluginName);\n                    methodCollection.forEach(thisMethodCollection => {\n                        if ($element.is(thisMethodCollection.element)) {\n                            thisMethodCollection.instance.load();\n                        }\n                    });\n                });\n\n                thisLoadInstance.load();\n\n                if (settings.visible) {\n                    $window.on('scroll.' + uniqueMethodPluginName, throttle(() => thisLoadInstance.load(), 250));\n                }\n\n                if (true === settings.early) {\n                    let breakLoop = false;\n\n                    methodCollection.forEach(thisMethodCollection => {\n                        if (breakLoop) {\n                            return;\n                        }\n\n                        if (methodCollection[key].id === uniqueMethodPluginName) {\n                            clearTimeout(thisMethodCollection.timeout);\n\n                            let timeout = parseInt(settings.earlyTimeout);\n\n                            thisMethodCollection.timeout = setTimeout(() => {\n                                // TODO: $('.selector').niteLoad('option', 'value');\n                                thisMethodCollection.instance._settings.visible = false;\n                                thisMethodCollection.instance._settings.sequential = true;\n\n                                thisMethodCollection.instance.load();\n                            }, !isNaN(timeout) && isFinite(timeout) ? timeout : 0);\n\n                            breakLoop = true;\n                        }\n                    });\n                }\n            });\n        };\n    }\n\n    return Loader;\n\n})));\n"]}