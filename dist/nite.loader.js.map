{"version":3,"sources":["nite.loader.js"],"names":["window","document","$","undefined","namespace_prefix","namespace_method","namespace","global","console","con","prop","method","dummy","properties","methods","split","pop","error","CustomEvent","event","params","bubbles","cancelable","detail","evt","createEvent","initCustomEvent","prototype","Event","Array","findIndex","callback","TypeError","list","Object","length","thisArg","arguments","i","call","filter","a","b","c","d","e","push","cache","capitalize","string","charAt","toUpperCase","slice","$document","$window","unique_id","nite","uniqueId","Math","floor","random","is_visible","element","$el","in_viewport","inViewport","ratio","rect","getBoundingClientRect","right","bottom","left","width","top","height","is","css","is_html_object","object","HTMLElement","nodeType","style","ownerDocument","is_loaded","inArray","currentSrc","complete","readyState","is_broken","naturalWidth","videoWidth","is_format","item","expected_format","format_extensions","image","audio","video","format_names","keys","base64_heading","output","format","extension","format_queue","x","hasOwnProperty","RegExp","test","matches64","match","replace","matches","tag_name","tagName","toLowerCase","ResourceLoader","options","_settings","extend","srcAttr","srcsetAttr","playthrough","visible","_id","_id_event","_element","_$element","_resource","_busy","_format","_done","noop","_success","_error","_callback","removeData","src","this_arguments","type","apply","src_clean","_exists","off","$picture","closest","srcset","srcset_clean","removeAttr","find","attr","data","is_playthrough_mode__normal","is_playthrough_mode__full","$sources","is_fully_buffered","media","buffered","round","end","seekable","call_media_load","self","each","$t","sources_error_id","load","on_progress_replacement_interval","setInterval","is_error","duration","currentTime","paused","play","clearInterval","pause","isFunction","status","resource","id","element_resource","string_resource","is_img","createElement","ResourcesLoader","collection","_collection","_collection_loaded","_collection_instances","_collection_pending","_resources_loaded","isArray","percentage","_progress","_abort","_loaded","_complete","_loop","setTimeout","loop","sequential_mode","sequential","this_load_id","this_load_index","this_load_instance","instance","done","a_progress","parseFloat","toFixed","this_resource","trigger","process","_func","resources","key","abort","CollectionPopulator","$element","backgrounds","attributes","is_plain_data_collection","targets","targets_extended","$targets","add","children","collection_item","addBack","not","url","method_collection","fn","original_user_options","settings","extraAttrs","early","earlyTimeout","onProgress","onLoad","onError","onComplete","collect","unique_method_namespace","timeout","progress","event_name","forEach","this_method_collection","scroll","fps","throttle_scroll_event","wait","time","Date","now","on","clearTimeout","isNumeric","parseInt","jQuery"],"mappings":"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","file":"nite.loader.js","sourcesContent":["/*! JQuery Nite Loader | Daniele Fioroni | dfioroni91@gmail.com */\n(function(window, document, $, undefined){\n    'use strict';\n\n    const\n        namespace_prefix = 'nite',\n        namespace_method = namespace_prefix+'Load',\n        namespace = namespace_method+'er';\n\n\n    // thanks to https://github.com/paulmillr/console-polyfill\n    // - - - - - - - - - - - - - - - - - - - -\n    (function(global) {\n        if (!global.console)\n            global.console = {};\n        let con = global.console,\n            prop, method,\n            dummy = function() {},\n            properties = ['memory'],\n            methods = ('assert,clear,count,debug,dir,dirxml,error,exception,group,' +\n                'groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,' +\n                'show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn').split(',');\n        while (prop = properties.pop())\n            if (!con[prop])\n                con[prop] = {};\n        while (method = methods.pop())\n            if (!con[method])\n                con[method] = dummy;\n    })(window);\n    // - - - - - - - - - - - - - - - - - - - -\n\n\n    // - - - - - - - - - - - - - - - - - - - -\n    if( !$ ) {\n        console.error('jQuery is needed for '+namespace+' to work!');\n        return undefined;\n    }\n    // - - - - - - - - - - - - - - - - - - - -\n\n\n    // https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent#Polyfill\n    // - - - - - - - - - - - - - - - - - - - -\n    (function () {\n\n        if ( typeof window.CustomEvent === \"function\" )\n            return false; //If not IE\n\n        function CustomEvent ( event, params ) {\n            params = params || { bubbles: false, cancelable: false, detail: undefined };\n            let evt = document.createEvent( 'CustomEvent' );\n            evt.initCustomEvent( event, params.bubbles, params.cancelable, params.detail );\n            return evt;\n        }\n\n        CustomEvent.prototype = window.Event.prototype;\n\n        window.CustomEvent = CustomEvent;\n\n    })();\n    // - - - - - - - - - - - - - - - - - - - -\n\n\n    // thanks to https://github.com/jsPolyfill/Array.prototype.findIndex\n    // todo check efficiency and reliability in MS Internet Explorer\n    // - - - - - - - - - - - - - - - - - - - -\n    Array.prototype.findIndex = Array.prototype.findIndex || function(callback) {\n        if (this === null) {\n            throw new TypeError('Array.prototype.findIndex called on null or undefined');\n        } else if (typeof callback !== 'function') {\n            throw new TypeError('callback must be a function');\n        }\n        const\n            list = Object(this),\n            // Makes sures is always has an positive integer as length.\n             length = list.length >>> 0,\n             thisArg = arguments[1];\n        for (let i = 0; i < length; i++) {\n            if ( callback.call(thisArg, list[i], i, list) ) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    // - - - - - - - - - - - - - - - - - - - -\n\n\n    // thanks to https://gist.github.com/eliperelman/1031656\n    // todo check efficiency and reliability in MS Internet Explorer\n    // - - - - - - - - - - - - - - - - - - - -\n    [].filter||(Array.prototype.filter=function(a,b,c,d,e){c=this;d=[];for(e in c)~~e+''==e&&e>=0&&a.call(b,c[e],+e,c)&&d.push(c[e]);return d})\n    // - - - - - - - - - - - - - - - - - - - -\n\n\n    let cache = [];\n\n    const\n\n        capitalize = function(string){\n            return string.charAt(0).toUpperCase() + string.slice(1);\n        },\n\n        $document = $(document),\n        $window = $(window),\n\n        unique_id = function(){\n\n            return $.nite && 'uniqueId' in $.nite ? $.nite.uniqueId() : Math.floor(Math.random() * (9999 - 1000)) + 1000;\n\n        },\n\n        is_visible = function(element){\n\n            const $el = $(element);\n\n            let in_viewport = false;\n\n            if( $.nite && 'inViewport' in $.nite )\n                in_viewport = $.nite.inViewport(element).ratio;\n\n            else{\n\n                const rect = element.getBoundingClientRect();\n\n                in_viewport = !( rect.right < 0 || rect.bottom < 0 || rect.left > $window.width() || rect.top > $window.height() );\n\n            }\n\n            return in_viewport && $el.is(':visible') && $el.css('visibility') !== 'hidden';\n\n        },\n\n        is_html_object = function( object ){\n\n            if( typeof object !== 'object' )\n                return false;\n\n            try {\n                return object instanceof HTMLElement;\n            }\n            catch(e){\n                return object.nodeType === 1 && typeof object.style === 'object' && typeof object.ownerDocument === 'object';\n            }\n\n        },\n\n        is_loaded = function(element){\n\n            return (\n                typeof element === 'string'\n                && $.inArray(element, cache) > -1\n            )\n            || (\n                is_html_object(element)\n                && ( 'currentSrc' in element && element.currentSrc.length )\n                && ( ( 'complete' in element && element.complete ) || ( 'readyState' in element && element.readyState >= 2 ) )\n            );\n\n        },\n\n        is_broken = function(element){\n\n            return is_loaded(element) && (\n                    (\n                        typeof element === 'object' && (\n                            ( 'naturalWidth' in element && Math.floor(element.naturalWidth) === 0 )\n                            ||\n                            ( 'videoWidth' in element && element.videoWidth === 0 )\n                        )\n                    )\n                    || typeof element === 'string' // todo check if is url maybe?\n                );\n\n        },\n        \n        is_format = function( item, expected_format ){\n\n            const\n                format_extensions = {\n                    image : 'jp[e]?g||jpe|jif|jfif|jfi|gif|png|tif[f]?|bmp|dib|webp|ico|cur|svg',\n                    audio : 'mp3|ogg|oga|spx|ogg|wav',\n                    video : 'mp4|ogv|webm'\n                },\n                format_names = Object.keys(format_extensions),\n                base64_heading = '\\;base64\\,';\n\n            let output = { format: null, extension: null };\n\n            if( typeof item === 'string' ) {\n\n                item = item.split('?')[0]; // get rid of query strings\n                item = item.split('#')[0]; // get rid of hashes\n\n                if (item === '')\n                    return false;\n\n                let format_queue = undefined !== expected_format ? [ expected_format ] : format_names;\n\n                for (const x in format_queue) {\n\n                    if (format_queue.hasOwnProperty(x)){\n\n                        if (new RegExp('(\\.(' + format_extensions[format_queue[x]] + ')$)|' + base64_heading, 'g').test(item)) {\n\n                            if (new RegExp(base64_heading, 'g').test(item)) {\n\n                                let matches64 = item.match(new RegExp('^data:' + format_queue[x] + '\\/(' + format_extensions[format_queue[x]] + ')', 'g'));\n\n                                if ( !matches64 || null === matches64 )\n                                    continue;\n\n                                matches64 = matches64[0];\n\n                                output.format = format_queue[x];\n                                output.extension = matches64.replace('data:' + format_queue[x] + '/', '');\n\n                                break;\n\n                            } else {\n\n                                let matches = item.match(new RegExp(format_extensions[format_queue[x]], 'g'));\n\n                                if (matches) {\n\n                                    output.format = format_queue[x];\n                                    output.extension = matches[0];\n\n                                    break;\n\n                                }\n\n                            }\n\n                        }\n\n                    }\n\n                }\n\n            }\n\n            if( is_html_object(item) ){\n\n                let tag_name = item.tagName.toLowerCase();\n                \n                if( $.inArray(tag_name, format_names) > -1 )\n                    output.format = item.tagName.toLowerCase();\n\n                if( tag_name === 'img' )\n                    output.format = 'image';\n\n            }\n\n            return output;\n    \n        };\n\n    class ResourceLoader {\n\n        constructor(options){\n\n            // todo make _vars really private\n            // todo make useful vars since this class is not public but is returned in .progress() callback\n            this._settings  = $.extend(true, {\n                srcAttr     : 'data-src',\n                srcsetAttr  : 'data-srcset',\n                playthrough : false,\n                visible     : false,\n            }, options);\n\n            this._id        = null;\n            this._id_event  = null;\n\n            this._element   = null;\n            this._$element  = $();\n\n            this._resource  = null;\n            this._busy      = false;\n\n            this._format    = null;\n\n            this._done      = $.noop;\n            this._success   = $.noop;\n            this._error     = $.noop;\n\n            this._callback  = (e) => {\n\n                this._$element.removeData(namespace);\n\n                this._busy = false;\n\n                const src = this._element.currentSrc || this._element.src;\n\n                if( $.inArray(src, cache) === -1 )\n                    cache.push(src);\n\n                let this_arguments = [ this._element, e.type, src, this._id ];\n\n                this[ e.type !== 'error' ? '_success' : '_error' ].apply(this, this_arguments);\n                this._done.apply(this, this_arguments);\n\n            };\n\n        }\n\n        set resource( data ){\n\n            const\n                element_resource = is_html_object(data.resource),\n                string_resource = typeof data.resource === 'string';\n\n            if( !element_resource && !string_resource )\n                return;\n\n            this._id = data.id;\n            this._format = is_format(data.resource).format;\n\n            this._exists = element_resource; // todo maybe search for an element with this src\n\n            if( string_resource ){\n\n                let is_img = this._format === 'image';\n\n                this._element = document.createElement(is_img ? 'img' : this._format);\n\n                if( is_img )\n                    this._settings.srcsetAttr = 'data-srcset';\n                this._settings.srcAttr = 'data-src';\n\n                this._resource = data.resource;\n\n            }\n\n            if( element_resource )\n                this._element = data.resource;\n\n            this._$element = $(this._element);\n\n            if( string_resource ){\n\n                this._$element\n                    .data(this._settings.srcAttr.replace('data-', ''), this._resource)\n                    .data(this._settings.srcsetAttr.replace('data-', ''), this._resource)\n                    .attr(this._settings.srcAttr, this._resource)\n                    .attr(this._settings.srcsetAttr, this._resource);\n\n            }\n\n            this._id_event = this._$element.data(namespace);\n            this._busy = this._id_event !== undefined;\n            this._id_event = this._busy ? this._id_event : namespace + '_unique_' + this._element.tagName + '_'+ unique_id();\n\n        }\n\n        /**\n         *\n         * @returns {boolean} se ha preso in carico il caricamento oppure no per vari motivi (è già caricato, non è nella viewport etc)\n         */\n        process(){\n\n            const\n                src = this._settings.srcAttr,\n                src_clean = this._settings.srcAttr.replace('data-', '');\n\n            if ( is_loaded( this._exists ? this._element : this._resource ) ) {\n\n                if (!this._busy)\n                    this._$element.off('.' + this._id_event); // todo this should be called when in callback\n\n                this._callback(new CustomEvent(!is_broken( this._exists ? this._element : this._resource ) ? 'load' : 'error'));\n\n                return false;\n\n            }else if( this._exists && this._settings.visible && !is_visible(this._element) ){\n\n                return false;\n\n            }else{\n\n                if( this._format === 'image' ) {\n\n                    this._$element[this._busy ? 'on' : 'one']('load.' + this._id_event + ' error.' + this._id_event, this._callback);\n\n                    const\n                        $picture = this._$element.closest('picture'),\n                        srcset = this._settings.srcsetAttr,\n                        srcset_clean = this._settings.srcsetAttr.replace('data-', '');\n\n                    if ($picture.length && 'HTMLPictureElement' in window ) {\n\n                        this._$element\n                            .removeData(srcset_clean)\n                            .removeAttr(srcset)\n                            .removeData(src_clean)\n                            .removeAttr(src);\n\n                        $picture.find('source[' + srcset + ']')\n                            .attr('srcset', $picture.data(srcset_clean))\n                            .removeData(srcset_clean)\n                            .removeAttr(srcset);\n\n                    } else {\n\n                        if (this._$element.is('[' + srcset + ']'))\n                            this._$element\n                                .attr('srcset', this._$element.data(srcset_clean))\n                                .removeData(srcset_clean)\n                                .removeAttr(srcset);\n\n                        if (this._$element.is('[' + src + ']'))\n                            this._$element\n                                .attr('src', this._$element.data(src_clean))\n                                .removeData(src_clean)\n                                .removeAttr(src);\n\n                    }\n\n                }else if( this._format === 'video' || this._format === 'audio' ){\n\n                    const\n\n                        is_playthrough_mode__normal = true === this._settings.playthrough,\n                        is_playthrough_mode__full = 'full' === this._settings.playthrough,\n\n                        $sources = this._$element.find('source'),\n                        is_fully_buffered = function(media){\n\n                            return media.buffered.length && Math.round(media.buffered.end(0)) / Math.round(media.seekable.end(0)) === 1;\n\n                        };\n\n                    let call_media_load = false;\n\n                    if( $sources.length ){\n\n                        let self = this; // todo arrow func ?\n\n                        $sources.each(function() {\n\n                            let $t = $(this);\n\n                            if ( $t.is('[' + src + ']') ) {\n\n                                $t\n                                    .attr('src', $t.data(src_clean))\n                                    .removeData(src_clean)\n                                    .removeAttr(src);\n\n                                call_media_load = true;\n\n                            }\n\n                        })\n                        [this._busy ? 'on' : 'one']('error.' + this._id_event, function(e){\n\n                            const sources_error_id = namespace+'_error';\n\n                            $(this).data(sources_error_id, true);\n\n                            if( $sources.length === $sources.filter(function(){ return true === $(this).data(sources_error_id); }).length )\n                                self._callback(e);\n\n                        });\n\n                    }else{\n\n                        if (this._$element.is('[' + src + ']')) {\n\n                            this._$element\n                                .attr('src', this._$element.data(src_clean))\n                                .removeData(src_clean)\n                                .removeAttr(src)\n                                [this._busy ? 'on' : 'one']('error.' + this._id_event, this._callback);\n\n                            call_media_load = true;\n\n                        }\n\n                    }\n\n                    if( call_media_load )\n                        this._element.load();\n\n                    this._$element\n                        [this._busy ? 'on' : 'one']('loadedmetadata.' + this._id_event, () => {\n\n                            if ( !is_playthrough_mode__normal && !is_playthrough_mode__full )\n                                this._callback(new CustomEvent('load'));\n\n                            if( is_playthrough_mode__full ) {\n\n                                let on_progress_replacement_interval = setInterval(() => {\n\n                                    let is_error = this._element.readyState > 0 && !this._element.duration;\n\n                                    if( is_error || is_fully_buffered(this._element) ){\n\n                                        this._element.currentTime = 0;\n\n                                        if( !is_error && !this._busy && this._element.paused && this._$element.is('[autoplay]') )\n                                            this._element.play();\n\n                                        clearInterval(on_progress_replacement_interval);\n\n                                        this._callback(new CustomEvent( !is_error ? 'load' : 'error' ));\n\n                                    } else {\n\n                                        if( !this._element.paused )\n                                            this._element.pause();\n\n                                        if( !this._busy )\n                                            this._element.currentTime += 2;\n\n                                    }\n\n                                }, 500);\n\n                                this._$element.data(this._id_event, on_progress_replacement_interval);\n\n                            }\n\n                        })\n                        [this._busy ? 'on' : 'one']('canplay.' + this._id_event, () => {\n\n                            if ( is_playthrough_mode__full && this._element.currentTime === 0 && !is_fully_buffered(this._element))\n                                this._element.currentTime++;\n\n                        })\n                        [this._busy ? 'on' : 'one']('canplaythrough.' + this._id_event, () => {\n\n                            if( is_playthrough_mode__normal )\n                                this._callback(new CustomEvent('load'));\n\n                        });\n\n                }else {\n\n                    return false;\n\n                }\n\n                if ( !this._busy )\n                    this._$element.data(namespace, this._id_event);\n\n            }\n\n            this._resource = this._element.currentSrc || this._element.src;\n\n            return !this._busy;\n\n        }\n\n        done(callback){\n\n            if( !$.isFunction(callback) )\n                return;\n\n            this._done = function(element, status, resource, id){\n                callback.apply(this, [element, status, resource, id]);\n            };\n\n        };\n\n        abort(){\n\n            this._$element\n                .off('.' + this._id_event);\n\n            if( is_loaded(this._exists ? this._element : this._resource ) )\n                return;\n\n            const\n                src = this._$element.attr('srcset'),\n                srcset = this._$element.attr('src');\n\n            if( undefined !== src )\n                this._$element\n                    .data(this._settings.srcAttr, src)\n                    .attr(this._settings.srcAttr, src)\n                    .removeAttr('src').removeAttr('srcset');\n\n            if( undefined !== srcset )\n                this._$element\n                    .data(this._settings.srcsetAttr, srcset)\n                    .attr(this._settings.srcsetAttr, srcset)\n                    .removeAttr('src').removeAttr('srcset');\n\n        }\n\n    }\n    \n    class ResourcesLoader {\n\n        constructor(collection, options) {\n\n            // todo make _vars really private\n            this._collection           = [];\n            this._collection_loaded    = [];\n            this._collection_instances = [];\n            this._collection_pending   = [];\n            this._resources_loaded     = [];\n\n            if ($.isArray(collection) && ( typeof collection[0] === 'string' || is_html_object(collection[0]) ))\n                for ( const resource in collection )\n                    if( collection.hasOwnProperty(resource) )\n                        this._collection.push({ id : unique_id(), resource : collection[resource] });\n            if ( typeof collection === 'string' || is_html_object(collection) )\n                this._collection.push({ id : unique_id(), resource : collection });\n\n            this._settings = $.extend(true, {\n                srcAttr     : 'data-src',\n                srcsetAttr  : 'data-srcset',\n                playthrough : false,\n                visible     : false,\n            }, options);\n\n            this.percentage = 0;\n\n            this._done      = $.noop;\n            this._progress  = $.noop;\n            this._success   = $.noop;\n            this._error     = $.noop;\n\n            this._abort     = false;\n            this._loaded    = 0;\n            this._complete  = false;\n            this._busy      = false;\n\n            (this._loop = () => { // self invoking this._loop\n                setTimeout( () => { // force asynchrony (gives time to chain methods synchronously)\n                    this.loop();\n                }, 25);\n            })();\n\n        }\n\n        loop(){\n\n            this._collection_pending = []; // resets pending elements (sequential opt helper array) every time we loop\n\n            const sequential_mode = true === this._settings.sequential;\n\n            for( let i = 0; i < this._collection.length; i++ ){\n\n                if( this._abort )\n                    break;\n\n                let this_load_id = this._collection[i].id,\n                    this_load_index = this._collection_instances.findIndex( x => x.id === this_load_id ),\n                    this_load_instance = new ResourceLoader(this._settings);\n\n                if( this_load_index === -1 ) {\n                    this._collection_instances.push({ id : this_load_id, instance : this_load_instance });\n                    this_load_index = this._collection_instances.findIndex( x => x.id === this_load_id );\n                }else\n                    this._collection_instances[this_load_index].instance = this_load_instance;\n\n                this_load_instance.resource = this._collection[i];\n\n                this_load_instance.done((element, status, resource, id) => {\n\n                    if( this._complete || this._abort )\n                        return;\n\n                    let a_progress = $.inArray(id, this._collection_loaded) === -1;\n\n                    if( a_progress ) {\n\n                        this._collection_loaded.push(id);\n                        this._busy = false;\n\n                        this._loaded++;\n                        this.percentage = this._loaded / this._collection.length * 100;\n                        this.percentage = parseFloat(this.percentage.toFixed(4));\n\n                        let this_resource = { resource : resource, status : status };\n                        this._resources_loaded.push(this_resource);\n\n                        this._progress.call(this, this_resource);\n                        this[ status !== 'error' ? '_success' : '_error' ].call(this, this_resource);\n\n                        $(element).trigger(namespace_prefix + capitalize(status) + '.' + namespace_prefix, [ element, resource ]);\n\n                    }\n\n                    if( this._loaded === this._collection.length ) {\n\n                        this._done.call(this, this._resources_loaded);\n\n                        this._complete = true;\n\n                    }else if( a_progress && sequential_mode ){\n\n                        if( this._collection_pending.length ){\n\n                            this._collection_pending = this._collection_pending.filter(x => x.id !== id);\n                            this._collection_pending = this._collection_pending.filter(x => x.id !== id);\n\n                            if( this._collection_pending.length )\n                                this._busy = this._collection_pending[0].instance.process();\n\n                        }\n\n                    }\n\n                });\n\n                if( !sequential_mode || ( sequential_mode && !this._busy ) )\n                    this._busy = this_load_instance.process();\n\n                else if( sequential_mode && this._busy ){\n\n                    if( !this._settings.visible || ( this._settings.visible && is_visible(this_load_instance._element) ) )\n                        this._collection_pending.push({ id : this_load_id, instance : this_load_instance });\n\n                }\n\n\n            }\n\n        }\n\n        done(callback){ // todo refactory\n\n            if( !$.isFunction(callback) )\n                return;\n\n            const _func = function(resources){\n                callback.call(this, resources);\n            };\n\n            if( this._collection.length ) {\n\n                this._done = _func;\n\n                this._loop();\n\n            }else\n                _func();\n\n        };\n\n        progress(callback){ // todo refactory\n\n            if( !$.isFunction(callback) )\n                return;\n\n            const _func = function(resource){\n                callback.call(this, resource);\n            };\n\n            if( this._collection.length ) {\n\n                this._progress = _func;\n\n                this._loop();\n\n            }\n\n        };\n\n        success(callback){ // todo refactory\n\n            if( !$.isFunction(callback) )\n                return;\n\n            const _func = function(resource){\n                callback.call(this, resource);\n            };\n\n            if( this._collection.length ) {\n\n                this._success = _func;\n\n                this._loop();\n\n            }\n\n        };\n\n        error(callback){ // todo refactory\n\n            if( !$.isFunction(callback) )\n                return;\n\n            const _func = function(resource){\n                callback.call(this, resource);\n            };\n\n            if( this._collection.length ) {\n\n                this._error = _func;\n\n                this._loop();\n\n            }\n\n        };\n\n        abort(){\n\n            for( const key in this._collection_instances )\n                this._collection_instances[ key ].instance.abort();\n\n            if( this._collection.length )\n                this._abort = true;\n\n        };\n\n    }\n\n    class CollectionPopulator {\n\n        constructor($element, options) {\n\n            this._$element  = $element;\n            this._element   = $element[0];\n\n            this._settings  = $.extend(true, {\n                srcAttr     : 'data-src',\n                srcsetAttr  : 'data-srcset',\n                backgrounds : false,\n                attributes  : []\n            }, options);\n\n        }\n\n        collect( output ) {\n\n            let collection = [];\n\n            const\n                is_plain_data_collection = output === 'plain',\n\n                src = this._settings.srcAttr,\n                srcset = this._settings.srcsetAttr,\n\n                targets = 'img, video, audio',\n                targets_extended = targets + ', picture, source';\n\n            let $targets = this._$element.find(targets);\n            if (this._$element.is(targets))\n                $targets = $targets.add(this._$element);\n            $targets = $targets.filter(function(){\n                let $t = $(this),\n                    filter = '['+src+'], ['+srcset+']';\n                return $t.is(filter) || $t.children(targets_extended).filter(filter).length;\n            });\n            $targets.each(function () {\n\n                let collection_item = {\n                    element : this,\n                    resource : $(this).attr(src) || $(this).attr(srcset)\n                };\n\n                if( is_plain_data_collection )\n                    collection_item = collection_item.element;\n\n                collection.push(collection_item);\n\n            });\n\n            if (true === this._settings.backgrounds)\n                this._$element.find('*').addBack().not(targets_extended).filter(function () {\n                    return $(this).css('background-image') !== 'none';\n                }).each(function () {\n\n                    const url = $(this).css('background-image').match(/\\((.*?)\\)/);\n\n                    if( null === url || url.length < 2 )\n                        return true;\n\n                    let collection_item = {\n                        element : this,\n                        resource : url[1].replace(/('|\")/g,'')\n                    };\n\n                    if( is_plain_data_collection )\n                        collection_item = collection_item.resource;\n\n                    collection.push(collection_item);\n\n                });\n\n            if (this._settings.attributes.length)\n                for (const attr in this._settings.attributes) {\n                    if( this._settings.attributes.hasOwnProperty(attr) ) {\n\n                        this._$element.find('[' + attr + ']:not(' + targets_extended + ')').each(function () {\n\n                            let collection_item = {\n                                element : this,\n                                resource : $(this).attr(attr)\n                            };\n\n                            if( is_plain_data_collection )\n                                collection_item = collection_item.resource;\n\n                            collection.push(collection_item);\n\n                        });\n\n                        if (this._$element.is('[' + attr + ']') && !this._$element.is(targets_extended)) {\n\n                            let collection_item = {\n                                element: this._element,\n                                resource: this._$element.attr(attr)\n                            };\n\n                            if( is_plain_data_collection )\n                                collection_item = collection_item.resource;\n\n                            collection.push(collection_item);\n\n                        }\n\n                    }\n                }\n\n            return collection;\n\n        }\n\n    }\n\n    $[namespace_method] = ResourcesLoader;\n\n    let method_collection = [];\n\n    $.fn[namespace_method] = function(options){\n\n        let original_user_options = options;\n\n        if( typeof options !== 'object' )\n            options = {};\n\n        let settings = $.extend(true, {\n\n            srcAttr       : 'data-src',\n            srcsetAttr    : 'data-srcset',\n\n            visible       : false,\n\n            sequential    : false,\n\n            backgrounds   : false,\n            extraAttrs    : [],\n\n            playthrough   : false,\n\n            early         : false,\n            earlyTimeout  : 0,\n\n            onProgress    : $.noop,\n            onLoad        : $.noop,\n            onError       : $.noop,\n\n            onComplete    : $.noop,\n\n        }, options);\n\n        let callback = settings.onComplete;\n        if( $.isFunction(original_user_options) )\n            callback = original_user_options;\n\n        if( !$.isArray(settings.attributes) )\n            settings.attributes = [];\n        if( typeof settings.attributes === 'string' )\n            settings.attributes = settings.attributes.split(' ');\n\n        return this.each(function(){\n\n            const\n                element = this,\n                $element = $(element),\n                collection = new CollectionPopulator($element, settings).collect('plain'),\n                unique_method_namespace = namespace + '_' + unique_id(),\n\n                this_load_instance = new ResourcesLoader(collection, settings);\n\n            method_collection.push({\n                id : unique_method_namespace,\n                instance : this_load_instance,\n                element : element,\n                timeout : null\n            });\n\n            this_load_instance.progress(function (resource) {\n\n                $element.trigger(namespace_prefix+'Progress.'+namespace_prefix, [element, resource]);\n\n                const this_arguments = [ this_load_instance, resource ];\n\n                if( $.isFunction(settings.onProgress) )\n                    settings.onProgress.apply(element, this_arguments);\n\n                let event_name = capitalize(resource.status);\n                if( $.isFunction(settings['on'+event_name]) )\n                    settings['on'+event_name].apply(element, this_arguments);\n\n            });\n\n            this_load_instance.done(function(resources){\n\n                $element.trigger(namespace_prefix + 'Complete.' + namespace_prefix, [ element, resources ]);\n                callback.apply(element, [ this_load_instance, resources ]);\n\n                if( settings.visible )\n                    $( $.nite && 'scroll' in $.nite ? $document : $window ).off('scroll.' + unique_method_namespace);\n\n                // refresh other method calls for same el (omitting this one)\n                method_collection = method_collection.filter( x => x.id !== unique_method_namespace );\n                method_collection.forEach((this_method_collection) => {\n                    if ($element.is(this_method_collection.element))\n                        this_method_collection.instance.loop();\n                });\n\n            });\n\n            if( settings.visible ){\n\n                if( $.nite && 'scroll' in $.nite )\n                    $.nite.scroll(unique_method_namespace, function(){ this_load_instance.loop(); }, { fps : 25 });\n\n                else{\n\n                    const throttle_scroll_event = function(fn, wait) {\n                        let time = Date.now();\n                        return function() {\n                            if( ( time + wait - Date.now() ) < 0 ){\n                                fn();\n                                time = Date.now();\n                            }\n                        }\n                    };\n\n                    $window.on('scroll.'+unique_method_namespace, throttle_scroll_event(function(){ this_load_instance.loop(); }, 1000));\n\n                }\n\n            }\n\n            if( true === settings.early ) for( let key in method_collection ) {\n\n                let this_method_collection = method_collection[key];\n\n                if (method_collection[key].id === unique_method_namespace) {\n\n                    clearTimeout(this_method_collection.timeout);\n\n                    this_method_collection.timeout = setTimeout(function () {\n\n                        // todo appropriate method for setting settings?\n                        this_method_collection.instance._settings.visible = false;\n                        this_method_collection.instance._settings.sequential = true;\n\n                        this_method_collection.instance.loop();\n\n                    }, $.isNumeric(settings.earlyTimeout) ? parseInt(settings.earlyTimeout) : 0);\n\n                    break;\n\n                }\n\n            }\n\n        });\n\n    };\n\n})(window, document, jQuery);"]}