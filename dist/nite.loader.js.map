{"version":3,"sources":["nite.loader.js"],"names":["generateInstanceID","Math","floor","random","pluginPrefix","pluginMethod","pluginName","pluginInstance","eventNamespaceParserSeparator","CustomEvent","window","_polyfill","event","params","bubbles","cancelable","detail","undefined","evt","document","createEvent","initCustomEvent","prototype","Event","supportedExtensions","image","audio","video","supportedTags","IntersectionObserverSupported","pictureElementSupported","stringContains","heystack","needle","String","includes","indexOf","stringStartsWith","startsWith","substr","length","arrayFindIndex","filter","Array","findIndex","index","detachEventListener","element","events","key","privateEventsStorage","eventNameWithNamespace","replace","split","type","namespace","join","removeEventListener","handler","attachEventListener","once","count","_handler","call","addEventListener","hyphensToCamelCase","string","g","toUpperCase","capitalize","charAt","slice","nodelistToArray","nodelist","isInArray","isVisible","intersectionRatio","getComputedStyle","bodyEl","getElementsByTagName","winWidth","innerWidth","documnt","documentElement","clientWidth","winHeight","innerHeight","clientHeight","rect","getBoundingClientRect","right","bottom","left","top","isHTMLElement","HTMLElement","e","nodeType","style","ownerDocument","isLoaded","source","privateCache","currentSrc","complete","readyState","isFullyBuffered","media","buffered","round","end","seekable","isBroken","naturalWidth","videoWidth","decodeResource","output","format","extension","tag","consistent","resource","formatCandidate","base64Heading","RegExp","test","matches64","match","matches","tagName","toLowerCase","allTags","Object","values","forEach","tags","SingleLoader","options","_settings","srcAttr","srcsetAttr","playthrough","visible","Error","_id","_idEvent","_busy","_element","_resource","_format","_observer","_done","_success","_error","_callback","unobserve","src","push","thisArguments","apply","_exists","_consistent","_originalElement","picture","closest","dataset","querySelectorAll","el","setAttribute","isStandardPlaythrough","isFullPlaythrough","sources","callMediaLoad","sourcesErrorId","thisSource","load","onProgressReplacementInterval","setInterval","isError","duration","currentTime","paused","play","clearInterval","pause","callback","status","id","getAttribute","srcset","removeAttribute","data","info","_tag","createElement","IntersectionObserver","entries","observer","entry","target","root","rootMargin","threshold","observe","Loader","_collection","_collectionLoaded","_collectionInstances","_collectionPending","_resourcesLoaded","backgrounds","percentage","_progress","_loop","_abort","_loaded","_complete","sequentialMode","sequential","i","thisLoadId","thisLoadIndex","x","thisLoadInstance","instance","done","aProgress","parseFloat","toFixed","thisResource","resources","thisInstance","abort","collection","collectedResources","findResources","err","item","settings","body","targets","targetsExtended","targetsFilter","targetsTags","children","targetSource","targetsBg","backgroundImage","url","define","amd","exports","module","$","jQuery","$document","$window","throttle","wait","context","timeout","callbackArgs","later","arguments","setTimeout","methodCollection","fn","originalUserOptions","early","earlyTimeout","onProgress","onLoad","onError","onComplete","isFunction","each","$element","uniqueMethodPluginName","progress","trigger","eventName","off","is","thisMethodCollection","on","breakLoop","clearTimeout","parseInt","isNaN","isFinite"],"mappings":"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","file":"nite.loader.js","sourcesContent":["/*! Nite Loader | Daniele Fioroni | dfioroni91@gmail.com */\r\n(() => {\r\n\t'use strict';\r\n\r\n\t/**\r\n\t * @returns {string}\r\n\t */\r\n\tconst generateInstanceID = () => {\r\n\t\treturn Math.floor(Math.random() * (9999 - 1000)) + 1000;\r\n\t};\r\n\r\n\tconst pluginPrefix = 'nite';\r\n\tconst pluginMethod = pluginPrefix + 'Load';\r\n\tconst pluginName = pluginMethod + 'er';\r\n\tconst pluginInstance = generateInstanceID();\r\n\tconst eventNamespaceParserSeparator = '__namespace__';\r\n\r\n\tconst CustomEvent =\r\n\t\twindow.CustomEvent ||\r\n\t\t(() => {\r\n\t\t\tconst _polyfill = (event, params) => {\r\n\t\t\t\tparams = params || { bubbles: false, cancelable: false, detail: undefined };\r\n\t\t\t\tconst evt = document.createEvent('CustomEvent');\r\n\t\t\t\tevt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\r\n\t\t\t\treturn evt;\r\n\t\t\t};\r\n\t\t\t_polyfill.prototype = window.Event.prototype;\r\n\t\t\treturn _polyfill;\r\n\t\t})();\r\n\r\n\tconst supportedExtensions = {\r\n\t\timage: 'jp[e]?g|jpe|jif|jfif|jfi|gif|png|tif[f]?|bmp|dib|webp|ico|cur|svg',\r\n\t\taudio: 'mp3|ogg|oga|spx|ogg|wav',\r\n\t\tvideo: 'mp4|ogv|webm'\r\n\t};\r\n\tconst supportedTags = {\r\n\t\timage: 'img|picture|source',\r\n\t\taudio: 'audio|source',\r\n\t\tvideo: 'video|source'\r\n\t};\r\n\r\n\tconst IntersectionObserverSupported = 'IntersectionObserver' in window;\r\n\tconst pictureElementSupported = 'HTMLPictureElement' in window;\r\n\r\n\t/**\r\n\t * @param {string} heystack\r\n\t * @param {string} needle\r\n\t * @returns {boolean}\r\n\t */\r\n\tconst stringContains = (heystack, needle) => {\r\n\t\treturn String.prototype.includes ? heystack.includes(needle) : heystack.indexOf(needle, 0) !== -1;\r\n\t};\r\n\r\n\t/**\r\n\t * @param {string} heystack\r\n\t * @param {string} needle\r\n\t * @returns {boolean}\r\n\t */\r\n\tconst stringStartsWith = (heystack, needle) => {\r\n\t\treturn String.prototype.startsWith\r\n\t\t\t? heystack.startsWith(needle)\r\n\t\t\t: heystack.substr(0, needle.length) === needle;\r\n\t};\r\n\r\n\t/**\r\n\t * @param {Array} heystack\r\n\t * @param {Function} filter\r\n\t * @returns {number}\r\n\t */\r\n\tconst arrayFindIndex = (heystack, filter) => {\r\n\t\treturn Array.prototype.findIndex\r\n\t\t\t? heystack.findIndex(filter)\r\n\t\t\t: (() => {\r\n\t\t\t\t\tlet length = heystack.length,\r\n\t\t\t\t\t\tindex = -1;\r\n\t\t\t\t\twhile (++index < length) {\r\n\t\t\t\t\t\tif (filter(heystack[index], index, heystack)) {\r\n\t\t\t\t\t\t\treturn index;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn -1;\r\n\t\t\t  })();\r\n\t};\r\n\r\n\t/**\r\n\t * @param {HTMLElement} element\r\n\t * @param {string} events\r\n\t * @returns {undefined}\r\n\t */\r\n\tconst detachEventListener = (element, events) => {\r\n\t\tif (!element || typeof events !== 'string') {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (stringStartsWith(events, '.')) {\r\n\t\t\tfor (let key in privateEventsStorage) {\r\n\t\t\t\tconst eventNameWithNamespace = key.replace(eventNamespaceParserSeparator, '.');\r\n\t\t\t\tif (\r\n\t\t\t\t\tstringContains(eventNameWithNamespace, events) &&\r\n\t\t\t\t\tprivateEventsStorage[key].element === element\r\n\t\t\t\t) {\r\n\t\t\t\t\tdetachEventListener(element, eventNameWithNamespace);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tevents = events.split('.');\r\n\r\n\t\t\tconst type = events[0],\r\n\t\t\t\tnamespace = events[1];\r\n\r\n\t\t\tif (namespace) {\r\n\t\t\t\tevents = events.join(eventNamespaceParserSeparator);\r\n\t\t\t}\r\n\r\n\t\t\tif (events in privateEventsStorage) {\r\n\t\t\t\telement.removeEventListener(type, privateEventsStorage[events].handler);\r\n\t\t\t\tdelete privateEventsStorage[events];\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * @param {HTMLElement} element\r\n\t * @param {string} events\r\n\t * @param {Function} handler\r\n\t * @param {boolean} once\r\n\t * @returns {undefined}\r\n\t */\r\n\tconst attachEventListener = (element, events, handler, once) => {\r\n\t\tif (!element || typeof events !== 'string' || typeof handler !== 'function') {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tevents = events.split('.');\r\n\r\n\t\tconst type = events[0];\r\n\t\tconst namespace = events[1];\r\n\r\n\t\tif (namespace) {\r\n\t\t\tevents = events.join(eventNamespaceParserSeparator);\r\n\t\t}\r\n\r\n\t\tprivateEventsStorage[events] = { element: element, count: 0, once: false };\r\n\r\n\t\tif (true === once) {\r\n\t\t\tlet _handler = handler;\r\n\t\t\thandler = function(event) {\r\n\t\t\t\tif (events in privateEventsStorage) {\r\n\t\t\t\t\tprivateEventsStorage[events].count++;\r\n\t\t\t\t\tif (privateEventsStorage[events].once && privateEventsStorage[events].count > 1) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_handler.call(this, event);\r\n\t\t\t\t}\r\n\t\t\t\tdetachEventListener(element, events);\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tonce = false;\r\n\t\t}\r\n\r\n\t\tprivateEventsStorage[events] = {\r\n\t\t\t...privateEventsStorage[events],\r\n\t\t\t...{ handler: handler, once: once }\r\n\t\t};\r\n\r\n\t\telement.addEventListener(type, privateEventsStorage[events].handler, { once: once });\r\n\t};\r\n\r\n\t/**\r\n\t * @param {string} string\r\n\t * @returns {string}\r\n\t */\r\n\tconst hyphensToCamelCase = string => {\r\n\t\treturn string.replace(/-([a-z])/g, g => g[1].toUpperCase());\r\n\t};\r\n\r\n\t/**\r\n\t * @param {string} string\r\n\t * @returns {string}\r\n\t */\r\n\tconst capitalize = string => {\r\n\t\treturn string.charAt(0).toUpperCase() + string.slice(1);\r\n\t};\r\n\r\n\t/**\r\n\t * @param {NodeList} nodelist\r\n\t * @returns {Array}\r\n\t */\r\n\tconst nodelistToArray = nodelist => {\r\n\t\treturn [...nodelist];\r\n\t};\r\n\r\n\t/**\r\n\t * @param {String|number} needle\r\n\t * @param {Array} heystack\r\n\t * @returns {boolean}\r\n\t */\r\n\tconst isInArray = (needle, heystack) => {\r\n\t\treturn heystack.indexOf(needle) > -1;\r\n\t};\r\n\r\n\t/**\r\n\t * @param {HTMLElement} element\r\n\t * @returns {boolean}\r\n\t */\r\n\tconst isVisible = element => {\r\n\t\tif (IntersectionObserverSupported && 'intersectionRatio' in element) {\r\n\t\t\treturn element.intersectionRatio > 0;\r\n\t\t}\r\n\r\n\t\tif (window.getComputedStyle(element, 'display') === 'none') {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tconst bodyEl = document.getElementsByTagName('body')[0];\r\n\t\tconst winWidth = window.innerWidth || documnt.documentElement.clientWidth || bodyEl.clientWidth;\r\n\t\tconst winHeight = window.innerHeight || documnt.documentElement.clientHeight || bodyEl.clientHeight;\r\n\t\tconst rect = element.getBoundingClientRect();\r\n\r\n\t\treturn !(rect.right < 0 || rect.bottom < 0 || rect.left > winWidth || rect.top > winHeight);\r\n\t};\r\n\r\n\t/**\r\n\t * @param {HTMLElement} element\r\n\t * @returns {boolean}\r\n\t */\r\n\tconst isHTMLElement = element => {\r\n\t\tif (typeof element !== 'object') {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\ttry {\r\n\t\t\treturn element instanceof HTMLElement;\r\n\t\t} catch (e) {\r\n\t\t\treturn (\r\n\t\t\t\telement.nodeType === 1 &&\r\n\t\t\t\ttypeof element.style === 'object' &&\r\n\t\t\t\ttypeof element.ownerDocument === 'object'\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * @param {(string|HTMLVideoElement|HTMLAudioElement|HTMLImageElement)} source\r\n\t * @returns {boolean}\r\n\t */\r\n\tconst isLoaded = source => {\r\n\t\treturn (\r\n\t\t\t(typeof source === 'string' && isInArray(source, privateCache)) ||\r\n\t\t\t(isHTMLElement(source) &&\r\n\t\t\t\t('currentSrc' in source && source.currentSrc.length > 0) &&\r\n\t\t\t\t(('complete' in source && source.complete) ||\r\n\t\t\t\t\t('readyState' in source && source.readyState >= 2)))\r\n\t\t);\r\n\t};\r\n\r\n\t/**\r\n\t * @param {(HTMLVideoElement|HTMLAudioElement)} source\r\n\t * @returns {boolean}\r\n\t */\r\n\tconst isFullyBuffered = media => {\r\n\t\treturn (\r\n\t\t\tmedia.buffered.length &&\r\n\t\t\tMath.round(media.buffered.end(0)) / Math.round(media.seekable.end(0)) === 1\r\n\t\t);\r\n\t};\r\n\r\n\t/**\r\n\t * @param {(string|HTMLElement)} source\r\n\t * @returns {boolean}\r\n\t */\r\n\tconst isBroken = source => {\r\n\t\treturn (\r\n\t\t\tisLoaded(source) &&\r\n\t\t\t((isHTMLElement(source) &&\r\n\t\t\t\t(('naturalWidth' in source && Math.floor(source.naturalWidth) === 0) ||\r\n\t\t\t\t\t('videoWidth' in source && source.videoWidth === 0))) ||\r\n\t\t\t\ttypeof source === 'string')\r\n\t\t);\r\n\t};\r\n\r\n\t/**\r\n\t * @param {Object} resource\r\n\t * @returns {Object}\r\n\t */\r\n\tconst decodeResource = resource => {\r\n\t\tlet output = { format: null, extension: null, tag: null, consistent: false };\r\n\r\n\t\tresource.resource = resource.resource.split('?')[0];\r\n\t\tresource.resource = resource.resource.split('#')[0];\r\n\t\tfor (let formatCandidate in supportedExtensions) {\r\n\t\t\tconst base64Heading = ';base64,';\r\n\r\n\t\t\tif (\r\n\t\t\t\tnew RegExp('(.(' + supportedExtensions[formatCandidate] + ')$)|' + base64Heading, 'g').test(\r\n\t\t\t\t\tresource.resource\r\n\t\t\t\t)\r\n\t\t\t) {\r\n\t\t\t\tif (new RegExp(base64Heading, 'g').test(resource.resource)) {\r\n\t\t\t\t\tlet matches64 = resource.resource.match(\r\n\t\t\t\t\t\tnew RegExp(\r\n\t\t\t\t\t\t\t'^data:' + formatCandidate + '/(' + supportedExtensions[formatCandidate] + ')',\r\n\t\t\t\t\t\t\t'g'\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tif (null === matches64) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tmatches64 = matches64[0];\r\n\r\n\t\t\t\t\toutput.format = formatCandidate;\r\n\t\t\t\t\toutput.extension = matches64.replace('data:' + formatCandidate + '/', '');\r\n\t\t\t\t\toutput.tag = supportedTags[formatCandidate];\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet matches = resource.resource.match(\r\n\t\t\t\t\t\tnew RegExp(supportedExtensions[formatCandidate], 'g')\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tif (matches) {\r\n\t\t\t\t\t\toutput.format = formatCandidate;\r\n\t\t\t\t\t\toutput.extension = matches[0];\r\n\t\t\t\t\t\toutput.tag = supportedTags[formatCandidate];\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (isHTMLElement(resource.element)) {\r\n\t\t\tlet tagName = resource.element.tagName.toLowerCase();\r\n\t\t\tlet allTags = '';\r\n\r\n\t\t\tObject.values(supportedTags).forEach(tags => {\r\n\t\t\t\tallTags += '|' + tags;\r\n\t\t\t});\r\n\r\n\t\t\tallTags = allTags.split('|');\r\n\r\n\t\t\tif (isInArray(tagName, allTags)) {\r\n\t\t\t\toutput.tag = tagName;\r\n\t\t\t\toutput.consistent = true;\r\n\t\t\t\tif (output.format === null) {\r\n\t\t\t\t\tfor (let format in supportedTags) {\r\n\t\t\t\t\t\tif (stringContains(supportedTags[format], output.tag)) {\r\n\t\t\t\t\t\t\toutput.format = format;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (stringContains(output.tag, '|')) {\r\n\t\t\toutput.tag = output.tag.split('|')[0];\r\n\t\t}\r\n\r\n\t\treturn output;\r\n\t};\r\n\r\n\tlet privateEventsStorage = {};\r\n\r\n\tlet privateCache = [];\r\n\r\n\t// TODO: Promise support\r\n\t// TODO: think about useful vars in callback args (this class is not public but its vars are returned in .progress() callback)\r\n\t/** TODO: description of the MyClass constructor function.\r\n\t * @class\r\n\t * @classdesc TODO: description of the SingleLoader class.\r\n\t */\r\n\tclass SingleLoader {\r\n\t\t/**\r\n\t\t * @param {Object} [options={ srcAttr: 'data-src', srcsetAttr: 'data-srcset', playthrough: false, visible: false }]\r\n\t\t */\r\n\t\tconstructor(options) {\r\n\t\t\tthis._settings = {\r\n\t\t\t\t...{\r\n\t\t\t\t\tsrcAttr: 'data-src',\r\n\t\t\t\t\tsrcsetAttr: 'data-srcset',\r\n\t\t\t\t\tplaythrough: false,\r\n\t\t\t\t\tvisible: false\r\n\t\t\t\t},\r\n\t\t\t\t...options\r\n\t\t\t};\r\n\r\n\t\t\tif (\r\n\t\t\t\t!stringStartsWith(this._settings.srcAttr, 'data-') ||\r\n\t\t\t\t!stringStartsWith(this._settings.srcsetAttr, 'data-')\r\n\t\t\t) {\r\n\t\t\t\tthrow new Error(\r\n\t\t\t\t\t'Wrong arguments format: srcAttr and srcsetAttr parameters must be dataset values.'\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tthis.srcAttr = hyphensToCamelCase(this._settings.srcAttr.replace('data-', ''));\r\n\t\t\tthis.srcsetAttr = hyphensToCamelCase(this._settings.srcsetAttr.replace('data-', ''));\r\n\r\n\t\t\tthis._id = null;\r\n\t\t\tthis._idEvent = null;\r\n\t\t\tthis._busy = false;\r\n\r\n\t\t\tthis._element = null;\r\n\t\t\tthis._resource = null;\r\n\t\t\tthis._format = null;\r\n\t\t\tthis._observer = null;\r\n\r\n\t\t\tthis._done = () => {};\r\n\t\t\tthis._success = () => {};\r\n\t\t\tthis._error = () => {};\r\n\r\n\t\t\tthis._callback = e => {\r\n\t\t\t\tthis._busy = false;\r\n\t\t\t\tif (null !== this._observer) {\r\n\t\t\t\t\tthis._observer.unobserve(this._element);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst src = this._element.currentSrc || this._element.src;\r\n\r\n\t\t\t\tif (!isInArray(src, privateCache)) {\r\n\t\t\t\t\tprivateCache.push(src);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet thisArguments = [this._element, e.type, src, this._id];\r\n\r\n\t\t\t\tthis[e.type !== 'error' ? '_success' : '_error'].apply(this, thisArguments);\r\n\t\t\t\tthis._done.apply(this, thisArguments);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @param {Object} data\r\n\t\t */\r\n\t\tset resource(data) {\r\n\t\t\tif (typeof data === 'object' && 'id' in data && 'element' in data && 'resource' in data) {\r\n\t\t\t\tthis._id = data.id;\r\n\t\t\t\tthis._element = data.element;\r\n\t\t\t\tthis._resource = data.resource;\r\n\r\n\t\t\t\tlet info = decodeResource({\r\n\t\t\t\t\tresource: this._resource,\r\n\t\t\t\t\telement: this._element\r\n\t\t\t\t});\r\n\t\t\t\tthis._tag = info.tag;\r\n\t\t\t\tthis._consistent = info.consistent;\r\n\t\t\t\tthis._format = info.format;\r\n\t\t\t\tthis._exists = this._element !== null;\r\n\t\t\t\tthis._originalElement = this._element;\r\n\r\n\t\t\t\tif (!this._exists || !this._consistent) {\r\n\t\t\t\t\tthis._element = document.createElement(this._tag);\r\n\t\t\t\t\tthis._element.dataset[this.srcAttr] = this._resource;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this._exists && this._settings.visible && IntersectionObserverSupported) {\r\n\t\t\t\t\tthis._observer = new IntersectionObserver(\r\n\t\t\t\t\t\t(entries, observer) => {\r\n\t\t\t\t\t\t\tentries.forEach(\r\n\t\t\t\t\t\t\t\tentry => (entry.target.intersectionRatio = entry.intersectionRatio)\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\troot: null,\r\n\t\t\t\t\t\t\trootMargin: '0px',\r\n\t\t\t\t\t\t\tthreshold: 0.1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis._observer.observe(this._originalElement);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._idEvent = this._element[pluginInstance + '_IDEvent'];\r\n\t\t\t\tthis._busy = this._idEvent !== undefined;\r\n\t\t\t\tthis._idEvent = this._busy\r\n\t\t\t\t\t? this._idEvent\r\n\t\t\t\t\t: pluginName + '_unique_' + this._element.tagName + '_' + generateInstanceID();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @returns {string}\r\n\t\t */\r\n\t\tget resource() {\r\n\t\t\treturn this._resource;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @returns {boolean} se ha preso in carico il caricamento oppure no per vari motivi (è già caricato, non è nella viewport etc)\r\n\t\t */\r\n\t\tload() {\r\n\t\t\tif (isLoaded(this._exists && this._consistent ? this._element : this._resource)) {\r\n\t\t\t\tif (!this._busy) {\r\n\t\t\t\t\t// TODO: mayabe this should be called in this._callback\r\n\t\t\t\t\tdetachEventListener(this._element, '.' + this._idEvent);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._callback(\r\n\t\t\t\t\tnew CustomEvent(\r\n\t\t\t\t\t\t!isBroken(this._exists && this._consistent ? this._element : this._resource)\r\n\t\t\t\t\t\t\t? 'load'\r\n\t\t\t\t\t\t\t: 'error'\r\n\t\t\t\t\t)\r\n\t\t\t\t);\r\n\r\n\t\t\t\treturn false;\r\n\t\t\t} else if (this._exists && this._settings.visible && !isVisible(this._originalElement)) {\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\tif (this._format === 'image') {\r\n\t\t\t\t\tattachEventListener(this._element, 'load.' + this._idEvent, this._callback, !this._busy);\r\n\t\t\t\t\tattachEventListener(this._element, 'error.' + this._idEvent, this._callback, !this._busy);\r\n\r\n\t\t\t\t\tconst picture = this._element.closest('picture');\r\n\r\n\t\t\t\t\tif (picture && pictureElementSupported) {\r\n\t\t\t\t\t\tdelete this._element.dataset[this.srcsetAttr];\r\n\t\t\t\t\t\tdelete this._element.dataset[this.srcAttr];\r\n\r\n\t\t\t\t\t\tpicture.querySelectorAll('source[' + this._settings.srcsetAttr + ']').forEach(el => {\r\n\t\t\t\t\t\t\tel.setAttribute('srcset', el.dataset[this.srcAttr]);\r\n\t\t\t\t\t\t\tdelete el.dataset[this.srcAttr];\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (this._element.matches('[' + this._settings.srcsetAttr + ']')) {\r\n\t\t\t\t\t\t\tthis._element.setAttribute('srcset', this._element.dataset[this.srcsetAttr]);\r\n\t\t\t\t\t\t\tdelete this._element.dataset[this.srcsetAttr];\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this._element.matches('[' + this._settings.srcAttr + ']')) {\r\n\t\t\t\t\t\t\tthis._element.setAttribute('src', this._element.dataset[this.srcAttr]);\r\n\t\t\t\t\t\t\tdelete this._element.dataset[this.srcAttr];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (this._format === 'video' || this._format === 'audio') {\r\n\t\t\t\t\tconst isStandardPlaythrough = true === this._settings.playthrough;\r\n\t\t\t\t\tconst isFullPlaythrough = 'full' === this._settings.playthrough;\r\n\t\t\t\t\tconst sources = this._element.querySelectorAll('source');\r\n\r\n\t\t\t\t\tlet callMediaLoad = false;\r\n\r\n\t\t\t\t\tif (sources) {\r\n\t\t\t\t\t\tsources.forEach(source => {\r\n\t\t\t\t\t\t\tif (source.matches('[' + this._settings.srcAttr + ']')) {\r\n\t\t\t\t\t\t\t\tsource.setAttribute('src', source.dataset[this.srcAttr]);\r\n\t\t\t\t\t\t\t\tdelete source.dataset[this.srcsetAttr];\r\n\r\n\t\t\t\t\t\t\t\tcallMediaLoad = true;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tattachEventListener(\r\n\t\t\t\t\t\t\t\tsource,\r\n\t\t\t\t\t\t\t\t'error.' + this._idEvent,\r\n\t\t\t\t\t\t\t\te => {\r\n\t\t\t\t\t\t\t\t\tconst sourcesErrorId = pluginName + '_error';\r\n\r\n\t\t\t\t\t\t\t\t\tsource[pluginInstance + '_' + sourcesErrorId] = true;\r\n\r\n\t\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t\tsources.length ===\r\n\t\t\t\t\t\t\t\t\t\tnodelistToArray(sources).filter(\r\n\t\t\t\t\t\t\t\t\t\t\tthisSource =>\r\n\t\t\t\t\t\t\t\t\t\t\t\ttrue === thisSource[pluginInstance + '_' + sourcesErrorId]\r\n\t\t\t\t\t\t\t\t\t\t).length\r\n\t\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\t\tthis._callback(e);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t!this._busy\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else if (this._element.matches('[' + this._settings.srcAttr + ']')) {\r\n\t\t\t\t\t\tthis._element.setAttribute('src', this._element.dataset[this.srcAttr]);\r\n\t\t\t\t\t\tdelete this._element.dataset[this.srcAttr];\r\n\r\n\t\t\t\t\t\tattachEventListener(\r\n\t\t\t\t\t\t\tthis._element,\r\n\t\t\t\t\t\t\t'error.' + this._idEvent,\r\n\t\t\t\t\t\t\tthis._callback,\r\n\t\t\t\t\t\t\t!this._busy\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tcallMediaLoad = true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (callMediaLoad) {\r\n\t\t\t\t\t\tthis._element.load();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tattachEventListener(\r\n\t\t\t\t\t\tthis._element,\r\n\t\t\t\t\t\t'loadedmetadata.' + this._idEvent,\r\n\t\t\t\t\t\t() => {\r\n\t\t\t\t\t\t\tif (!isStandardPlaythrough && !isFullPlaythrough) {\r\n\t\t\t\t\t\t\t\tthis._callback(new CustomEvent('load'));\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (isFullPlaythrough) {\r\n\t\t\t\t\t\t\t\tlet onProgressReplacementInterval = setInterval(() => {\r\n\t\t\t\t\t\t\t\t\tlet isError = this._element.readyState > 0 && !this._element.duration;\r\n\r\n\t\t\t\t\t\t\t\t\tif (isError || isFullyBuffered(this._element)) {\r\n\t\t\t\t\t\t\t\t\t\tthis._element.currentTime = 0;\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t\t\t!isError &&\r\n\t\t\t\t\t\t\t\t\t\t\t!this._busy &&\r\n\t\t\t\t\t\t\t\t\t\t\tthis._element.paused &&\r\n\t\t\t\t\t\t\t\t\t\t\tthis._element.matches('[autoplay]')\r\n\t\t\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\t\t\tthis._element.play();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tclearInterval(onProgressReplacementInterval);\r\n\r\n\t\t\t\t\t\t\t\t\t\tthis._callback(new CustomEvent(!isError ? 'load' : 'error'));\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tif (!this._element.paused) {\r\n\t\t\t\t\t\t\t\t\t\t\tthis._element.pause();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (!this._busy) {\r\n\t\t\t\t\t\t\t\t\t\t\tthis._element.currentTime += 2;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}, 500);\r\n\r\n\t\t\t\t\t\t\t\tthis._element[\r\n\t\t\t\t\t\t\t\t\tpluginName + '_' + this._idEvent\r\n\t\t\t\t\t\t\t\t] = onProgressReplacementInterval;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t!this._busy\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tattachEventListener(\r\n\t\t\t\t\t\tthis._element,\r\n\t\t\t\t\t\t'canplay.' + this._idEvent,\r\n\t\t\t\t\t\t() => {\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tisFullPlaythrough &&\r\n\t\t\t\t\t\t\t\tthis._element.currentTime === 0 &&\r\n\t\t\t\t\t\t\t\t!isFullyBuffered(this._element)\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tthis._element.currentTime++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t!this._busy\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tattachEventListener(\r\n\t\t\t\t\t\tthis._element,\r\n\t\t\t\t\t\t'canplaythrough.' + this._idEvent,\r\n\t\t\t\t\t\t() => {\r\n\t\t\t\t\t\t\tif (isStandardPlaythrough) {\r\n\t\t\t\t\t\t\t\tthis._callback(new CustomEvent('load'));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t!this._busy\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!this._busy) {\r\n\t\t\t\t\tthis._element[pluginInstance + '_IDEvent'] = this._idEvent;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis._resource = this._element.currentSrc || this._element.src;\r\n\r\n\t\t\treturn !this._busy;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @param {Function} callback\r\n\t\t * @returns {undefined}\r\n\t\t */\r\n\t\tdone(callback) {\r\n\t\t\tif (typeof callback !== 'function') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis._done = function(element, status, resource, id) {\r\n\t\t\t\tcallback.apply(this, [element, status, resource, id]);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @returns {undefined}\r\n\t\t */\r\n\t\tabort() {\r\n\t\t\tdetachEventListener(this._element, '.' + this._idEvent);\r\n\r\n\t\t\tif (isLoaded(this._exists ? this._element : this._resource)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst src = this._element.getAttribute('srcset'),\r\n\t\t\t\tsrcset = this._element.getAttribute('src');\r\n\r\n\t\t\tif (undefined !== src) {\r\n\t\t\t\tthis._element.dataset[this.srcAttr] = src;\r\n\t\t\t\tthis._element.setAttribute(this._settings.srcAttr, src);\r\n\t\t\t\tthis._element.removeAttribute('src');\r\n\t\t\t\tthis._element.removeAttribute('srcset');\r\n\t\t\t}\r\n\r\n\t\t\tif (undefined !== srcset) {\r\n\t\t\t\tthis._element.dataset[this.srcsetAttr] = srcset;\r\n\t\t\t\tthis._element.setAttribute(this._settings.srcsetAttr, srcset);\r\n\t\t\t\tthis._element.removeAttribute('src');\r\n\t\t\t\tthis._element.removeAttribute('srcset');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// TODO: Promise support\r\n\t// TODO: private vars\r\n\t// TODO: refactory succes/done/progress code...\r\n\t/** TODO: description of the MyClass constructor function.\r\n\t * @class\r\n\t * @classdesc TODO: description of the Loader class.\r\n\t */\r\n\tclass Loader {\r\n\t\t/**\r\n\t\t * @param {Object} [options={srcAttr: 'data-src', srcsetAttr: 'data-srcset', playthrough: false, visible: false, backgrounds: false }]\r\n\t\t */\r\n\t\tconstructor(options) {\r\n\t\t\tthis._collection = [];\r\n\t\t\tthis._collectionLoaded = [];\r\n\t\t\tthis._collectionInstances = [];\r\n\t\t\tthis._collectionPending = [];\r\n\t\t\tthis._resourcesLoaded = [];\r\n\r\n\t\t\tthis._settings = {\r\n\t\t\t\t...{\r\n\t\t\t\t\tsrcAttr: 'data-src',\r\n\t\t\t\t\tsrcsetAttr: 'data-srcset',\r\n\t\t\t\t\tplaythrough: false,\r\n\t\t\t\t\tvisible: false,\r\n\t\t\t\t\tbackgrounds: false\r\n\t\t\t\t},\r\n\t\t\t\t...options\r\n\t\t\t};\r\n\r\n\t\t\tif (\r\n\t\t\t\t!stringStartsWith(this._settings.srcAttr, 'data-') ||\r\n\t\t\t\t!stringStartsWith(this._settings.srcsetAttr, 'data-')\r\n\t\t\t) {\r\n\t\t\t\tthrow new Error(\r\n\t\t\t\t\t'Wrong arguments format: srcAttr and srcsetAttr parameters must be dataset values.'\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tthis.srcAttr = hyphensToCamelCase(this._settings.srcAttr.replace('data-', ''));\r\n\t\t\tthis.srcsetAttr = hyphensToCamelCase(this._settings.srcsetAttr.replace('data-', ''));\r\n\r\n\t\t\tthis.percentage = 0;\r\n\r\n\t\t\tthis._done = () => {};\r\n\t\t\tthis._progress = () => {};\r\n\t\t\tthis._success = () => {};\r\n\t\t\tthis._error = () => {};\r\n\t\t\tthis._loop = this.load;\r\n\r\n\t\t\tthis._abort = false;\r\n\t\t\tthis._loaded = 0;\r\n\t\t\tthis._complete = false;\r\n\t\t\tthis._busy = false;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t *\r\n\t\t * @param {HTMLElement} [element=document.body]\r\n\t\t * @param {Object} [options={ srcAttr: 'src', srcsetAttr: 'srcset', backgrounds: false }]\r\n\t\t */\r\n\t\tstatic findResources(element, options) {\r\n\t\t\tlet settings = {\r\n\t\t\t\tsrcAttr: 'src',\r\n\t\t\t\tsrcsetAttr: 'srcset',\r\n\t\t\t\tbackgrounds: false\r\n\t\t\t};\r\n\r\n\t\t\tif (typeof element === 'object' && undefined === options) {\r\n\t\t\t\tfor (let key in settings) {\r\n\t\t\t\t\tif (key in element) {\r\n\t\t\t\t\t\toptions = element;\r\n\t\t\t\t\t\telement = undefined;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (undefined === element || element === document) {\r\n\t\t\t\telement = document.body;\r\n\t\t\t}\r\n\r\n\t\t\tif (!isHTMLElement(element)) {\r\n\t\t\t\tthrow new Error('TypeError: ' + element + ' is not of type HTMLElement.');\r\n\t\t\t}\r\n\r\n\t\t\tlet collectedResources = [];\r\n\r\n\t\t\tsettings = {\r\n\t\t\t\t...settings,\r\n\t\t\t\t...options\r\n\t\t\t};\r\n\r\n\t\t\tconst targets = 'img, video, audio';\r\n\t\t\tconst targetsExtended = targets + ', picture, source';\r\n\t\t\tconst targetsFilter = '[' + settings.srcAttr + '], [' + settings.srcsetAttr + ']';\r\n\r\n\t\t\tlet targetsTags = nodelistToArray(element.querySelectorAll(targets));\r\n\r\n\t\t\tif (element.matches(targetsExtended)) {\r\n\t\t\t\ttargetsTags.push(element);\r\n\t\t\t}\r\n\r\n\t\t\ttargetsTags = targetsTags.filter(target => {\r\n\t\t\t\tlet children = nodelistToArray(target.children);\r\n\t\t\t\tchildren = children.filter(x => x.matches(targetsExtended));\r\n\t\t\t\tchildren = children.filter(x => x.matches(targetsFilter));\r\n\t\t\t\treturn target.matches(targetsFilter) || children.length;\r\n\t\t\t});\r\n\t\t\ttargetsTags.forEach(target => {\r\n\t\t\t\tlet targetSource = target;\r\n\r\n\t\t\t\tif (!targetSource.matches(targetsFilter)) {\r\n\t\t\t\t\ttargetSource = targetSource.querySelectorAll(targetsFilter);\r\n\t\t\t\t\ttargetSource = [...targetSource][0];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcollectedResources.push({\r\n\t\t\t\t\telement: target,\r\n\t\t\t\t\tresource:\r\n\t\t\t\t\t\ttargetSource.getAttribute(settings.srcAttr) ||\r\n\t\t\t\t\t\ttargetSource.getAttribute(settings.srcsetAttr)\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\tif (true === settings.backgrounds) {\r\n\t\t\t\tlet targetsBg = nodelistToArray(element.querySelectorAll('*'));\r\n\t\t\t\ttargetsBg.push(element);\r\n\t\t\t\ttargetsBg = targetsBg.filter(target => !target.matches(targetsExtended));\r\n\t\t\t\ttargetsBg = targetsBg.filter(target => getComputedStyle(target).backgroundImage !== 'none');\r\n\t\t\t\ttargetsBg.forEach(target => {\r\n\t\t\t\t\tconst url = getComputedStyle(target).backgroundImage.match(/\\((.*?)\\)/);\r\n\r\n\t\t\t\t\tif (null !== url && url.length >= 2) {\r\n\t\t\t\t\t\tcollectedResources.push({\r\n\t\t\t\t\t\t\telement: target,\r\n\t\t\t\t\t\t\tresource: url[1].replace(/('|\")/g, '')\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\treturn collectedResources;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @param {(Array.<String>|HTMLElement)} collection\r\n\t\t */\r\n\t\tset collection(collection) {\r\n\t\t\tlet collectedResources = collection;\r\n\r\n\t\t\ttry {\r\n\t\t\t\tcollectedResources = Loader.findResources(collection, this._settings);\r\n\t\t\t} catch (err) {}\r\n\r\n\t\t\tcollectedResources.forEach(item => {\r\n\t\t\t\tlet element = {\r\n\t\t\t\t\tresource: '',\r\n\t\t\t\t\telement: null,\r\n\t\t\t\t\tid: generateInstanceID()\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (typeof item === 'string') {\r\n\t\t\t\t\telement.resource = item;\r\n\t\t\t\t} else if (typeof item === 'object' && 'resource' in item) {\r\n\t\t\t\t\telement = { ...element, ...item };\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._collection.push(element);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @returns {Array} collection\r\n\t\t */\r\n\t\tget collection() {\r\n\t\t\treturn this._collection;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @returns {undefined}\r\n\t\t */\r\n\t\tload() {\r\n\t\t\tif (!this._collection.length) {\r\n\t\t\t\tthis._done.call(this, this._resourcesLoaded);\r\n\t\t\t}\r\n\r\n\t\t\t// resets pending elements (sequential opt helper array) every time we loop\r\n\t\t\tthis._collectionPending = [];\r\n\r\n\t\t\tconst sequentialMode = true === this._settings.sequential;\r\n\r\n\t\t\tfor (let i = 0; i < this._collection.length; i++) {\r\n\t\t\t\tif (this._abort) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet thisLoadId = this._collection[i].id;\r\n\t\t\t\tlet thisLoadIndex = arrayFindIndex(this._collectionInstances, x => x.id === thisLoadId);\r\n\t\t\t\tlet thisLoadInstance = new SingleLoader(this._settings);\r\n\r\n\t\t\t\tif (thisLoadIndex === -1) {\r\n\t\t\t\t\tthis._collectionInstances.push({\r\n\t\t\t\t\t\tid: thisLoadId,\r\n\t\t\t\t\t\tinstance: thisLoadInstance\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthisLoadIndex = arrayFindIndex(this._collectionInstances, x => x.id === thisLoadId);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._collectionInstances[thisLoadIndex].instance = thisLoadInstance;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthisLoadInstance.resource = this._collection[i];\r\n\r\n\t\t\t\tthisLoadInstance.done((element, status, resource, id) => {\r\n\t\t\t\t\tif (this._complete || this._abort) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst aProgress = !isInArray(id, this._collectionLoaded);\r\n\r\n\t\t\t\t\tif (aProgress) {\r\n\t\t\t\t\t\tthis._collectionLoaded.push(id);\r\n\t\t\t\t\t\tthis._busy = false;\r\n\r\n\t\t\t\t\t\tthis._loaded++;\r\n\t\t\t\t\t\tthis.percentage = this._loaded / this._collection.length * 100;\r\n\t\t\t\t\t\tthis.percentage = parseFloat(this.percentage.toFixed(4));\r\n\r\n\t\t\t\t\t\tconst thisResource = {\r\n\t\t\t\t\t\t\tresource: resource,\r\n\t\t\t\t\t\t\tstatus: status,\r\n\t\t\t\t\t\t\telement: element\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._resourcesLoaded.push(thisResource);\r\n\t\t\t\t\t\tthis._progress.call(this, thisResource);\r\n\t\t\t\t\t\tthis[status !== 'error' ? '_success' : '_error'].call(this, thisResource);\r\n\t\t\t\t\t\t// TODO: dispatch event on element maybe?\r\n\t\t\t\t\t\t// element.dispatchEvent(new CustomEvent(pluginPrefix + capitalize(status) + '.' + pluginPrefix));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this._loaded === this._collection.length) {\r\n\t\t\t\t\t\tthis._done.call(this, this._resourcesLoaded);\r\n\r\n\t\t\t\t\t\tthis._complete = true;\r\n\t\t\t\t\t} else if (aProgress && sequentialMode && this._collectionPending.length) {\r\n\t\t\t\t\t\tthis._collectionPending = this._collectionPending.filter(x => x.id !== id);\r\n\r\n\t\t\t\t\t\tif (this._collectionPending.length) {\r\n\t\t\t\t\t\t\tthis._busy = this._collectionPending[0].instance.load();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (!sequentialMode || (sequentialMode && !this._busy)) {\r\n\t\t\t\t\tthis._busy = thisLoadInstance.load();\r\n\t\t\t\t} else if (\r\n\t\t\t\t\tsequentialMode &&\r\n\t\t\t\t\tthis._busy &&\r\n\t\t\t\t\t(!this._settings.visible ||\r\n\t\t\t\t\t\t!thisLoadInstance._exists ||\r\n\t\t\t\t\t\t(this._settings.visible &&\r\n\t\t\t\t\t\t\tthisLoadInstance._exists &&\r\n\t\t\t\t\t\t\tisVisible(thisLoadInstance._originalElement)))\r\n\t\t\t\t) {\r\n\t\t\t\t\tthis._collectionPending.push({\r\n\t\t\t\t\t\tid: thisLoadId,\r\n\t\t\t\t\t\tinstance: thisLoadInstance\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @param {Function} callback\r\n\t\t * @returns {undefined}\r\n\t\t */\r\n\t\tdone(callback) {\r\n\t\t\tif (typeof callback !== 'function') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis._done = function(resources) {\r\n\t\t\t\tcallback.call(this, resources);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @param {Function} callback\r\n\t\t * @returns {undefined}\r\n\t\t */\r\n\t\tprogress(callback) {\r\n\t\t\tif (typeof callback !== 'function') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis._progress = function(resource) {\r\n\t\t\t\tcallback.call(this, resource);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @param {Function} callback\r\n\t\t * @returns {undefined}\r\n\t\t */\r\n\t\tsuccess(callback) {\r\n\t\t\tif (typeof callback !== 'function') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis._success = function(resource) {\r\n\t\t\t\tcallback.call(this, resource);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @param {Function} callback\r\n\t\t * @returns {undefined}\r\n\t\t */\r\n\t\terror(callback) {\r\n\t\t\tif (typeof callback !== 'function') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis._error = function(resource) {\r\n\t\t\t\tcallback.call(this, resource);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @returns {undefined}\r\n\t\t */\r\n\t\tabort() {\r\n\t\t\tthis._collectionInstances.forEach(thisInstance => {\r\n\t\t\t\tthisInstance.instance.abort();\r\n\t\t\t});\r\n\r\n\t\t\tthis._abort = true;\r\n\t\t}\r\n\t}\r\n\r\n\t// public interface\r\n\t// - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n\t// requirejs\r\n\tif (typeof define === 'function' && define.amd) {\r\n\t\tdefine(capitalize(pluginName), Loader);\r\n\t\t// nodejs\r\n\t} else if ('object' === typeof exports) {\r\n\t\tmodule.exports[capitalize(pluginName)] = Loader;\r\n\t\t// vanilla\r\n\t} else {\r\n\t\twindow[capitalize(pluginName)] = Loader;\r\n\t}\r\n\t// - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n\r\n\t// jQuery interface\r\n\t// - - - - - - - - - - - - - - - - - - - -\r\n\tif (!('jQuery' in window)) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst $ = jQuery;\r\n\r\n\t$[capitalize(pluginName)] = Loader;\r\n\r\n\tconst $document = $(document);\r\n\tconst $window = $(window);\r\n\t// thanks https://gist.github.com/beaucharman/e46b8e4d03ef30480d7f4db5a78498ca\r\n\tconst throttle = (callback, wait, context = this) => {\r\n\t\tlet timeout = null;\r\n\t\tlet callbackArgs = null;\r\n\t\tconst later = () => {\r\n\t\t\tcallback.apply(context, callbackArgs);\r\n\t\t\ttimeout = null;\r\n\t\t};\r\n\t\treturn function() {\r\n\t\t\tif (!timeout) {\r\n\t\t\t\tcallbackArgs = arguments;\r\n\t\t\t\ttimeout = setTimeout(later, wait);\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\r\n\tlet methodCollection = [];\r\n\r\n\t$.fn[pluginMethod] = function(options) {\r\n\t\tlet originalUserOptions = options;\r\n\r\n\t\tif (typeof options !== 'object') {\r\n\t\t\toptions = {};\r\n\t\t}\r\n\r\n\t\tlet settings = {\r\n\t\t\t...{\r\n\t\t\t\tsrcAttr: 'data-src',\r\n\t\t\t\tsrcsetAttr: 'data-srcset',\r\n\r\n\t\t\t\tvisible: false,\r\n\t\t\t\tsequential: false,\r\n\r\n\t\t\t\tbackgrounds: false,\r\n\t\t\t\tplaythrough: false,\r\n\r\n\t\t\t\tearly: false,\r\n\t\t\t\tearlyTimeout: 0,\r\n\r\n\t\t\t\tonProgress: () => {},\r\n\t\t\t\tonLoad: () => {},\r\n\t\t\t\tonError: () => {},\r\n\r\n\t\t\t\tonComplete: () => {}\r\n\t\t\t},\r\n\t\t\t...options\r\n\t\t};\r\n\r\n\t\tlet callback = settings.onComplete;\r\n\t\tif ($.isFunction(originalUserOptions)) {\r\n\t\t\tcallback = originalUserOptions;\r\n\t\t}\r\n\r\n\t\treturn this.each(function(i) {\r\n\t\t\t// TODO: mutation observer when new children are appended\r\n\r\n\t\t\tconst $element = $(this);\r\n\t\t\tconst uniqueMethodPluginName = generateInstanceID() + i;\r\n\t\t\tconst thisLoadInstance = new Loader(settings);\r\n\r\n\t\t\tthisLoadInstance.collection = this;\r\n\r\n\t\t\tmethodCollection.push({\r\n\t\t\t\tid: uniqueMethodPluginName,\r\n\t\t\t\tinstance: thisLoadInstance,\r\n\t\t\t\telement: this,\r\n\t\t\t\ttimeout: null\r\n\t\t\t});\r\n\r\n\t\t\tthisLoadInstance.progress(resource => {\r\n\t\t\t\t$(resource.element).trigger(pluginPrefix + capitalize(resource.status) + '.' + pluginPrefix, [\r\n\t\t\t\t\tresource.element,\r\n\t\t\t\t\tresource.resource\r\n\t\t\t\t]);\r\n\t\t\t\t$element.trigger(pluginPrefix + 'Progress.' + pluginPrefix, [this, resource]);\r\n\r\n\t\t\t\tconst thisArguments = [thisLoadInstance, resource];\r\n\r\n\t\t\t\tif (typeof settings.onProgress === 'function') {\r\n\t\t\t\t\tsettings.onProgress.apply(this, thisArguments);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet eventName = capitalize(resource.status);\r\n\t\t\t\tif (typeof settings['on' + eventName] === 'function') {\r\n\t\t\t\t\tsettings['on' + eventName].apply(this, thisArguments);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tthisLoadInstance.done(resources => {\r\n\t\t\t\t$element.trigger(pluginPrefix + 'Complete.' + pluginPrefix, [this, resources]);\r\n\t\t\t\tcallback.apply(this, [thisLoadInstance, resources]);\r\n\r\n\t\t\t\tif (settings.visible) {\r\n\t\t\t\t\t/*if (IntersectionObserverSupported) {\r\n                        thisLoadInstance.collection.forEach(item => item.element.intersectionObserver.unobserve(item.element));\r\n\r\n                    } else {*/\r\n\t\t\t\t\t$window.off('scroll.' + uniqueMethodPluginName);\r\n\r\n\t\t\t\t\t//}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// refresh other method calls for same el (omitting this one)\r\n\t\t\t\tmethodCollection = methodCollection.filter(x => x.id !== uniqueMethodPluginName);\r\n\t\t\t\tmethodCollection.forEach(thisMethodCollection => {\r\n\t\t\t\t\tif ($element.is(thisMethodCollection.element)) {\r\n\t\t\t\t\t\tthisMethodCollection.instance.load();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\tthisLoadInstance.load();\r\n\r\n\t\t\tif (settings.visible) {\r\n\t\t\t\t/* if (IntersectionObserverSupported) {\r\n\r\n                    thisLoadInstance.collection.forEach(item => {\r\n\r\n                        item.element.intersectionObserver = new IntersectionObserver((entries, observer) => {\r\n                            entries.forEach(entry => {\r\n                                if( entry.intersectionRatio > 0 ){\r\n                                    thisLoadInstance.load();\r\n                                }\r\n                            });\r\n                        }, {\r\n                            root: null,\r\n                            rootMargin: '0px',\r\n                            threshold: 0.0\r\n                        });\r\n\r\n                        item.element.intersectionObserver.observe(item.element);\r\n\r\n                    });\r\n\r\n                } else {*/\r\n\r\n\t\t\t\t$window.on('scroll.' + uniqueMethodPluginName, throttle(() => thisLoadInstance.load(), 250));\r\n\r\n\t\t\t\t//}\r\n\t\t\t}\r\n\r\n\t\t\tif (true === settings.early) {\r\n\t\t\t\tlet breakLoop = false;\r\n\r\n\t\t\t\tmethodCollection.forEach(thisMethodCollection => {\r\n\t\t\t\t\tif (breakLoop) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (methodCollection[key].id === uniqueMethodPluginName) {\r\n\t\t\t\t\t\tclearTimeout(thisMethodCollection.timeout);\r\n\r\n\t\t\t\t\t\tlet timeout = parseInt(settings.earlyTimeout);\r\n\r\n\t\t\t\t\t\tthisMethodCollection.timeout = setTimeout(() => {\r\n\t\t\t\t\t\t\t// TODO: appropriate method to set/update settings?\r\n\t\t\t\t\t\t\tthisMethodCollection.instance._settings.visible = false;\r\n\t\t\t\t\t\t\tthisMethodCollection.instance._settings.sequential = true;\r\n\r\n\t\t\t\t\t\t\tthisMethodCollection.instance.load();\r\n\t\t\t\t\t\t}, !isNaN(timeout) && isFinite(timeout) ? timeout : 0);\r\n\r\n\t\t\t\t\t\tbreakLoop = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n})();\r\n"]}