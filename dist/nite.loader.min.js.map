{"version":3,"sources":["nite.loader.js"],"names":["window","document","$","undefined","generateInstanceID","Math","floor","random","pluginName","pluginMethod","pluginInstance","CustomEvent","_polyfill","event","params","bubbles","cancelable","detail","evt","createEvent","initCustomEvent","prototype","Event","supportedExtensions","image","audio","video","supportedTags","IntersectionObserverSupported","pictureElementSupported","stringContains","heystack","needle","String","includes","indexOf","stringStartsWith","startsWith","substr","length","arrayFindIndex","filter","Array","findIndex","index","detachEventListener","element","events","Object","keys","privateEventsStorage","forEach","key","eventNameWithNamespace","replace","type","split","join","removeEventListener","handler","attachEventListener","once","count","_handler","call","this","addEventListener","hyphensToCamelCase","string","g","toUpperCase","capitalize","charAt","slice","nodelistToArray","nodelist","isInArray","isVisible","intersectionRatio","getComputedStyle","bodyEl","getElementsByTagName","winWidth","innerWidth","documnt","documentElement","clientWidth","winHeight","innerHeight","clientHeight","rect","getBoundingClientRect","right","bottom","left","top","isHTMLElement","HTMLElement","e","nodeType","style","ownerDocument","isLoaded","source","privateCache","currentSrc","complete","readyState","isBroken","naturalWidth","videoWidth","decodeResource","resource","output","format","extension","tag","consistent","breakLoop","formatCandidate","RegExp","test","matches64","match","matches","tagName","toLowerCase","allTags","values","tags","SingleLoader","[object Object]","options","_settings","srcAttr","srcsetAttr","playthrough","visible","_id","_idEvent","_busy","_element","_resource","_format","_observer","_done","_success","_error","_callback","unobserve","src","push","thisArguments","apply","data","id","info","_tag","_consistent","_exists","_originalElement","createElement","dataset","IntersectionObserver","entries","observer","entry","target","root","rootMargin","threshold","observe","picture","closest","querySelectorAll","el","setAttribute","isPlaythroughModeNormal","isPlaythroughModeFull","sources","isFullyBuffered","media","buffered","round","end","seekable","callMediaLoad","sourcesErrorId","thisSource","load","onProgressReplacementInterval","setInterval","isError","duration","currentTime","paused","play","clearInterval","pause","callback","status","getAttribute","srcset","removeAttribute","Loader","_collection","_collectionLoaded","_collectionInstances","_collectionPending","_resourcesLoaded","backgrounds","extraAttrs","contains","isArray","percentage","_progress","_loop","_abort","_loaded","_complete","settings","body","Error","collectedResources","targetsExtended","targets","targetsFilter","ettings","targetsTags","children","x","targetSource","targetsBg","backgroundImage","url","attr","collection","findResources","err","item","sequentialMode","sequential","i","thisLoadId","thisLoadIndex","thisLoadInstance","instance","done","aProgress","parseFloat","toFixed","thisResource","resources","thisInstance","abort","define","amd","exports","module","$window","throttle","wait","context","timeout","callbackArgs","later","arguments","setTimeout","methodCollection","fn","originalUserOptions","early","earlyTimeout","onProgress","onLoad","onError","onComplete","isFunction","each","$element","uniqueMethodPluginName","progress","trigger","pluginPrefix","eventName","off","thisMethodCollection","is","on","clearTimeout","parseInt","isNaN","isFinite","jQuery"],"mappings":"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","sourcesContent":["/*! Nite Loader | Daniele Fioroni | dfioroni91@gmail.com */\n(function(window, document, $, undefined) {\n\t'use strict';\n\n\tconst /**\n\t\t * @returns {string}\n\t\t */\n\t\tgenerateInstanceID = () => {\n\t\t\treturn Math.floor(Math.random() * (9999 - 1000)) + 1000;\n\t\t},\n\t\tpluginPrefix = 'nite',\n\t\tpluginMethod = pluginPrefix + 'Load',\n\t\tpluginName = pluginMethod + 'er',\n\t\tpluginInstance = generateInstanceID(),\n\t\teventNamespaceParserSeparator = '__namespace__',\n\t\tCustomEvent =\n\t\t\twindow.CustomEvent ||\n\t\t\t(() => {\n\t\t\t\tconst _polyfill = (event, params) => {\n\t\t\t\t\tparams = params || {\n\t\t\t\t\t\tbubbles: false,\n\t\t\t\t\t\tcancelable: false,\n\t\t\t\t\t\tdetail: undefined\n\t\t\t\t\t};\n\t\t\t\t\tconst evt = document.createEvent('CustomEvent');\n\t\t\t\t\tevt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n\t\t\t\t\treturn evt;\n\t\t\t\t};\n\t\t\t\t_polyfill.prototype = window.Event.prototype;\n\t\t\t\treturn _polyfill;\n\t\t\t})(),\n\t\tsupportedExtensions = {\n\t\t\timage: 'jp[e]?g|jpe|jif|jfif|jfi|gif|png|tif[f]?|bmp|dib|webp|ico|cur|svg',\n\t\t\taudio: 'mp3|ogg|oga|spx|ogg|wav',\n\t\t\tvideo: 'mp4|ogv|webm'\n\t\t},\n\t\tsupportedTags = {\n\t\t\timage: 'img|picture|source',\n\t\t\taudio: 'audio|source',\n\t\t\tvideo: 'video|source'\n\t\t},\n\t\tIntersectionObserverSupported = 'IntersectionObserver' in window,\n\t\tpictureElementSupported = 'HTMLPictureElement' in window,\n\t\t/**\n\t\t * @param {string} heystack\n\t\t * @param {string} needle\n\t\t * @returns {boolean}\n\t\t */\n\t\tstringContains = (heystack, needle) => {\n\t\t\treturn String.prototype.includes ? heystack.includes(needle) : heystack.indexOf(needle, 0) !== -1;\n\t\t},\n\t\t/**\n\t\t * @param {string} heystack\n\t\t * @param {string} needle\n\t\t * @returns {boolean}\n\t\t */\n\t\tstringStartsWith = (heystack, needle) => {\n\t\t\treturn String.prototype.startsWith\n\t\t\t\t? heystack.startsWith(needle)\n\t\t\t\t: heystack.substr(0, needle.length) === needle;\n\t\t},\n\t\t/**\n\t\t * @param {Array} heystack\n\t\t * @param {Function} filter\n\t\t * @returns {number}\n\t\t */\n\t\tarrayFindIndex = (heystack, filter) => {\n\t\t\treturn Array.prototype.findIndex\n\t\t\t\t? heystack.findIndex(filter)\n\t\t\t\t: (() => {\n\t\t\t\t\t\tlet length = heystack.length,\n\t\t\t\t\t\t\tindex = -1;\n\t\t\t\t\t\twhile (++index < length) {\n\t\t\t\t\t\t\tif (filter(heystack[index], index, heystack)) {\n\t\t\t\t\t\t\t\treturn index;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn -1;\n\t\t\t\t  })();\n\t\t},\n\t\t/**\n\t\t * @param {HTMLElement} element\n\t\t * @param {string} events\n\t\t * @returns {undefined}\n\t\t */\n\t\tdetachEventListener = (element, events) => {\n\t\t\tif (!element || typeof events !== 'string') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (stringStartsWith(events, '.')) {\n\t\t\t\tObject.keys(privateEventsStorage).forEach(key => {\n\t\t\t\t\tconst eventNameWithNamespace = key.replace(eventNamespaceParserSeparator, '.');\n\t\t\t\t\tif (\n\t\t\t\t\t\tstringContains(eventNameWithNamespace, events) &&\n\t\t\t\t\t\tprivateEventsStorage[key].element === element\n\t\t\t\t\t) {\n\t\t\t\t\t\tdetachEventListener(element, eventNameWithNamespace);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tevents = events.split('.');\n\n\t\t\t\tconst type = events[0],\n\t\t\t\t\tnamespace = events[1];\n\n\t\t\t\tif (namespace) {\n\t\t\t\t\tevents = events.join(eventNamespaceParserSeparator);\n\t\t\t\t}\n\n\t\t\t\tif (events in privateEventsStorage) {\n\t\t\t\t\telement.removeEventListener(type, privateEventsStorage[events].handler);\n\t\t\t\t\tdelete privateEventsStorage[events];\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @param {HTMLElement} element\n\t\t * @param {string} events\n\t\t * @param {Function} handler\n\t\t * @param {boolean} once\n\t\t * @returns {undefined}\n\t\t */\n\t\tattachEventListener = (element, events, handler, once) => {\n\t\t\tif (!element || typeof events !== 'string' || typeof handler !== 'function') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tevents = events.split('.');\n\n\t\t\tconst type = events[0],\n\t\t\t\tnamespace = events[1];\n\n\t\t\tif (namespace) {\n\t\t\t\tevents = events.join(eventNamespaceParserSeparator);\n\t\t\t}\n\n\t\t\tprivateEventsStorage[events] = {\n\t\t\t\telement: element,\n\t\t\t\tcount: 0,\n\t\t\t\tonce: false\n\t\t\t};\n\n\t\t\tif (true === once) {\n\t\t\t\tlet _handler = handler;\n\t\t\t\thandler = function(event) {\n\t\t\t\t\tif (events in privateEventsStorage) {\n\t\t\t\t\t\tprivateEventsStorage[events].count++;\n\t\t\t\t\t\tif (privateEventsStorage[events].once && privateEventsStorage[events].count > 1) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t_handler.call(this, event);\n\t\t\t\t\t}\n\t\t\t\t\tdetachEventListener(element, events);\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tonce = false;\n\t\t\t}\n\n\t\t\tprivateEventsStorage[events] = {\n\t\t\t\t...privateEventsStorage[events],\n\t\t\t\t...{\n\t\t\t\t\thandler: handler,\n\t\t\t\t\tonce: once\n\t\t\t\t}\n\t\t\t};\n\n\t\t\telement.addEventListener(type, privateEventsStorage[events].handler, {\n\t\t\t\tonce: once\n\t\t\t});\n\t\t},\n\t\t/**\n\t\t * @param {string} string\n\t\t * @returns {string}\n\t\t */\n\t\thyphensToCamelCase = string => {\n\t\t\treturn string.replace(/-([a-z])/g, g => g[1].toUpperCase());\n\t\t},\n\t\t/**\n\t\t * @param {string} string\n\t\t * @returns {string}\n\t\t */\n\t\tcapitalize = string => {\n\t\t\treturn string.charAt(0).toUpperCase() + string.slice(1);\n\t\t},\n\t\t/**\n\t\t * @param {NodeList} nodelist\n\t\t * @returns {Array}\n\t\t */\n\t\tnodelistToArray = nodelist => {\n\t\t\treturn [...nodelist];\n\t\t},\n\t\t/**\n\t\t * @param {*} needle\n\t\t * @param {Array} heystack\n\t\t * @returns {boolean}\n\t\t */\n\t\tisInArray = (needle, heystack) => {\n\t\t\treturn heystack.indexOf(needle) > -1;\n\t\t},\n\t\t/**\n\t\t * @param {HTMLElement} element\n\t\t * @returns {boolean}\n\t\t */\n\t\tisVisible = element => {\n\t\t\tif (IntersectionObserverSupported && 'intersectionRatio' in element) {\n\t\t\t\treturn element.intersectionRatio > 0;\n\t\t\t}\n\n\t\t\tif (window.getComputedStyle(element, 'display') === 'none') {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\tconst bodyEl = document.getElementsByTagName('body')[0],\n\t\t\t\twinWidth = window.innerWidth || documnt.documentElement.clientWidth || bodyEl.clientWidth,\n\t\t\t\twinHeight = window.innerHeight || documnt.documentElement.clientHeight || bodyEl.clientHeight,\n\t\t\t\trect = element.getBoundingClientRect();\n\n\t\t\treturn !(rect.right < 0 || rect.bottom < 0 || rect.left > winWidth || rect.top > winHeight);\n\t\t},\n\t\t/**\n\t\t * @param {HTMLElement} element\n\t\t * @returns {boolean}\n\t\t */\n\t\tisHTMLElement = element => {\n\t\t\tif (typeof element !== 'object') {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\ttry {\n\t\t\t\treturn element instanceof HTMLElement;\n\t\t\t} catch (e) {\n\t\t\t\treturn (\n\t\t\t\t\telement.nodeType === 1 &&\n\t\t\t\t\ttypeof element.style === 'object' &&\n\t\t\t\t\ttypeof element.ownerDocument === 'object'\n\t\t\t\t);\n\t\t\t}\n\t\t},\n\t\t/**\n\t\t * @param {(string|HTMLElement)} source\n\t\t * @returns {boolean}\n\t\t */\n\t\tisLoaded = source => {\n\t\t\treturn (\n\t\t\t\t(typeof source === 'string' && isInArray(source, privateCache)) ||\n\t\t\t\t(isHTMLElement(source) &&\n\t\t\t\t\t('currentSrc' in source && source.currentSrc.length > 0) &&\n\t\t\t\t\t(('complete' in source && source.complete) ||\n\t\t\t\t\t\t('readyState' in source && source.readyState >= 2)))\n\t\t\t);\n\t\t},\n\t\t/**\n\t\t * @param {(string|HTMLElement)} source\n\t\t * @returns {boolean}\n\t\t */\n\t\tisBroken = source => {\n\t\t\treturn (\n\t\t\t\tisLoaded(source) &&\n\t\t\t\t((isHTMLElement(source) &&\n\t\t\t\t\t(('naturalWidth' in source && Math.floor(source.naturalWidth) === 0) ||\n\t\t\t\t\t\t('videoWidth' in source && source.videoWidth === 0))) ||\n\t\t\t\t\ttypeof source === 'string')\n\t\t\t);\n\t\t},\n\t\t/**\n\t\t * @param {Object} resource\n\t\t * @returns {Object}\n\t\t */\n\t\tdecodeResource = resource => {\n\t\t\tlet output = {\n\t\t\t\t\tformat: null,\n\t\t\t\t\textension: null,\n\t\t\t\t\ttag: null,\n\t\t\t\t\tconsistent: false // true if tag match the resource type\n\t\t\t\t},\n\t\t\t\tbreakLoop = false;\n\n\t\t\tresource.resource = resource.resource.split('?')[0];\n\t\t\tresource.resource = resource.resource.split('#')[0];\n\t\t\tObject.keys(supportedExtensions).forEach(formatCandidate => {\n\t\t\t\tif (breakLoop) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tconst base64Heading = ';base64,';\n\n\t\t\t\tif (\n\t\t\t\t\tnew RegExp(\n\t\t\t\t\t\t'(.(' + supportedExtensions[formatCandidate] + ')$)|' + base64Heading,\n\t\t\t\t\t\t'g'\n\t\t\t\t\t).test(resource.resource)\n\t\t\t\t) {\n\t\t\t\t\tif (new RegExp(base64Heading, 'g').test(resource.resource)) {\n\t\t\t\t\t\tlet matches64 = resource.resource.match(\n\t\t\t\t\t\t\tnew RegExp(\n\t\t\t\t\t\t\t\t'^data:' +\n\t\t\t\t\t\t\t\t\tformatCandidate +\n\t\t\t\t\t\t\t\t\t'/(' +\n\t\t\t\t\t\t\t\t\tsupportedExtensions[formatCandidate] +\n\t\t\t\t\t\t\t\t\t')',\n\t\t\t\t\t\t\t\t'g'\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tif (null === matches64) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tmatches64 = matches64[0];\n\n\t\t\t\t\t\toutput.format = formatCandidate;\n\t\t\t\t\t\toutput.extension = matches64.replace('data:' + formatCandidate + '/', '');\n\t\t\t\t\t\toutput.tag = supportedTags[formatCandidate];\n\n\t\t\t\t\t\tbreakLoop = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tlet matches = resource.resource.match(\n\t\t\t\t\t\t\tnew RegExp(supportedExtensions[formatCandidate], 'g')\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tif (matches) {\n\t\t\t\t\t\t\toutput.format = formatCandidate;\n\t\t\t\t\t\t\toutput.extension = matches[0];\n\t\t\t\t\t\t\toutput.tag = supportedTags[formatCandidate];\n\n\t\t\t\t\t\t\tbreakLoop = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (isHTMLElement(resource.element)) {\n\t\t\t\tlet tagName = resource.element.tagName.toLowerCase(),\n\t\t\t\t\tallTags = '';\n\n\t\t\t\tObject.values(supportedTags).forEach(tags => {\n\t\t\t\t\tallTags += '|' + tags;\n\t\t\t\t});\n\n\t\t\t\tallTags = allTags.split('|');\n\n\t\t\t\tif (isInArray(tagName, allTags)) {\n\t\t\t\t\toutput.tag = tagName;\n\t\t\t\t\toutput.consistent = true;\n\t\t\t\t\tif (output.format === null) {\n\t\t\t\t\t\tObject.keys(supportedTags).forEach(format => {\n\t\t\t\t\t\t\tif (stringContains(supportedTags[format], output.tag)) {\n\t\t\t\t\t\t\t\toutput.format = format;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (stringContains(output.tag, '|')) {\n\t\t\t\toutput.tag = output.tag.split('|')[0];\n\t\t\t}\n\n\t\t\treturn output;\n\t\t};\n\n\tlet privateEventsStorage = {},\n\t\tprivateCache = [];\n\n\t// TODO: Promise support\n\t// TODO: think about useful vars in callback args (this class is not public but its vars are returned in .progress() callback)\n\t/** TODO: description of the MyClass constructor function.\n\t * @class\n\t * @classdesc TODO: description of the SingleLoader class.\n\t */\n\tclass SingleLoader {\n\t\t/**\n\t\t * @param {Object} [options={ srcAttr: 'data-src', srcsetAttr: 'data-srcset', playthrough: false, visible: false }]\n\t\t */\n\t\tconstructor(options) {\n\t\t\tthis._settings = {\n\t\t\t\t...{\n\t\t\t\t\tsrcAttr: 'data-src',\n\t\t\t\t\tsrcsetAttr: 'data-srcset',\n\t\t\t\t\tplaythrough: false,\n\t\t\t\t\tvisible: false\n\t\t\t\t},\n\t\t\t\t...options\n\t\t\t};\n\n\t\t\tthis.srcAttr = '';\n\t\t\tthis.srcsetAttr = '';\n\n\t\t\tif (!stringStartsWith(this._settings.srcAttr, 'data-')) {\n\t\t\t\tthis.srcAttr = this._settings.srcAttr;\n\t\t\t\tthis._settings.srcAttr = 'data-' + this._settings.srcAttr;\n\t\t\t} else {\n\t\t\t\tthis.srcAttr = this._settings.srcAttr.replace('data-', '');\n\t\t\t}\n\n\t\t\tif (!stringStartsWith(this._settings.srcsetAttr, 'data-')) {\n\t\t\t\tthis.srcsetAttr = this._settings.srcsetAttr;\n\t\t\t\tthis._settings.srcsetAttr = 'data-' + this._settings.srcsetAttr;\n\t\t\t} else {\n\t\t\t\tthis.srcsetAttr = this._settings.srcsetAttr.replace('data-', '');\n\t\t\t}\n\n\t\t\tthis.srcAttr = hyphensToCamelCase(this.srcAttr);\n\t\t\tthis.srcsetAttr = hyphensToCamelCase(this.srcsetAttr);\n\n\t\t\tthis._id = null;\n\t\t\tthis._idEvent = null;\n\t\t\tthis._busy = false;\n\n\t\t\tthis._element = null;\n\t\t\tthis._resource = null;\n\t\t\tthis._format = null;\n\t\t\tthis._observer = null;\n\n\t\t\tthis._done = () => {};\n\t\t\tthis._success = () => {};\n\t\t\tthis._error = () => {};\n\n\t\t\tthis._callback = e => {\n\t\t\t\tthis._busy = false;\n\t\t\t\tif (null !== this._observer) {\n\t\t\t\t\tthis._observer.unobserve(this._element);\n\t\t\t\t}\n\n\t\t\t\tconst src = this._element.currentSrc || this._element.src;\n\n\t\t\t\tif (!isInArray(src, privateCache)) {\n\t\t\t\t\tprivateCache.push(src);\n\t\t\t\t}\n\n\t\t\t\tlet thisArguments = [this._element, e.type, src, this._id];\n\n\t\t\t\tthis[e.type !== 'error' ? '_success' : '_error'].apply(this, thisArguments);\n\t\t\t\tthis._done.apply(this, thisArguments);\n\t\t\t};\n\t\t}\n\n\t\t/**\n\t\t * @param {Object} data\n\t\t */\n\t\tset resource(data) {\n\t\t\tif (typeof data === 'object' && 'id' in data && 'element' in data && 'resource' in data) {\n\t\t\t\tthis._id = data.id;\n\t\t\t\tthis._element = data.element;\n\t\t\t\tthis._resource = data.resource;\n\n\t\t\t\tlet info = decodeResource({\n\t\t\t\t\tresource: this._resource,\n\t\t\t\t\telement: this._element\n\t\t\t\t});\n\t\t\t\tthis._tag = info.tag;\n\t\t\t\tthis._consistent = info.consistent;\n\t\t\t\tthis._format = info.format;\n\t\t\t\tthis._exists = this._element !== null;\n\t\t\t\tthis._originalElement = this._element;\n\n\t\t\t\tif (!this._exists || !this._consistent) {\n\t\t\t\t\tthis._element = document.createElement(this._tag);\n\t\t\t\t\tthis._element.dataset[this.srcAttr] = this._resource;\n\t\t\t\t}\n\n\t\t\t\tif (this._exists && this._settings.visible && IntersectionObserverSupported) {\n\t\t\t\t\tthis._observer = new IntersectionObserver(\n\t\t\t\t\t\t(entries, observer) => {\n\t\t\t\t\t\t\tentries.forEach(\n\t\t\t\t\t\t\t\tentry => (entry.target.intersectionRatio = entry.intersectionRatio)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\troot: null,\n\t\t\t\t\t\t\trootMargin: '0px',\n\t\t\t\t\t\t\tthreshold: 0.1\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t\tthis._observer.observe(this._originalElement);\n\t\t\t\t}\n\n\t\t\t\tthis._idEvent = this._element[pluginInstance + '_IDEvent'];\n\t\t\t\tthis._busy = this._idEvent !== undefined;\n\t\t\t\tthis._idEvent = this._busy\n\t\t\t\t\t? this._idEvent\n\t\t\t\t\t: pluginName + '_unique_' + this._element.tagName + '_' + generateInstanceID();\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * @returns {string}\n\t\t */\n\t\tget resource() {\n\t\t\treturn this._resource;\n\t\t}\n\n\t\t/**\n\t\t * @returns {boolean} se ha preso in carico il caricamento oppure no per vari motivi (è già caricato, non è nella viewport etc)\n\t\t */\n\t\tload() {\n\t\t\tif (isLoaded(this._exists && this._consistent ? this._element : this._resource)) {\n\t\t\t\tif (!this._busy) {\n\t\t\t\t\t// TODO: mayabe this should be called in this._callback\n\t\t\t\t\tdetachEventListener(this._element, '.' + this._idEvent);\n\t\t\t\t}\n\n\t\t\t\tthis._callback(\n\t\t\t\t\tnew CustomEvent(\n\t\t\t\t\t\t!isBroken(this._exists && this._consistent ? this._element : this._resource)\n\t\t\t\t\t\t\t? 'load'\n\t\t\t\t\t\t\t: 'error'\n\t\t\t\t\t)\n\t\t\t\t);\n\n\t\t\t\treturn false;\n\t\t\t} else if (this._exists && this._settings.visible && !isVisible(this._originalElement)) {\n\t\t\t\treturn false;\n\t\t\t} else {\n\t\t\t\tif (this._format === 'image') {\n\t\t\t\t\tattachEventListener(this._element, 'load.' + this._idEvent, this._callback, !this._busy);\n\t\t\t\t\tattachEventListener(this._element, 'error.' + this._idEvent, this._callback, !this._busy);\n\n\t\t\t\t\tconst picture = this._element.closest('picture');\n\n\t\t\t\t\tif (picture && pictureElementSupported) {\n\t\t\t\t\t\tdelete this._element.dataset[this.srcsetAttr];\n\t\t\t\t\t\tdelete this._element.dataset[this.srcAttr];\n\n\t\t\t\t\t\tpicture.querySelectorAll('source[' + this._settings.srcsetAttr + ']').forEach(el => {\n\t\t\t\t\t\t\tel.setAttribute('srcset', el.dataset[this.srcAttr]);\n\t\t\t\t\t\t\tdelete el.dataset[this.srcAttr];\n\t\t\t\t\t\t});\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (this._element.matches('[' + this._settings.srcsetAttr + ']')) {\n\t\t\t\t\t\t\tthis._element.setAttribute('srcset', this._element.dataset[this.srcsetAttr]);\n\t\t\t\t\t\t\tdelete this._element.dataset[this.srcsetAttr];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tif (this._element.matches('[' + this._settings.srcAttr + ']')) {\n\t\t\t\t\t\t\tthis._element.setAttribute('src', this._element.dataset[this.srcAttr]);\n\t\t\t\t\t\t\tdelete this._element.dataset[this.srcAttr];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if (this._format === 'video' || this._format === 'audio') {\n\t\t\t\t\tconst isPlaythroughModeNormal = true === this._settings.playthrough,\n\t\t\t\t\t\tisPlaythroughModeFull = 'full' === this._settings.playthrough,\n\t\t\t\t\t\tsources = this._element.querySelectorAll('source'),\n\t\t\t\t\t\tisFullyBuffered = function(media) {\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\tmedia.buffered.length &&\n\t\t\t\t\t\t\t\tMath.round(media.buffered.end(0)) / Math.round(media.seekable.end(0)) === 1\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t};\n\n\t\t\t\t\tlet callMediaLoad = false;\n\n\t\t\t\t\tif (sources) {\n\t\t\t\t\t\tsources.forEach(source => {\n\t\t\t\t\t\t\tif (source.matches('[' + this._settings.srcAttr + ']')) {\n\t\t\t\t\t\t\t\tsource.setAttribute('src', source.dataset[this.srcAttr]);\n\t\t\t\t\t\t\t\tdelete source.dataset[this.srcsetAttr];\n\n\t\t\t\t\t\t\t\tcallMediaLoad = true;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tattachEventListener(\n\t\t\t\t\t\t\t\tsource,\n\t\t\t\t\t\t\t\t'error.' + this._idEvent,\n\t\t\t\t\t\t\t\te => {\n\t\t\t\t\t\t\t\t\tconst sourcesErrorId = pluginName + '_error';\n\n\t\t\t\t\t\t\t\t\tsource[pluginInstance + '_' + sourcesErrorId] = true;\n\n\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\tsources.length ===\n\t\t\t\t\t\t\t\t\t\tnodelistToArray(sources).filter(\n\t\t\t\t\t\t\t\t\t\t\tthisSource =>\n\t\t\t\t\t\t\t\t\t\t\t\ttrue === thisSource[pluginInstance + '_' + sourcesErrorId]\n\t\t\t\t\t\t\t\t\t\t).length\n\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\tthis._callback(e);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t!this._busy\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t});\n\t\t\t\t\t} else if (this._element.matches('[' + this._settings.srcAttr + ']')) {\n\t\t\t\t\t\tthis._element.setAttribute('src', this._element.dataset[this.srcAttr]);\n\t\t\t\t\t\tdelete this._element.dataset[this.srcAttr];\n\n\t\t\t\t\t\tattachEventListener(\n\t\t\t\t\t\t\tthis._element,\n\t\t\t\t\t\t\t'error.' + this._idEvent,\n\t\t\t\t\t\t\tthis._callback,\n\t\t\t\t\t\t\t!this._busy\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tcallMediaLoad = true;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (callMediaLoad) {\n\t\t\t\t\t\tthis._element.load();\n\t\t\t\t\t}\n\n\t\t\t\t\tattachEventListener(\n\t\t\t\t\t\tthis._element,\n\t\t\t\t\t\t'loadedmetadata.' + this._idEvent,\n\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\tif (!isPlaythroughModeNormal && !isPlaythroughModeFull) {\n\t\t\t\t\t\t\t\tthis._callback(new CustomEvent('load'));\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (isPlaythroughModeFull) {\n\t\t\t\t\t\t\t\tlet onProgressReplacementInterval = setInterval(() => {\n\t\t\t\t\t\t\t\t\tlet isError = this._element.readyState > 0 && !this._element.duration;\n\n\t\t\t\t\t\t\t\t\tif (isError || isFullyBuffered(this._element)) {\n\t\t\t\t\t\t\t\t\t\tthis._element.currentTime = 0;\n\n\t\t\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\t\t\t!isError &&\n\t\t\t\t\t\t\t\t\t\t\t!this._busy &&\n\t\t\t\t\t\t\t\t\t\t\tthis._element.paused &&\n\t\t\t\t\t\t\t\t\t\t\tthis._element.matches('[autoplay]')\n\t\t\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\t\t\tthis._element.play();\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tclearInterval(onProgressReplacementInterval);\n\n\t\t\t\t\t\t\t\t\t\tthis._callback(new CustomEvent(!isError ? 'load' : 'error'));\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tif (!this._element.paused) {\n\t\t\t\t\t\t\t\t\t\t\tthis._element.pause();\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tif (!this._busy) {\n\t\t\t\t\t\t\t\t\t\t\tthis._element.currentTime += 2;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}, 500);\n\n\t\t\t\t\t\t\t\tthis._element[\n\t\t\t\t\t\t\t\t\tpluginName + '_' + this._idEvent\n\t\t\t\t\t\t\t\t] = onProgressReplacementInterval;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t!this._busy\n\t\t\t\t\t);\n\n\t\t\t\t\tattachEventListener(\n\t\t\t\t\t\tthis._element,\n\t\t\t\t\t\t'canplay.' + this._idEvent,\n\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\tisPlaythroughModeFull &&\n\t\t\t\t\t\t\t\tthis._element.currentTime === 0 &&\n\t\t\t\t\t\t\t\t!isFullyBuffered(this._element)\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tthis._element.currentTime++;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t!this._busy\n\t\t\t\t\t);\n\n\t\t\t\t\tattachEventListener(\n\t\t\t\t\t\tthis._element,\n\t\t\t\t\t\t'canplaythrough.' + this._idEvent,\n\t\t\t\t\t\t() => {\n\t\t\t\t\t\t\tif (isPlaythroughModeNormal) {\n\t\t\t\t\t\t\t\tthis._callback(new CustomEvent('load'));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t!this._busy\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\n\t\t\t\tif (!this._busy) {\n\t\t\t\t\tthis._element[pluginInstance + '_IDEvent'] = this._idEvent;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis._resource = this._element.currentSrc || this._element.src;\n\n\t\t\treturn !this._busy;\n\t\t}\n\n\t\t/**\n\t\t * @param {Function} callback\n\t\t * @returns {undefined}\n\t\t */\n\t\tdone(callback) {\n\t\t\tif (typeof callback !== 'function') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._done = function(element, status, resource, id) {\n\t\t\t\tcallback.apply(this, [element, status, resource, id]);\n\t\t\t};\n\t\t}\n\n\t\t/**\n\t\t * @returns {undefined}\n\t\t */\n\t\tabort() {\n\t\t\tdetachEventListener(this._element, '.' + this._idEvent);\n\n\t\t\tif (isLoaded(this._exists ? this._element : this._resource)) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst src = this._element.getAttribute('srcset'),\n\t\t\t\tsrcset = this._element.getAttribute('src');\n\n\t\t\tif (undefined !== src) {\n\t\t\t\tthis._element.dataset[this.srcAttr] = src;\n\t\t\t\tthis._element.setAttribute(this._settings.srcAttr, src);\n\t\t\t\tthis._element.removeAttribute('src');\n\t\t\t\tthis._element.removeAttribute('srcset');\n\t\t\t}\n\n\t\t\tif (undefined !== srcset) {\n\t\t\t\tthis._element.dataset[this.srcsetAttr] = srcset;\n\t\t\t\tthis._element.setAttribute(this._settings.srcsetAttr, srcset);\n\t\t\t\tthis._element.removeAttribute('src');\n\t\t\t\tthis._element.removeAttribute('srcset');\n\t\t\t}\n\t\t}\n\t}\n\n\t// TODO: Promise support\n\t// TODO: private vars\n\t// TODO: refactory succes/done/progress code...\n\t/** TODO: description of the MyClass constructor function.\n\t * @class\n\t * @classdesc TODO: description of the Loader class.\n\t */\n\tclass Loader {\n\t\t/**\n\t\t * @param {Object} [options={srcAttr: 'data-src', srcsetAttr: 'data-srcset', playthrough: false, visible: false, backgrounds: false, extraAttrs: [] }]\n\t\t */\n\t\tconstructor(options) {\n\t\t\tthis._collection = [];\n\t\t\tthis._collectionLoaded = [];\n\t\t\tthis._collectionInstances = [];\n\t\t\tthis._collectionPending = [];\n\t\t\tthis._resourcesLoaded = [];\n\n\t\t\tthis._settings = {\n\t\t\t\t...{\n\t\t\t\t\tsrcAttr: 'data-src',\n\t\t\t\t\tsrcsetAttr: 'data-srcset',\n\t\t\t\t\tplaythrough: false,\n\t\t\t\t\tvisible: false,\n\t\t\t\t\tbackgrounds: false,\n\t\t\t\t\textraAttrs: []\n\t\t\t\t},\n\t\t\t\t...options\n\t\t\t};\n\n\t\t\tthis.srcAttr = '';\n\t\t\tthis.srcsetAttr = '';\n\t\t\tif (!stringStartsWith(this._settings.srcAttr, 'data-')) {\n\t\t\t\tthis.srcAttr = this._settings.srcAttr;\n\t\t\t\tthis._settings.srcAttr = 'data-' + this._settings.srcAttr;\n\t\t\t} else {\n\t\t\t\tthis.srcAttr = this._settings.srcAttr.replace('data-', '');\n\t\t\t}\n\t\t\tif (!stringStartsWith(this._settings.srcsetAttr, 'data-')) {\n\t\t\t\tthis.srcsetAttr = this._settings.srcsetAttr;\n\t\t\t\tthis._settings.srcsetAttr = 'data-' + this._settings.srcsetAttr;\n\t\t\t} else {\n\t\t\t\tthis.srcsetAttr = this._settings.srcsetAttr.replace('data-', '');\n\t\t\t}\n\n\t\t\tif (typeof this._settings.extraAttrs === 'string') {\n\t\t\t\tthis._settings.extraAttrs = this._settings.extraAttrs.split(\n\t\t\t\t\tthis._settings.extraAttrs.contains(',') ? ',' : ' '\n\t\t\t\t);\n\t\t\t}\n\t\t\tif (!Array.isArray(this._settings.extraAttrs)) {\n\t\t\t\tthis._settings.extraAttrs = [];\n\t\t\t}\n\n\t\t\tthis.srcAttr = hyphensToCamelCase(this.srcAttr);\n\t\t\tthis.srcsetAttr = hyphensToCamelCase(this.srcsetAttr);\n\n\t\t\tthis.percentage = 0;\n\n\t\t\tthis._done = () => {};\n\t\t\tthis._progress = () => {};\n\t\t\tthis._success = () => {};\n\t\t\tthis._error = () => {};\n\t\t\tthis._loop = this.load;\n\n\t\t\tthis._abort = false;\n\t\t\tthis._loaded = 0;\n\t\t\tthis._complete = false;\n\t\t\tthis._busy = false;\n\t\t}\n\n\t\t/**\n\t\t *\n\t\t * @param {HTMLElement} [element=document.body]\n\t\t * @param {Object} [options={ srcAttr: 'src', srcsetAttr: 'srcset', backgrounds: false, extraAttrs: [] }]\n\t\t */\n\t\tstatic findResources(element, options) {\n\t\t\tlet settings = {\n\t\t\t\tsrcAttr: 'src',\n\t\t\t\tsrcsetAttr: 'srcset',\n\t\t\t\tbackgrounds: false,\n\t\t\t\textraAttrs: []\n\t\t\t};\n\n\t\t\tif (typeof element === 'object' && undefined === options) {\n\t\t\t\tfor (let key in settings) {\n\t\t\t\t\tif (key in element) {\n\t\t\t\t\t\toptions = element;\n\t\t\t\t\t\telement = undefined;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (undefined === element || element === document) {\n\t\t\t\telement = document.body;\n\t\t\t}\n\n\t\t\tif (!isHTMLElement(element)) {\n\t\t\t\tthrow new Error('TypeError: ' + element + ' is not of type HTMLElement.');\n\t\t\t}\n\n\t\t\tlet collectedResources = [];\n\n\t\t\tsettings = {\n\t\t\t\t...settings,\n\t\t\t\t...options\n\t\t\t};\n\n\t\t\tconst targets = 'img, video, audio',\n\t\t\t\ttargetsExtended = targets + ', picture, source',\n\t\t\t\ttargetsFilter = '[' + settings.srcAttr + '], [' + settings.srcsetAttr + ']';\n\n\t\t\tif (typeof settings.extraAttrs === 'string') {\n\t\t\t\tsettings.extraAttrs = ettings.extraAttrs.split(ettings.extraAttrs.contains(',') ? ',' : ' ');\n\t\t\t}\n\t\t\tif (!Array.isArray(settings.extraAttrs)) {\n\t\t\t\tsettings.extraAttrs = [];\n\t\t\t}\n\n\t\t\tlet targetsTags = nodelistToArray(element.querySelectorAll(targets));\n\n\t\t\tif (element.matches(targetsExtended)) {\n\t\t\t\ttargetsTags.push(element);\n\t\t\t}\n\n\t\t\ttargetsTags = targetsTags.filter(target => {\n\t\t\t\tlet children = nodelistToArray(target.children);\n\t\t\t\tchildren = children.filter(x => x.matches(targetsExtended));\n\t\t\t\tchildren = children.filter(x => x.matches(targetsFilter));\n\t\t\t\treturn target.matches(targetsFilter) || children.length;\n\t\t\t});\n\t\t\ttargetsTags.forEach(target => {\n\t\t\t\tlet targetSource = target;\n\n\t\t\t\tif (!targetSource.matches(targetsFilter)) {\n\t\t\t\t\ttargetSource = targetSource.querySelectorAll(targetsFilter);\n\t\t\t\t\ttargetSource = [...targetSource][0];\n\t\t\t\t}\n\n\t\t\t\tcollectedResources.push({\n\t\t\t\t\telement: target,\n\t\t\t\t\tresource:\n\t\t\t\t\t\ttargetSource.getAttribute(settings.srcAttr) ||\n\t\t\t\t\t\ttargetSource.getAttribute(settings.srcsetAttr)\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tif (true === settings.backgrounds) {\n\t\t\t\tlet targetsBg = nodelistToArray(element.querySelectorAll('*'));\n\t\t\t\ttargetsBg.push(element);\n\t\t\t\ttargetsBg = targetsBg.filter(target => !target.matches(targetsExtended));\n\t\t\t\ttargetsBg = targetsBg.filter(target => getComputedStyle(target).backgroundImage !== 'none');\n\t\t\t\ttargetsBg.forEach(target => {\n\t\t\t\t\tconst url = getComputedStyle(target).backgroundImage.match(/\\((.*?)\\)/);\n\n\t\t\t\t\tif (null !== url && url.length >= 2) {\n\t\t\t\t\t\tcollectedResources.push({\n\t\t\t\t\t\t\telement: target,\n\t\t\t\t\t\t\tresource: url[1].replace(/('|\")/g, '')\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tsettings.extraAttrs.forEach(attr => {\n\t\t\t\tnodelistToArray(\n\t\t\t\t\telement.querySelectorAll('[' + attr + ']:not(' + targetsExtended + ')')\n\t\t\t\t).forEach(target => {\n\t\t\t\t\tcollectedResources.push({\n\t\t\t\t\t\telement: target,\n\t\t\t\t\t\tresource: target.getAttribute(attr)\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\tif (element.matches('[' + attr + ']') && !element.matches(targetsExtended)) {\n\t\t\t\t\tcollectedResources.push({\n\t\t\t\t\t\telement: element,\n\t\t\t\t\t\tresource: element.getAttribute(attr)\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn collectedResources;\n\t\t}\n\n\t\t/**\n\t\t * @param {(Array.<String>|HTMLElement)} collection\n\t\t */\n\t\tset collection(collection) {\n\t\t\tlet collectedResources = collection;\n\n\t\t\ttry {\n\t\t\t\tcollectedResources = Loader.findResources(collection, this._settings);\n\t\t\t} catch (err) {}\n\n\t\t\tcollectedResources.forEach(item => {\n\t\t\t\tlet element = {\n\t\t\t\t\tresource: '',\n\t\t\t\t\telement: null,\n\t\t\t\t\tid: generateInstanceID()\n\t\t\t\t};\n\n\t\t\t\tif (typeof item === 'string') {\n\t\t\t\t\telement.resource = item;\n\t\t\t\t} else if (typeof item === 'object' && 'resource' in item) {\n\t\t\t\t\telement = { ...element, ...item };\n\t\t\t\t} else {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tthis._collection.push(element);\n\t\t\t});\n\t\t}\n\n\t\t/**\n\t\t * @returns {Array} collection\n\t\t */\n\t\tget collection() {\n\t\t\treturn this._collection;\n\t\t}\n\n\t\t/**\n\t\t * @returns {undefined}\n\t\t */\n\t\tload() {\n\t\t\tif (!this._collection.length) {\n\t\t\t\tthis._done.call(this, this._resourcesLoaded);\n\t\t\t}\n\n\t\t\t// resets pending elements (sequential opt helper array) every time we loop\n\t\t\tthis._collectionPending = [];\n\n\t\t\tconst sequentialMode = true === this._settings.sequential;\n\n\t\t\tfor (let i = 0; i < this._collection.length; i++) {\n\t\t\t\tif (this._abort) {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tlet thisLoadId = this._collection[i].id,\n\t\t\t\t\tthisLoadIndex = arrayFindIndex(this._collectionInstances, x => x.id === thisLoadId),\n\t\t\t\t\tthisLoadInstance = new SingleLoader(this._settings);\n\n\t\t\t\tif (thisLoadIndex === -1) {\n\t\t\t\t\tthis._collectionInstances.push({\n\t\t\t\t\t\tid: thisLoadId,\n\t\t\t\t\t\tinstance: thisLoadInstance\n\t\t\t\t\t});\n\t\t\t\t\tthisLoadIndex = arrayFindIndex(this._collectionInstances, x => x.id === thisLoadId);\n\t\t\t\t} else {\n\t\t\t\t\tthis._collectionInstances[thisLoadIndex].instance = thisLoadInstance;\n\t\t\t\t}\n\n\t\t\t\tthisLoadInstance.resource = this._collection[i];\n\n\t\t\t\tthisLoadInstance.done((element, status, resource, id) => {\n\t\t\t\t\tif (this._complete || this._abort) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst aProgress = !isInArray(id, this._collectionLoaded);\n\n\t\t\t\t\tif (aProgress) {\n\t\t\t\t\t\tthis._collectionLoaded.push(id);\n\t\t\t\t\t\tthis._busy = false;\n\n\t\t\t\t\t\tthis._loaded++;\n\t\t\t\t\t\tthis.percentage = this._loaded / this._collection.length * 100;\n\t\t\t\t\t\tthis.percentage = parseFloat(this.percentage.toFixed(4));\n\n\t\t\t\t\t\tconst thisResource = {\n\t\t\t\t\t\t\tresource: resource,\n\t\t\t\t\t\t\tstatus: status,\n\t\t\t\t\t\t\telement: element\n\t\t\t\t\t\t};\n\t\t\t\t\t\tthis._resourcesLoaded.push(thisResource);\n\t\t\t\t\t\tthis._progress.call(this, thisResource);\n\t\t\t\t\t\tthis[status !== 'error' ? '_success' : '_error'].call(this, thisResource);\n\t\t\t\t\t\t// TODO: dispatch event on element maybe?\n\t\t\t\t\t\t// element.dispatchEvent(new CustomEvent(pluginPrefix + capitalize(status) + '.' + pluginPrefix));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (this._loaded === this._collection.length) {\n\t\t\t\t\t\tthis._done.call(this, this._resourcesLoaded);\n\n\t\t\t\t\t\tthis._complete = true;\n\t\t\t\t\t} else if (aProgress && sequentialMode && this._collectionPending.length) {\n\t\t\t\t\t\tthis._collectionPending = this._collectionPending.filter(x => x.id !== id);\n\n\t\t\t\t\t\tif (this._collectionPending.length) {\n\t\t\t\t\t\t\tthis._busy = this._collectionPending[0].instance.load();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (!sequentialMode || (sequentialMode && !this._busy)) {\n\t\t\t\t\tthis._busy = thisLoadInstance.load();\n\t\t\t\t} else if (\n\t\t\t\t\tsequentialMode &&\n\t\t\t\t\tthis._busy &&\n\t\t\t\t\t(!this._settings.visible ||\n\t\t\t\t\t\t!thisLoadInstance._exists ||\n\t\t\t\t\t\t(this._settings.visible &&\n\t\t\t\t\t\t\tthisLoadInstance._exists &&\n\t\t\t\t\t\t\tisVisible(thisLoadInstance._originalElement)))\n\t\t\t\t) {\n\t\t\t\t\tthis._collectionPending.push({\n\t\t\t\t\t\tid: thisLoadId,\n\t\t\t\t\t\tinstance: thisLoadInstance\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * @param {Function} callback\n\t\t * @returns {undefined}\n\t\t */\n\t\tdone(callback) {\n\t\t\tif (typeof callback !== 'function') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._done = function(resources) {\n\t\t\t\tcallback.call(this, resources);\n\t\t\t};\n\t\t}\n\n\t\t/**\n\t\t * @param {Function} callback\n\t\t * @returns {undefined}\n\t\t */\n\t\tprogress(callback) {\n\t\t\tif (typeof callback !== 'function') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._progress = function(resource) {\n\t\t\t\tcallback.call(this, resource);\n\t\t\t};\n\t\t}\n\n\t\t/**\n\t\t * @param {Function} callback\n\t\t * @returns {undefined}\n\t\t */\n\t\tsuccess(callback) {\n\t\t\tif (typeof callback !== 'function') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._success = function(resource) {\n\t\t\t\tcallback.call(this, resource);\n\t\t\t};\n\t\t}\n\n\t\t/**\n\t\t * @param {Function} callback\n\t\t * @returns {undefined}\n\t\t */\n\t\terror(callback) {\n\t\t\tif (typeof callback !== 'function') {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis._error = function(resource) {\n\t\t\t\tcallback.call(this, resource);\n\t\t\t};\n\t\t}\n\n\t\t/**\n\t\t * @returns {undefined}\n\t\t */\n\t\tabort() {\n\t\t\tthis._collectionInstances.forEach(thisInstance => {\n\t\t\t\tthisInstance.instance.abort();\n\t\t\t});\n\n\t\t\tthis._abort = true;\n\t\t}\n\t}\n\n\t// public interface\n\t// - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\t// requirejs\n\tif (typeof define === 'function' && define.amd) {\n\t\tdefine(capitalize(pluginName), Loader);\n\t\t// nodejs\n\t} else if ('object' === typeof exports) {\n\t\tmodule.exports[capitalize(pluginName)] = Loader;\n\t\t// vanilla\n\t} else {\n\t\twindow[capitalize(pluginName)] = Loader;\n\t}\n\t// - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\n\t// jQuery interface\n\t// - - - - - - - - - - - - - - - - - - - -\n\tif (!$) {\n\t\treturn undefined;\n\t}\n\n\t$[capitalize(pluginName)] = Loader;\n\n\tconst $document = $(document),\n\t\t$window = $(window),\n\t\t// thanks https://gist.github.com/beaucharman/e46b8e4d03ef30480d7f4db5a78498ca\n\t\tthrottle = (callback, wait, context = this) => {\n\t\t\tlet timeout = null,\n\t\t\t\tcallbackArgs = null;\n\t\t\tconst later = () => {\n\t\t\t\tcallback.apply(context, callbackArgs);\n\t\t\t\ttimeout = null;\n\t\t\t};\n\t\t\treturn function() {\n\t\t\t\tif (!timeout) {\n\t\t\t\t\tcallbackArgs = arguments;\n\t\t\t\t\ttimeout = setTimeout(later, wait);\n\t\t\t\t}\n\t\t\t};\n\t\t};\n\n\tlet methodCollection = [];\n\n\t$.fn[pluginMethod] = function(options) {\n\t\tlet originalUserOptions = options;\n\n\t\tif (typeof options !== 'object') {\n\t\t\toptions = {};\n\t\t}\n\n\t\tlet settings = {\n\t\t\t...{\n\t\t\t\tsrcAttr: 'data-src',\n\t\t\t\tsrcsetAttr: 'data-srcset',\n\n\t\t\t\tvisible: false,\n\n\t\t\t\tsequential: false,\n\n\t\t\t\tbackgrounds: false,\n\t\t\t\textraAttrs: [],\n\n\t\t\t\tplaythrough: false,\n\n\t\t\t\tearly: false,\n\t\t\t\tearlyTimeout: 0,\n\n\t\t\t\tonProgress: () => {},\n\t\t\t\tonLoad: () => {},\n\t\t\t\tonError: () => {},\n\n\t\t\t\tonComplete: () => {}\n\t\t\t},\n\t\t\t...options\n\t\t};\n\n\t\tlet callback = settings.onComplete;\n\t\tif ($.isFunction(originalUserOptions)) {\n\t\t\tcallback = originalUserOptions;\n\t\t}\n\n\t\treturn this.each(function(i) {\n\t\t\t// TODO: mutation observer when new children are appended\n\n\t\t\tconst $element = $(this),\n\t\t\t\tuniqueMethodPluginName = generateInstanceID() + i,\n\t\t\t\tthisLoadInstance = new Loader(settings);\n\n\t\t\tthisLoadInstance.collection = this;\n\n\t\t\tmethodCollection.push({\n\t\t\t\tid: uniqueMethodPluginName,\n\t\t\t\tinstance: thisLoadInstance,\n\t\t\t\telement: this,\n\t\t\t\ttimeout: null\n\t\t\t});\n\n\t\t\tthisLoadInstance.progress(resource => {\n\t\t\t\t$(resource.element).trigger(pluginPrefix + capitalize(resource.status) + '.' + pluginPrefix, [\n\t\t\t\t\tresource.element,\n\t\t\t\t\tresource.resource\n\t\t\t\t]);\n\t\t\t\t$element.trigger(pluginPrefix + 'Progress.' + pluginPrefix, [this, resource]);\n\n\t\t\t\tconst thisArguments = [thisLoadInstance, resource];\n\n\t\t\t\tif (typeof settings.onProgress === 'function') {\n\t\t\t\t\tsettings.onProgress.apply(this, thisArguments);\n\t\t\t\t}\n\n\t\t\t\tlet eventName = capitalize(resource.status);\n\t\t\t\tif (typeof settings['on' + eventName] === 'function') {\n\t\t\t\t\tsettings['on' + eventName].apply(this, thisArguments);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tthisLoadInstance.done(resources => {\n\t\t\t\t$element.trigger(pluginPrefix + 'Complete.' + pluginPrefix, [this, resources]);\n\t\t\t\tcallback.apply(this, [thisLoadInstance, resources]);\n\n\t\t\t\tif (settings.visible) {\n\t\t\t\t\t/*if (IntersectionObserverSupported) {\n                        thisLoadInstance.collection.forEach(item => item.element.intersectionObserver.unobserve(item.element));\n\n                    } else {*/\n\t\t\t\t\t$window.off('scroll.' + uniqueMethodPluginName);\n\n\t\t\t\t\t//}\n\t\t\t\t}\n\n\t\t\t\t// refresh other method calls for same el (omitting this one)\n\t\t\t\tmethodCollection = methodCollection.filter(x => x.id !== uniqueMethodPluginName);\n\t\t\t\tmethodCollection.forEach(thisMethodCollection => {\n\t\t\t\t\tif ($element.is(thisMethodCollection.element)) {\n\t\t\t\t\t\tthisMethodCollection.instance.load();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\tthisLoadInstance.load();\n\n\t\t\tif (settings.visible) {\n\t\t\t\t/* if (IntersectionObserverSupported) {\n\n                    thisLoadInstance.collection.forEach(item => {\n\n                        item.element.intersectionObserver = new IntersectionObserver((entries, observer) => {\n                            entries.forEach(entry => {\n                                if( entry.intersectionRatio > 0 ){\n                                    thisLoadInstance.load();\n                                }\n                            });\n                        }, {\n                            root: null,\n                            rootMargin: '0px',\n                            threshold: 0.0\n                        });\n\n                        item.element.intersectionObserver.observe(item.element);\n\n                    });\n\n                } else {*/\n\n\t\t\t\t$window.on('scroll.' + uniqueMethodPluginName, throttle(() => thisLoadInstance.load(), 250));\n\n\t\t\t\t//}\n\t\t\t}\n\n\t\t\tif (true === settings.early) {\n\t\t\t\tlet breakLoop = false;\n\n\t\t\t\tmethodCollection.forEach(thisMethodCollection => {\n\t\t\t\t\tif (breakLoop) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (methodCollection[key].id === uniqueMethodPluginName) {\n\t\t\t\t\t\tclearTimeout(thisMethodCollection.timeout);\n\n\t\t\t\t\t\tlet timeout = parseInt(settings.earlyTimeout);\n\n\t\t\t\t\t\tthisMethodCollection.timeout = setTimeout(() => {\n\t\t\t\t\t\t\t// TODO: appropriate method to set/update settings?\n\t\t\t\t\t\t\tthisMethodCollection.instance._settings.visible = false;\n\t\t\t\t\t\t\tthisMethodCollection.instance._settings.sequential = true;\n\n\t\t\t\t\t\t\tthisMethodCollection.instance.load();\n\t\t\t\t\t\t}, !isNaN(timeout) && isFinite(timeout) ? timeout : 0);\n\n\t\t\t\t\t\tbreakLoop = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t};\n})(window, document, jQuery);\n"],"file":"nite.loader.min.js"}