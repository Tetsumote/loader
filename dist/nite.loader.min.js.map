{"version":3,"sources":["nite.loader.js"],"names":["window","document","$","undefined","CustomEvent","event","params","bubbles","cancelable","detail","evt","createEvent","initCustomEvent","prototype","Event","Array","findIndex","Object","defineProperty","value","predicate","this","TypeError","o","len","length","thisArg","arguments","k","kValue","call","configurable","writable","isArray","arg","toString","filter","func","res","t","c","i","String","startsWith","search","pos","substr","includes","start","indexOf","generateInstanceID","Math","floor","random","pluginName","pluginMethod","pluginInstance","detachEventListener","element","events","keys","privateEventsStorage","forEach","key","replace","type","split","join","removeEventListener","handler","attachEventListener","once","count","_handler","addEventListener","hyphensToCamelCase","string","g","toUpperCase","capitalize","charAt","slice","nodelistToArray","nodelist","isInArray","needle","stack","isVisible","intersectionRatio","getComputedStyle","bodyEl","getElementsByTagName","winWidth","innerWidth","documnt","documentElement","clientWidth","winHeight","innerHeight","clientHeight","rect","getBoundingClientRect","right","bottom","left","top","isHTMLObject","HTMLElement","e","nodeType","style","ownerDocument","isLoaded","source","privateCache","currentSrc","complete","readyState","isBroken","naturalWidth","videoWidth","decodeResource","resource","formatExtensions","image","audio","video","formatTagNames","output","format","extension","tag","exists","breakLoop","formatCandidate","RegExp","test","matches64","match","matches","tagName","toLowerCase","allTags","values","tags","SingleLoader","[object Object]","options","_settings","srcAttr","srcsetAttr","playthrough","visible","_id","_idEvent","_busy","_element","_resource","_format","_observer","_done","_success","_error","_callback","unobserve","src","push","thisArguments","apply","data","id","info","_tag","_exists","IntersectionObserver","entries","observer","entry","target","root","rootMargin","threshold","observe","createElement","dataset","picture","closest","querySelectorAll","el","setAttribute","isPlaythroughModeNormal","isPlaythroughModeFull","sources","isFullyBuffered","media","buffered","round","end","seekable","callMediaLoad","sourcesErrorId","thisSource","load","onProgressReplacementInterval","setInterval","isError","duration","currentTime","paused","play","clearInterval","pause","callback","status","getAttribute","srcset","removeAttribute","Loader","_collection","_collectionLoaded","_collectionInstances","_collectionPending","_resourcesLoaded","backgrounds","attributes","contains","percentage","_progress","_loop","_abort","_loaded","_complete","collection","item","targetsExtended","targets","targetsFilter","targetsTags","children","x","targetSource","targetsBg","backgroundImage","url","attr","hasOwnProperty","sequentialMode","sequential","thisLoadId","thisLoadIndex","thisLoadInstance","instance","done","aProgress","parseFloat","toFixed","thisResource","_func","resources","abort","define","amd","exports","module","$window","throttle","wait","context","timeout","callbackArgs","later","setTimeout","methodCollection","fn","originalUserOptions","settings","extraAttrs","early","earlyTimeout","onProgress","onLoad","onError","onComplete","isFunction","each","$element","uniqueMethodPluginName","collect","progress","trigger","pluginPrefix","eventName","off","thisMethodCollection","is","on","clearTimeout","parseInt","isNaN","isFinite","jQuery"],"mappings":"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","sourcesContent":["/*! Nite Loader | Daniele Fioroni | dfioroni91@gmail.com */\r\n(function (window, document, $, undefined) {\r\n    'use strict';\r\n\r\n    // https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent#Polyfill\r\n    (function () {\r\n        if (typeof window.CustomEvent === \"function\") {\r\n            return false;\r\n        }\r\n        function CustomEvent(event, params) {\r\n            params = params || { bubbles: false, cancelable: false, detail: undefined };\r\n            const evt = document.createEvent('CustomEvent');\r\n            evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\r\n            return evt;\r\n        }\r\n        CustomEvent.prototype = window.Event.prototype;\r\n        window.CustomEvent = CustomEvent;\r\n    })();\r\n\r\n    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/findIndex#Polyfill\r\n    if (!Array.prototype.findIndex) {\r\n        Object.defineProperty(Array.prototype, 'findIndex', {\r\n            value: function (predicate) {\r\n                if (this == null) {\r\n                    throw new TypeError('\"this\" is null or not defined');\r\n                }\r\n                let\r\n                    o = Object(this),\r\n                    len = o.length >>> 0;\r\n                if (typeof predicate !== 'function') {\r\n                    throw new TypeError('predicate must be a function');\r\n                }\r\n                let\r\n                    thisArg = arguments[1],\r\n                    k = 0;\r\n                while (k < len) {\r\n                    let kValue = o[k];\r\n                    if (predicate.call(thisArg, kValue, k, o)) {\r\n                        return k;\r\n                    }\r\n                    k++;\r\n                }\r\n                return -1;\r\n            },\r\n            configurable: true,\r\n            writable: true\r\n        });\r\n    }\r\n\r\n    // https://developer.mozilla.org/it/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray#Polyfill\r\n    Array.isArray = Array.isArray || function (arg) {\r\n        return Object.prototype.toString.call(arg) === '[object Array]';\r\n    };\r\n\r\n    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/filter#Polyfill\r\n    Array.prototype.filter = Array.prototype.filter || function (func, thisArg) {\r\n        'use strict';\r\n        if (!((typeof func === 'Function' || typeof func === 'function') && this)) {\r\n            throw new TypeError();\r\n        }\r\n        let\r\n            len = this.length >>> 0,\r\n            res = new Array(len),\r\n            t = this, c = 0, i = -1;\r\n        if (thisArg === undefined) {\r\n            while (++i !== len) {\r\n                if (i in this) {\r\n                    if (func(t[i], i, t)) {\r\n                        res[c++] = t[i];\r\n                    } else {\r\n                        while (++i !== len) {\r\n                            if (i in this) {\r\n                                if (func.call(thisArg, t[i], i, t)) {\r\n                                    res[c++] = t[i];\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        res.length = c;\r\n        return res;\r\n    }\r\n\r\n    // https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/startsWith#Polyfill\r\n    String.prototype.startsWith = String.prototype.startsWith || function (search, pos) {\r\n        return this.substr(!pos || pos < 0 ? 0 : +pos, search.length) === search;\r\n    };\r\n\r\n    // https://developer.mozilla.org/it/docs/Web/JavaScript/Reference/Global_Objects/String/includes#Polyfill\r\n    String.prototype.includes = String.prototype.includes || function (search, start) {\r\n        'use strict';\r\n        if (typeof start !== 'number') {\r\n            start = 0;\r\n        }\r\n        if (start + search.length > this.length) {\r\n            return false;\r\n        } else {\r\n            return this.indexOf(search, start) !== -1;\r\n        }\r\n    };\r\n\r\n    const\r\n        generateInstanceID = function () {\r\n            return Math.floor(Math.random() * (9999 - 1000)) + 1000;\r\n        },\r\n        pluginPrefix = 'nite',\r\n        pluginMethod = pluginPrefix + 'Load',\r\n        pluginName = pluginMethod + 'er',\r\n        pluginInstance = generateInstanceID(),\r\n        eventNamespaceParserSeparator = '__namespace__',\r\n        detachEventListener = (element, events) => {\r\n\r\n            if (!element || typeof events !== 'string') {\r\n                return;\r\n            }\r\n\r\n            if (events.startsWith('.')) {\r\n                Object.keys(privateEventsStorage).forEach(key => {\r\n                    if (key.replace(eventNamespaceParserSeparator, '.').includes(events) && privateEventsStorage[key].element === element) {\r\n                        detachEventListener(element, key.replace(eventNamespaceParserSeparator, '.'));\r\n                    }\r\n                });\r\n            } else {\r\n\r\n                events = events.split('.');\r\n\r\n                const\r\n                    type = events[0],\r\n                    namespace = events[1];\r\n\r\n                if (namespace) {\r\n                    events = events.join(eventNamespaceParserSeparator);\r\n                }\r\n\r\n                if (events in privateEventsStorage) {\r\n                    element.removeEventListener(type, privateEventsStorage[events].handler);\r\n                    delete privateEventsStorage[events];\r\n                }\r\n\r\n            }\r\n\r\n        },\r\n        attachEventListener = (element, events, handler, once) => {\r\n\r\n            if (!element || typeof events !== 'string' || typeof handler !== 'function') {\r\n                return;\r\n            }\r\n\r\n            events = events.split('.');\r\n\r\n            const\r\n                type = events[0],\r\n                namespace = events[1];\r\n\r\n            if (namespace) {\r\n                events = events.join(eventNamespaceParserSeparator);\r\n            }\r\n\r\n            privateEventsStorage[events] = {\r\n                element: element,\r\n                count: 0,\r\n                once: false\r\n            };\r\n\r\n            if (true === once) {\r\n                let _handler = handler;\r\n                handler = function (event) {\r\n                    if (events in privateEventsStorage) {\r\n                        privateEventsStorage[events].count++;\r\n                        if (privateEventsStorage[events].once && privateEventsStorage[events].count > 1) {\r\n                            return;\r\n                        }\r\n                        _handler.call(this, event);\r\n                    }\r\n                    detachEventListener(element, events);\r\n                }\r\n            } else {\r\n                once = false;\r\n            }\r\n\r\n            privateEventsStorage[events] = {\r\n                ...privateEventsStorage[events], ...{\r\n                    handler: handler,\r\n                    once: once\r\n                }\r\n            };\r\n\r\n            element.addEventListener(type, privateEventsStorage[events].handler, { once: once });\r\n\r\n        },\r\n        hyphensToCamelCase = string => {\r\n            return string.replace(/-([a-z])/g, g => g[1].toUpperCase());\r\n        },\r\n        capitalize = string => {\r\n            return string.charAt(0).toUpperCase() + string.slice(1);\r\n        },\r\n        nodelistToArray = nodelist => {\r\n            return [...nodelist];\r\n        },\r\n        isInArray = (needle, stack) => {\r\n            return stack.indexOf(needle) > -1;\r\n        },\r\n        isVisible = element => {\r\n\r\n            if( 'IntersectionObserver' in window && 'intersectionRatio' in element ){\r\n                return element.intersectionRatio > 0;\r\n            }\r\n\r\n            if (window.getComputedStyle(element, 'display') === 'none') {\r\n                return false;\r\n            }\r\n\r\n            const\r\n                bodyEl = document.getElementsByTagName('body')[0],\r\n                winWidth = window.innerWidth || documnt.documentElement.clientWidth || bodyEl.clientWidth,\r\n                winHeight = window.innerHeight || documnt.documentElement.clientHeight || bodyEl.clientHeight,\r\n                rect = element.getBoundingClientRect();\r\n\r\n            return !(rect.right < 0 || rect.bottom < 0 || rect.left > winWidth || rect.top > winHeight);\r\n\r\n        },\r\n        isHTMLObject = element => {\r\n            if (typeof element !== 'object') {\r\n                return false;\r\n            }\r\n            try {\r\n                return element instanceof HTMLElement;\r\n            } catch (e) {\r\n                return element.nodeType === 1 && typeof element.style === 'object' && typeof element.ownerDocument === 'object';\r\n            }\r\n        },\r\n        isLoaded = source => {\r\n            return (\r\n                (\r\n                    typeof source === 'string'\r\n                    &&\r\n                    isInArray(source, privateCache)\r\n                )\r\n                ||\r\n                (\r\n                    isHTMLObject(source)\r\n                    &&\r\n                    ('currentSrc' in source && source.currentSrc.length > 0)\r\n                    &&\r\n                    (\r\n                        ('complete' in source && source.complete)\r\n                        ||\r\n                        ('readyState' in source && source.readyState >= 2))\r\n                )\r\n            );\r\n        },\r\n        isBroken = source => {\r\n            return (\r\n                isLoaded(source)\r\n                &&\r\n                (\r\n                    (\r\n                        typeof source === 'object'\r\n                        &&\r\n                        (\r\n                            ('naturalWidth' in source && Math.floor(source.naturalWidth) === 0)\r\n                            ||\r\n                            ('videoWidth' in source && source.videoWidth === 0)\r\n                        )\r\n                    )\r\n                    ||\r\n                    typeof source === 'string'\r\n                )\r\n            );\r\n        },\r\n        decodeResource = resource => {\r\n\r\n            const\r\n                formatExtensions = {\r\n                    image: 'jp[e]?g|jpe|jif|jfif|jfi|gif|png|tif[f]?|bmp|dib|webp|ico|cur|svg',\r\n                    audio: 'mp3|ogg|oga|spx|ogg|wav',\r\n                    video: 'mp4|ogv|webm'\r\n                },\r\n                formatTagNames = {\r\n                    image: 'img|picture|source',\r\n                    audio: 'audio|source',\r\n                    video: 'video|source'\r\n                },\r\n                base64Heading = '\\;base64\\,';\r\n\r\n            let\r\n                output = {\r\n                    format: null,\r\n                    extension: null,\r\n                    tag: null,\r\n                    exists: false\r\n                },\r\n                breakLoop = false;\r\n\r\n            resource.resource = resource.resource.split('?')[0];\r\n            resource.resource = resource.resource.split('#')[0];\r\n            Object.keys(formatExtensions).forEach(formatCandidate => {\r\n\r\n                if (breakLoop) {\r\n                    return;\r\n                }\r\n\r\n                if (new RegExp('(\\.(' + formatExtensions[formatCandidate] + ')$)|' + base64Heading, 'g').test(resource.resource)) {\r\n\r\n                    if (new RegExp(base64Heading, 'g').test(resource.resource)) {\r\n\r\n                        let matches64 = resource.resource.match(new RegExp('^data:' + formatCandidate + '\\/(' + formatExtensions[formatCandidate] + ')', 'g'));\r\n\r\n                        if (null === matches64) {\r\n                            return;\r\n                        }\r\n\r\n                        matches64 = matches64[0];\r\n\r\n                        output.format = formatCandidate;\r\n                        output.extension = matches64.replace('data:' + formatCandidate + '/', '');\r\n                        output.tag = formatTagNames[formatCandidate];\r\n\r\n                        breakLoop = true;\r\n\r\n                    } else {\r\n\r\n                        let matches = resource.resource.match(new RegExp(formatExtensions[formatCandidate], 'g'));\r\n\r\n                        if (matches) {\r\n\r\n                            output.format = formatCandidate;\r\n                            output.extension = matches[0];\r\n                            output.tag = formatTagNames[formatCandidate];\r\n\r\n                            breakLoop = true;\r\n\r\n                        }\r\n\r\n                    }\r\n\r\n                }\r\n\r\n            });\r\n\r\n            if (isHTMLObject(resource.element)) {\r\n\r\n                let\r\n                    tagName = resource.element.tagName.toLowerCase(),\r\n                    allTags = '';\r\n\r\n                Object.values(formatTagNames).forEach(tags => {\r\n                    allTags += '|' + tags;\r\n                });\r\n\r\n                allTags = allTags.split('|');\r\n\r\n                if (isInArray(tagName, allTags)) {\r\n                    output.tag = tagName;\r\n                    output.exists = true;\r\n                    if (output.format === null) {\r\n                        Object.keys(formatTagNames).forEach(format => {\r\n                            if (formatTagNames[format].includes(output.tag)) {\r\n                                output.format = format;\r\n                            }\r\n                        });\r\n                    }\r\n                }\r\n\r\n            }\r\n\r\n            if (output.tag.includes('|')) {\r\n                output.tag = output.tag.split('|')[0];\r\n            }\r\n\r\n            return output;\r\n\r\n        };\r\n\r\n    let\r\n        privateEventsStorage = {},\r\n        privateCache = [];\r\n\r\n    // TODO: Promise support\r\n    // TODO: think about useful vars in callback args (this class is not public but its vars are returned in .progress() callback)\r\n    class SingleLoader {\r\n\r\n        constructor(options) {\r\n\r\n            this._settings = {\r\n                ...{\r\n                    srcAttr: 'data-src',\r\n                    srcsetAttr: 'data-srcset',\r\n                    playthrough: false,\r\n                    visible: false,\r\n                }, ...options\r\n            };\r\n\r\n            this.srcAttr = '';\r\n            this.srcsetAttr = '';\r\n\r\n            if (!this._settings.srcAttr.startsWith('data-')) {\r\n                this.srcAttr = this._settings.srcAttr;\r\n                this._settings.srcAttr = 'data-' + this._settings.srcAttr;\r\n            } else {\r\n                this.srcAttr = this._settings.srcAttr.replace('data-', '');\r\n            }\r\n\r\n            if (!this._settings.srcsetAttr.startsWith('data-')) {\r\n                this.srcsetAttr = this._settings.srcsetAttr;\r\n                this._settings.srcsetAttr = 'data-' + this._settings.srcsetAttr;\r\n            } else {\r\n                this.srcsetAttr = this._settings.srcsetAttr.replace('data-', '');\r\n            }\r\n\r\n            this.srcAttr = hyphensToCamelCase(this.srcAttr);\r\n            this.srcsetAttr = hyphensToCamelCase(this.srcsetAttr);\r\n\r\n            this._id = null;\r\n            this._idEvent = null;\r\n            this._busy = false;\r\n\r\n            this._element = null;\r\n            this._resource = null;\r\n            this._format = null;\r\n            this._observer = null;\r\n\r\n            this._done = () => { };\r\n            this._success = () => { };\r\n            this._error = () => { };\r\n\r\n            this._callback = (e) => {\r\n\r\n                this._busy = false;\r\n                if( null !== this._observer ){\r\n                    this._observer.unobserve(this._element);\r\n                }\r\n\r\n                const src = this._element.currentSrc || this._element.src;\r\n\r\n                if (!isInArray(src, privateCache)) {\r\n                    privateCache.push(src);\r\n                }\r\n\r\n                let thisArguments = [this._element, e.type, src, this._id];\r\n\r\n                this[e.type !== 'error' ? '_success' : '_error'].apply(this, thisArguments);\r\n                this._done.apply(this, thisArguments);\r\n\r\n            };\r\n\r\n        }\r\n\r\n        set resource(data) {\r\n\r\n            if (typeof data === 'object' && 'id' in data && 'element' in data && 'resource' in data) {\r\n\r\n                this._id = data.id;\r\n                this._element = data.element;\r\n                this._resource = data.resource;\r\n\r\n                let info = decodeResource({ resource: this._resource, element: this._element });\r\n                this._tag = info.tag;\r\n                this._exists = info.exists;\r\n                this._format = info.format;\r\n\r\n                if (!this._exists) {\r\n\r\n                    this._element = document.createElement(this._tag);\r\n                    this._element.dataset[this.srcAttr] = this._resource;\r\n\r\n                }else if( this._settings.visible && 'IntersectionObserver' in window ){\r\n\r\n                    this._observer = new IntersectionObserver((entries, observer) => {\r\n                        entries.forEach(entry => entry.target.intersectionRatio = entry.intersectionRatio);\r\n                    }, {\r\n                        root: null,\r\n                        rootMargin: '0px',\r\n                        threshold: 0.1\r\n                    });\r\n\r\n                    this._observer.observe(this._element);\r\n\r\n                }\r\n\r\n                this._idEvent = this._element[pluginInstance + '_IDEvent'];\r\n                this._busy = this._idEvent !== undefined;\r\n                this._idEvent = this._busy ? this._idEvent : pluginName + '_unique_' + this._element.tagName + '_' + generateInstanceID();\r\n\r\n            }\r\n\r\n        }\r\n\r\n        get resource() {\r\n            return this._resource;\r\n        }\r\n\r\n        /**\r\n         *\r\n         * @returns {boolean} se ha preso in carico il caricamento oppure no per vari motivi (è già caricato, non è nella viewport etc)\r\n         */\r\n        load() {\r\n\r\n            if (isLoaded(this._exists ? this._element : this._resource)) {\r\n\r\n                if (!this._busy) {\r\n                    // TODO: mayabe this should be called in this._callback\r\n                    detachEventListener(this._element, '.' + this._idEvent);\r\n                }\r\n\r\n                this._callback(new CustomEvent(!isBroken(this._exists ? this._element : this._resource) ? 'load' : 'error'));\r\n\r\n                return false;\r\n\r\n            } else if (this._exists && this._settings.visible && !isVisible(this._element)) {\r\n\r\n                return false;\r\n\r\n            } else {\r\n\r\n                if (this._format === 'image') {\r\n\r\n                    attachEventListener(this._element, 'load.' + this._idEvent, this._callback, !this._busy);\r\n                    attachEventListener(this._element, 'error.' + this._idEvent, this._callback, !this._busy);\r\n\r\n                    const picture = this._element.closest('picture');\r\n\r\n                    if (picture && 'HTMLPictureElement' in window) {\r\n\r\n                        delete this._element.dataset[this.srcsetAttr];\r\n                        delete this._element.dataset[this.srcAttr];\r\n\r\n                        picture.querySelectorAll('source[' + this._settings.srcsetAttr + ']').forEach((el) => {\r\n                            el.setAttribute('srcset', el.dataset[this.srcAttr]);\r\n                            delete el.dataset[this.srcAttr];\r\n                        });\r\n\r\n                    } else {\r\n\r\n                        if (this._element.matches('[' + this._settings.srcsetAttr + ']')) {\r\n                            this._element.setAttribute('srcset', this._element.dataset[this.srcsetAttr]);\r\n                            delete this._element.dataset[this.srcsetAttr];\r\n                        }\r\n\r\n                        if (this._element.matches('[' + this._settings.srcAttr + ']')) {\r\n                            this._element.setAttribute('src', this._element.dataset[this.srcAttr]);\r\n                            delete this._element.dataset[this.srcAttr];\r\n                        }\r\n\r\n                    }\r\n\r\n                } else if (this._format === 'video' || this._format === 'audio') {\r\n\r\n                    const\r\n                        isPlaythroughModeNormal = true === this._settings.playthrough,\r\n                        isPlaythroughModeFull = 'full' === this._settings.playthrough,\r\n                        sources = this._element.querySelectorAll('source'),\r\n                        isFullyBuffered = function (media) {\r\n                            return media.buffered.length && Math.round(media.buffered.end(0)) / Math.round(media.seekable.end(0)) === 1;\r\n                        };\r\n\r\n                    let callMediaLoad = false;\r\n\r\n                    if (sources) {\r\n\r\n                        sources.forEach((source) => {\r\n\r\n                            if (source.matches('[' + this._settings.srcAttr + ']')) {\r\n\r\n                                source.setAttribute('src', source.dataset[this.srcAttr]);\r\n                                delete source.dataset[this.srcsetAttr];\r\n\r\n                                callMediaLoad = true;\r\n\r\n                            }\r\n\r\n                            attachEventListener(source, 'error.' + this._idEvent, (e) => {\r\n\r\n                                const sourcesErrorId = pluginName + '_error';\r\n\r\n                                source[pluginInstance + '_' + sourcesErrorId] = true;\r\n\r\n                                if (sources.length === nodelistToArray(sources).filter(thisSource => true === thisSource[pluginInstance + '_' + sourcesErrorId]).length) {\r\n                                    this._callback(e);\r\n                                }\r\n\r\n                            }, !this._busy);\r\n\r\n                        });\r\n\r\n                    } else if (this._element.matches('[' + this._settings.srcAttr + ']')) {\r\n\r\n                        this._element.setAttribute('src', this._element.dataset[this.srcAttr]);\r\n                        delete this._element.dataset[this.srcAttr];\r\n\r\n                        attachEventListener(this._element, 'error.' + this._idEvent, this._callback, !this._busy);\r\n\r\n                        callMediaLoad = true;\r\n\r\n                    }\r\n\r\n                    if (callMediaLoad) {\r\n                        this._element.load();\r\n                    }\r\n\r\n                    attachEventListener(this._element, 'loadedmetadata.' + this._idEvent, () => {\r\n\r\n                        if (!isPlaythroughModeNormal && !isPlaythroughModeFull) {\r\n                            this._callback(new CustomEvent('load'));\r\n                        }\r\n\r\n                        if (isPlaythroughModeFull) {\r\n\r\n                            let onProgressReplacementInterval = setInterval(() => {\r\n\r\n                                let isError = this._element.readyState > 0 && !this._element.duration;\r\n\r\n                                if (isError || isFullyBuffered(this._element)) {\r\n\r\n                                    this._element.currentTime = 0;\r\n\r\n                                    if (!isError && !this._busy && this._element.paused && this._element.matches('[autoplay]')) {\r\n                                        this._element.play();\r\n                                    }\r\n\r\n                                    clearInterval(onProgressReplacementInterval);\r\n\r\n                                    this._callback(new CustomEvent(!isError ? 'load' : 'error'));\r\n\r\n                                } else {\r\n\r\n                                    if (!this._element.paused) {\r\n                                        this._element.pause();\r\n                                    }\r\n\r\n                                    if (!this._busy) {\r\n                                        this._element.currentTime += 2;\r\n                                    }\r\n\r\n                                }\r\n\r\n                            }, 500);\r\n\r\n                            this._element[pluginName + '_' + this._idEvent] = onProgressReplacementInterval;\r\n\r\n                        }\r\n\r\n                    }, !this._busy);\r\n\r\n                    attachEventListener(this._element, 'canplay.' + this._idEvent, () => {\r\n                        if (isPlaythroughModeFull && this._element.currentTime === 0 && !isFullyBuffered(this._element)) {\r\n                            this._element.currentTime++;\r\n                        }\r\n                    }, !this._busy);\r\n\r\n                    attachEventListener(this._element, 'canplaythrough.' + this._idEvent, () => {\r\n                        if (isPlaythroughModeNormal) {\r\n                            this._callback(new CustomEvent('load'));\r\n                        }\r\n                    }, !this._busy);\r\n\r\n                } else {\r\n\r\n                    return false;\r\n\r\n                }\r\n\r\n                if (!this._busy) {\r\n                    this._element[pluginInstance + '_IDEvent'] = this._idEvent;\r\n                }\r\n\r\n            }\r\n\r\n            this._resource = this._element.currentSrc || this._element.src;\r\n\r\n            return !this._busy;\r\n\r\n        }\r\n\r\n        done(callback) {\r\n\r\n            if (typeof callback !== 'function') {\r\n                return;\r\n            }\r\n\r\n            this._done = function (element, status, resource, id) {\r\n                callback.apply(this, [element, status, resource, id]);\r\n            };\r\n\r\n        };\r\n\r\n        abort() {\r\n\r\n            detachEventListener(this._element, '.' + this._idEvent);\r\n\r\n            if (isLoaded(this._exists ? this._element : this._resource)) {\r\n                return;\r\n            }\r\n\r\n            const\r\n                src = this._element.getAttribute('srcset'),\r\n                srcset = this._element.getAttribute('src');\r\n\r\n            if (undefined !== src) {\r\n                this._element.dataset[this.srcAttr] = src;\r\n                this._element.setAttribute(this._settings.srcAttr, src);\r\n                this._element.removeAttribute('src');\r\n                this._element.removeAttribute('srcset');\r\n            }\r\n\r\n            if (undefined !== srcset) {\r\n                this._element.dataset[this.srcsetAttr] = srcset;\r\n                this._element.setAttribute(this._settings.srcsetAttr, srcset);\r\n                this._element.removeAttribute('src');\r\n                this._element.removeAttribute('srcset');\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n\r\n    // TODO: Promise support\r\n    // TODO: private vars\r\n    // TODO: refactory succes/done/progress code...\r\n    class Loader {\r\n\r\n        constructor(options) {\r\n\r\n            this._collection = [];\r\n            this._collectionLoaded = [];\r\n            this._collectionInstances = [];\r\n            this._collectionPending = [];\r\n            this._resourcesLoaded = [];\r\n\r\n            this._settings = {\r\n                ...{\r\n                    srcAttr: 'data-src',\r\n                    srcsetAttr: 'data-srcset',\r\n                    playthrough: false,\r\n                    visible: false,\r\n                    backgrounds: false,\r\n                    attributes: []\r\n                }, ...options\r\n            };\r\n\r\n            this.srcAttr = '';\r\n            this.srcsetAttr = '';\r\n            if (!this._settings.srcAttr.startsWith('data-')) {\r\n                this.srcAttr = this._settings.srcAttr;\r\n                this._settings.srcAttr = 'data-' + this._settings.srcAttr;\r\n            } else {\r\n                this.srcAttr = this._settings.srcAttr.replace('data-', '');\r\n            }\r\n            if (!this._settings.srcsetAttr.startsWith('data-')) {\r\n                this.srcsetAttr = this._settings.srcsetAttr;\r\n                this._settings.srcsetAttr = 'data-' + this._settings.srcsetAttr;\r\n            } else {\r\n                this.srcsetAttr = this._settings.srcsetAttr.replace('data-', '');\r\n            }\r\n\r\n            if (typeof this._settings.attributes === 'string') {\r\n                this._settings.attributes = this._settings.attributes.split(this._settings.attributes.contains(',') ? ',' : ' ');\r\n            }\r\n            if (!Array.isArray(this._settings.attributes)) {\r\n                this._settings.attributes = [];\r\n            }\r\n\r\n            this.srcAttr = hyphensToCamelCase(this.srcAttr);\r\n            this.srcsetAttr = hyphensToCamelCase(this.srcsetAttr);\r\n\r\n            this.percentage = 0;\r\n\r\n            this._done = () => { };\r\n            this._progress = () => { };\r\n            this._success = () => { };\r\n            this._error = () => { };\r\n            this._loop = this.load;\r\n\r\n            this._abort = false;\r\n            this._loaded = 0;\r\n            this._complete = false;\r\n            this._busy = false;\r\n\r\n        }\r\n\r\n        set collection(collection) {\r\n\r\n            if (!Array.isArray(collection)) {\r\n                collection = [];\r\n            }\r\n\r\n            collection.forEach(item => {\r\n\r\n                let element = {\r\n                    resource: '',\r\n                    element: null,\r\n                    id: generateInstanceID()\r\n                };\r\n\r\n                if (typeof item === 'string') {\r\n                    element.resource = item;\r\n                } else if (typeof item === 'object' && 'resource' in item) {\r\n                    element = { ...element, ...item };\r\n                } else {\r\n                    return;\r\n                }\r\n\r\n                this._collection.push(element);\r\n\r\n            });\r\n\r\n        }\r\n\r\n        get collection() {\r\n            return this._collection;\r\n        }\r\n\r\n        collect(element) {\r\n\r\n            const\r\n                targets = 'img, video, audio',\r\n                targetsExtended = targets + ', picture, source',\r\n                targetsFilter = '[' + this._settings.srcAttr + '], [' + this._settings.srcsetAttr + ']';\r\n\r\n            let\r\n                collection = [],\r\n                targetsTags = nodelistToArray(element.querySelectorAll(targets));\r\n\r\n            if (element.matches(targetsExtended)) {\r\n                targetsTags.push(element);\r\n            }\r\n\r\n            targetsTags = targetsTags.filter((target) => {\r\n                let children = nodelistToArray(target.children);\r\n                children = children.filter(x => x.matches(targetsExtended));\r\n                children = children.filter(x => x.matches(targetsFilter));\r\n                return target.matches(targetsFilter) || children.length;\r\n            });\r\n\r\n            targetsTags.forEach((target) => {\r\n                let targetSource = target;\r\n                if (!targetSource.matches(targetsFilter)) {\r\n                    targetSource = targetSource.querySelectorAll(targetsFilter);\r\n                    targetSource = [...targetSource][0];\r\n                }\r\n                collection.push({\r\n                    element: target,\r\n                    resource: targetSource.getAttribute(this._settings.srcAttr) || targetSource.getAttribute(this._settings.srcsetAttr)\r\n                });\r\n            });\r\n\r\n            if (true === this._settings.backgrounds) {\r\n                let targetsBg = nodelistToArray(element.querySelectorAll('*'));\r\n                targetsBg.push(element);\r\n                targetsBg = targetsBg.filter(target => !target.matches(targetsExtended));\r\n                targetsBg = targetsBg.filter(target => getComputedStyle(target).backgroundImage !== 'none');\r\n                targetsBg.forEach((target) => {\r\n\r\n                    const url = getComputedStyle(target).backgroundImage.match(/\\((.*?)\\)/);\r\n\r\n                    if (null === url || url.length < 2) {\r\n                        return true;\r\n                    }\r\n\r\n                    collection.push({\r\n                        element: target,\r\n                        resource: url[1].replace(/('|\")/g, '')\r\n                    });\r\n\r\n                });\r\n            }\r\n\r\n            if (this._settings.attributes.length) {\r\n                for (const attr in this._settings.attributes) {\r\n                    if (this._settings.attributes.hasOwnProperty(attr)) {\r\n\r\n                        nodelistToArray(element.querySelectorAll('[' + attr + ']:not(' + targetsExtended + ')')).forEach((target) => {\r\n                            collection.push({\r\n                                element: target,\r\n                                resource: target.getAttribute(attr)\r\n                            });\r\n                        });\r\n\r\n                        if (element.matches('[' + attr + ']') && !element.matches(targetsExtended)) {\r\n                            collection.push({\r\n                                element: element,\r\n                                resource: element.getAttribute(attr)\r\n                            });\r\n                        }\r\n\r\n                    }\r\n                }\r\n            }\r\n\r\n            this.collection = collection;\r\n\r\n        }\r\n\r\n        load() {\r\n\r\n            // resets pending elements (sequential opt helper array) every time we loop\r\n            this._collectionPending = [];\r\n\r\n            const sequentialMode = true === this._settings.sequential;\r\n\r\n            for (let i = 0; i < this._collection.length; i++) {\r\n\r\n                if (this._abort) {\r\n                    break;\r\n                }\r\n\r\n                let thisLoadId = this._collection[i].id,\r\n                    thisLoadIndex = this._collectionInstances.findIndex(x => x.id === thisLoadId),\r\n                    thisLoadInstance = new SingleLoader(this._settings);\r\n\r\n                if (thisLoadIndex === -1) {\r\n                    this._collectionInstances.push({ id: thisLoadId, instance: thisLoadInstance });\r\n                    thisLoadIndex = this._collectionInstances.findIndex(x => x.id === thisLoadId);\r\n                } else {\r\n                    this._collectionInstances[thisLoadIndex].instance = thisLoadInstance;\r\n                }\r\n\r\n                thisLoadInstance.resource = this._collection[i];\r\n\r\n                thisLoadInstance.done((element, status, resource, id) => {\r\n\r\n                    if (this._complete || this._abort) {\r\n                        return;\r\n                    }\r\n\r\n                    const aProgress = !isInArray(id, this._collectionLoaded);\r\n\r\n                    if (aProgress) {\r\n\r\n                        this._collectionLoaded.push(id);\r\n                        this._busy = false;\r\n\r\n                        this._loaded++;\r\n                        this.percentage = this._loaded / this._collection.length * 100;\r\n                        this.percentage = parseFloat(this.percentage.toFixed(4));\r\n\r\n                        const thisResource = { resource: resource, status: status, element: element };\r\n                        this._resourcesLoaded.push(thisResource);\r\n                        this._progress.call(this, thisResource);\r\n                        this[status !== 'error' ? '_success' : '_error'].call(this, thisResource);\r\n                        // TODO: dispatch event on element maybe?\r\n                        // element.dispatchEvent(new CustomEvent(pluginPrefix + capitalize(status) + '.' + pluginPrefix));\r\n\r\n                    }\r\n\r\n                    if (this._loaded === this._collection.length) {\r\n\r\n                        this._done.call(this, this._resourcesLoaded);\r\n\r\n                        this._complete = true;\r\n\r\n                    } else if (aProgress && sequentialMode && this._collectionPending.length) {\r\n\r\n                        this._collectionPending = this._collectionPending.filter(x => x.id !== id);\r\n\r\n                        if (this._collectionPending.length) {\r\n                            this._busy = this._collectionPending[0].instance.load();\r\n                        }\r\n\r\n                    }\r\n\r\n                });\r\n\r\n                if (!sequentialMode || (sequentialMode && !this._busy)) {\r\n                    this._busy = thisLoadInstance.load();\r\n\r\n                } else if (sequentialMode && this._busy && (!this._settings.visible || !thisLoadInstance._exists || (this._settings.visible && thisLoadInstance._exists && isVisible(thisLoadInstance._element)))) {\r\n                    this._collectionPending.push({ id: thisLoadId, instance: thisLoadInstance });\r\n\r\n                }\r\n\r\n\r\n            }\r\n\r\n        }\r\n\r\n        done(callback) {\r\n\r\n            if (typeof callback !== 'function') {\r\n                return;\r\n            }\r\n\r\n            const _func = function (resources) {\r\n                callback.call(this, resources);\r\n            };\r\n\r\n            if (this._collection.length) {\r\n                this._done = _func;\r\n            } else {\r\n                _func();\r\n            }\r\n\r\n        };\r\n\r\n        progress(callback) {\r\n\r\n            if (typeof callback !== 'function')\r\n                return;\r\n\r\n            const _func = function (resource) {\r\n                callback.call(this, resource);\r\n            };\r\n\r\n            if (this._collection.length) {\r\n                this._progress = _func;\r\n            }\r\n\r\n        };\r\n\r\n        success(callback) {\r\n\r\n            if (typeof callback !== 'function') {\r\n                return;\r\n            }\r\n\r\n            const _func = function (resource) {\r\n                callback.call(this, resource);\r\n            };\r\n\r\n            if (this._collection.length) {\r\n                this._success = _func;\r\n            }\r\n\r\n        };\r\n\r\n        error(callback) {\r\n\r\n            if (typeof callback !== 'function') {\r\n                return;\r\n            }\r\n\r\n            const _func = function (resource) {\r\n                callback.call(this, resource);\r\n            };\r\n\r\n            if (this._collection.length) {\r\n                this._error = _func;\r\n            }\r\n\r\n        };\r\n\r\n        abort() {\r\n\r\n            for (const key in this._collectionInstances) {\r\n                this._collectionInstances[key].instance.abort();\r\n            }\r\n\r\n            if (this._collection.length) {\r\n                this._abort = true;\r\n            }\r\n\r\n        };\r\n\r\n    }\r\n\r\n    // public interface\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n    // requirejs\r\n    if (typeof define === 'function' && define.amd) {\r\n        define(capitalize(pluginName), Loader);\r\n        // nodejs\r\n    } else if ('object' === typeof exports) {\r\n        module.exports[capitalize(pluginName)] = Loader;\r\n        // vanilla\r\n    } else {\r\n        window[capitalize(pluginName)] = Loader;\r\n    }\r\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n\r\n    // jQuery interface\r\n    // - - - - - - - - - - - - - - - - - - - -\r\n    if (!$) {\r\n        return undefined;\r\n    }\r\n\r\n    $[capitalize(pluginName)] = Loader;\r\n\r\n    const\r\n        $document = $(document),\r\n        $window = $(window),\r\n        // thanks https://gist.github.com/beaucharman/e46b8e4d03ef30480d7f4db5a78498ca\r\n        throttle = (callback, wait, context = this) => {\r\n            let timeout = null,\r\n                callbackArgs = null\r\n            const later = () => {\r\n                callback.apply(context, callbackArgs)\r\n                timeout = null\r\n            }\r\n            return function () {\r\n                if (!timeout) {\r\n                    callbackArgs = arguments\r\n                    timeout = setTimeout(later, wait)\r\n                }\r\n            }\r\n        };\r\n\r\n    let methodCollection = [];\r\n\r\n    $.fn[pluginMethod] = function (options) {\r\n\r\n        let originalUserOptions = options;\r\n\r\n        if (typeof options !== 'object') {\r\n            options = {};\r\n        }\r\n\r\n        let settings = {\r\n            ...{\r\n\r\n                srcAttr: 'data-src',\r\n                srcsetAttr: 'data-srcset',\r\n\r\n                visible: false,\r\n\r\n                sequential: false,\r\n\r\n                backgrounds: false,\r\n                extraAttrs: [],\r\n\r\n                playthrough: false,\r\n\r\n                early: false,\r\n                earlyTimeout: 0,\r\n\r\n                onProgress: () => { },\r\n                onLoad: () => { },\r\n                onError: () => { },\r\n\r\n                onComplete: () => { },\r\n\r\n            }, ...options\r\n        };\r\n\r\n        let callback = settings.onComplete;\r\n        if ($.isFunction(originalUserOptions)) {\r\n            callback = originalUserOptions;\r\n        }\r\n\r\n        return this.each(function (i) {\r\n\r\n            // TODO: mutation observer when new children are appended\r\n\r\n            const\r\n                $element = $(this),\r\n                uniqueMethodPluginName = generateInstanceID() + i,\r\n                thisLoadInstance = new Loader(settings);\r\n\r\n            thisLoadInstance.collect(this);\r\n\r\n            methodCollection.push({\r\n                id: uniqueMethodPluginName,\r\n                instance: thisLoadInstance,\r\n                element: this,\r\n                timeout: null\r\n            });\r\n\r\n            thisLoadInstance.progress((resource) => {\r\n\r\n                $(resource.element).trigger(pluginPrefix + capitalize(resource.status) + '.' + pluginPrefix, [resource.element, resource.resource]);\r\n                $element.trigger(pluginPrefix + 'Progress.' + pluginPrefix, [this, resource]);\r\n\r\n                const thisArguments = [thisLoadInstance, resource];\r\n\r\n                if (typeof settings.onProgress === 'function') {\r\n                    settings.onProgress.apply(this, thisArguments);\r\n                }\r\n\r\n                let eventName = capitalize(resource.status);\r\n                if (typeof settings['on' + eventName] === 'function') {\r\n                    settings['on' + eventName].apply(this, thisArguments);\r\n                }\r\n\r\n            });\r\n\r\n            thisLoadInstance.done(resources => {\r\n\r\n                $element.trigger(pluginPrefix + 'Complete.' + pluginPrefix, [this, resources]);\r\n                callback.apply(this, [thisLoadInstance, resources]);\r\n\r\n                if (settings.visible) {\r\n                    /*if ('IntersectionObserver' in window) {\r\n                        thisLoadInstance.collection.forEach(item => item.element.intersectionObserver.unobserve(item.element));\r\n\r\n                    } else {*/\r\n                        $window.off('scroll.' + uniqueMethodPluginName);\r\n\r\n                    //}\r\n                }\r\n\r\n                // refresh other method calls for same el (omitting this one)\r\n                methodCollection = methodCollection.filter(x => x.id !== uniqueMethodPluginName);\r\n                methodCollection.forEach(thisMethodCollection => {\r\n                    if ($element.is(thisMethodCollection.element)) {\r\n                        thisMethodCollection.instance.load();\r\n                    }\r\n                });\r\n\r\n            });\r\n\r\n            thisLoadInstance.load();\r\n\r\n            if (settings.visible) {\r\n               /* if ('IntersectionObserver' in window) {\r\n\r\n                    thisLoadInstance.collection.forEach(item => {\r\n\r\n                        item.element.intersectionObserver = new IntersectionObserver((entries, observer) => {\r\n                            entries.forEach(entry => {\r\n                                if( entry.intersectionRatio > 0 ){\r\n                                    thisLoadInstance.load();\r\n                                }\r\n                            });\r\n                        }, {\r\n                            root: null,\r\n                            rootMargin: '0px',\r\n                            threshold: 0.0\r\n                        });\r\n\r\n                        item.element.intersectionObserver.observe(item.element);\r\n\r\n                    });\r\n\r\n                } else {*/\r\n\r\n                    $window.on('scroll.' + uniqueMethodPluginName, throttle(() => thisLoadInstance.load(), 250));\r\n\r\n               //}\r\n            }\r\n\r\n            if (true === settings.early) {\r\n\r\n                let breakLoop = false;\r\n\r\n                methodCollection.forEach(thisMethodCollection => {\r\n\r\n                    if (breakLoop) {\r\n                        return;\r\n                    }\r\n\r\n                    if (methodCollection[key].id === uniqueMethodPluginName) {\r\n\r\n                        clearTimeout(thisMethodCollection.timeout);\r\n\r\n                        let timeout = parseInt(settings.earlyTimeout);\r\n\r\n                        thisMethodCollection.timeout = setTimeout(() => {\r\n\r\n                            // TODO: appropriate method to set/update settings?\r\n                            thisMethodCollection.instance._settings.visible = false;\r\n                            thisMethodCollection.instance._settings.sequential = true;\r\n\r\n                            thisMethodCollection.instance.load();\r\n\r\n                        }, !isNaN(timeout) && isFinite(timeout) ? timeout : 0);\r\n\r\n                        breakLoop = true;\r\n\r\n                    }\r\n\r\n                });\r\n\r\n            }\r\n\r\n        });\r\n\r\n    };\r\n\r\n})(window, document, jQuery);"],"file":"nite.loader.min.js"}