{"version":3,"sources":["nite.loader.js"],"names":["_createClass","defineProperties","target","props","i","length","descriptor","enumerable","configurable","writable","Object","defineProperty","key","Constructor","protoProps","staticProps","prototype","_typeof","Symbol","iterator","obj","constructor","_extends","assign","arguments","source","hasOwnProperty","call","_classCallCheck","instance","TypeError","_toConsumableArray","arr","Array","isArray","arr2","from","_polyfill","generateInstanceID","Math","floor","random","pluginInstance","CustomEvent","window","event","params","bubbles","cancelable","detail","undefined","evt","document","createEvent","initCustomEvent","Event","supportedExtensions","image","audio","video","supportedTags","IntersectionObserverSupported","pictureElementSupported","stringContains","heystack","needle","String","includes","indexOf","stringStartsWith","startsWith","substr","arrayFindIndex","filter","findIndex","index","detachEventListener","element","events","_key","privateEventsStorage","eventNameWithNamespace","replace","type","split","join","removeEventListener","handler","attachEventListener","once","count","_handler","this","addEventListener","hyphensToCamelCase","string","g","toUpperCase","capitalize","charAt","slice","nodelistToArray","nodelist","concat","isInArray","isVisible","intersectionRatio","getComputedStyle","bodyEl","getElementsByTagName","winWidth","innerWidth","documnt","documentElement","clientWidth","winHeight","innerHeight","clientHeight","rect","getBoundingClientRect","right","bottom","left","top","isHTMLElement","HTMLElement","e","nodeType","style","ownerDocument","isLoaded","privateCache","currentSrc","complete","readyState","isFullyBuffered","media","buffered","round","end","seekable","SingleLoader","options","_this","_settings","srcAttr","srcsetAttr","playthrough","visible","Error","_id","_idEvent","_busy","_element","_resource","_format","_observer","_done","_success","_error","_callback","unobserve","src","push","thisArguments","apply","value","_this2","_exists","_consistent","naturalWidth","videoWidth","_originalElement","picture","closest","dataset","querySelectorAll","forEach","el","setAttribute","matches","isStandardPlaythrough","isFullPlaythrough","sources","callMediaLoad","thisSource","load","onProgressReplacementInterval","setInterval","isError","duration","currentTime","paused","play","clearInterval","pause","pluginName","callback","status","resource","id","getAttribute","srcset","removeAttribute","set","data","info","output","format","extension","tag","consistent","formatCandidate","RegExp","test","matches64","match","tagName","toLowerCase","allTags","values","tags","decodeResource","_tag","createElement","IntersectionObserver","entries","observer","entry","root","rootMargin","threshold","observe","get","Loader","_collection","_collectionLoaded","_collectionInstances","_collectionPending","_resourcesLoaded","backgrounds","percentage","_progress","_loop","_abort","_loaded","_complete","_this3","sequentialMode","sequential","thisLoadId","thisLoadIndex","x","thisLoadInstance","done","aProgress","parseFloat","toFixed","thisResource","resources","thisInstance","abort","collection","_this4","collectedResources","findResources","err","item","settings","_key2","body","targetsExtended","targets","targetsFilter","targetsTags","children","targetSource","targetsBg","backgroundImage","url","define","amd","pluginMethod","exports","module","$","jQuery","$window","methodCollection","fn","originalUserOptions","early","earlyTimeout","onProgress","onLoad","onError","onComplete","isFunction","each","_this5","$element","uniqueMethodPluginName","timeout","progress","trigger","pluginPrefix","eventName","off","thisMethodCollection","is","on","wait","context","callbackArgs","later","setTimeout","throttle","breakLoop","clearTimeout","parseInt","isNaN","isFinite"],"mappings":"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","sourcesContent":["/*! Nite Loader | Daniele Fioroni | dfioroni91@gmail.com */\r\n(() => {\r\n\t'use strict';\r\n\r\n\t/**\r\n\t * @returns {string}\r\n\t */\r\n\tconst generateInstanceID = () => {\r\n\t\treturn Math.floor(Math.random() * (9999 - 1000)) + 1000;\r\n\t};\r\n\r\n\tconst pluginPrefix = 'nite';\r\n\tconst pluginMethod = pluginPrefix + 'Load';\r\n\tconst pluginName = pluginMethod + 'er';\r\n\tconst pluginInstance = generateInstanceID();\r\n\tconst eventNamespaceParserSeparator = '__namespace__';\r\n\r\n\tconst CustomEvent =\r\n\t\twindow.CustomEvent ||\r\n\t\t(() => {\r\n\t\t\tconst _polyfill = (event, params) => {\r\n\t\t\t\tparams = params || { bubbles: false, cancelable: false, detail: undefined };\r\n\t\t\t\tconst evt = document.createEvent('CustomEvent');\r\n\t\t\t\tevt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\r\n\t\t\t\treturn evt;\r\n\t\t\t};\r\n\t\t\t_polyfill.prototype = window.Event.prototype;\r\n\t\t\treturn _polyfill;\r\n\t\t})();\r\n\r\n\tconst supportedExtensions = {\r\n\t\timage: 'jp[e]?g|jpe|jif|jfif|jfi|gif|png|tif[f]?|bmp|dib|webp|ico|cur|svg',\r\n\t\taudio: 'mp3|ogg|oga|spx|ogg|wav',\r\n\t\tvideo: 'mp4|ogv|webm'\r\n\t};\r\n\tconst supportedTags = {\r\n\t\timage: 'img|picture|source',\r\n\t\taudio: 'audio|source',\r\n\t\tvideo: 'video|source'\r\n\t};\r\n\r\n\tconst IntersectionObserverSupported = 'IntersectionObserver' in window;\r\n\tconst pictureElementSupported = 'HTMLPictureElement' in window;\r\n\r\n\t/**\r\n\t * @param {string} heystack\r\n\t * @param {string} needle\r\n\t * @returns {boolean}\r\n\t */\r\n\tconst stringContains = (heystack, needle) => {\r\n\t\treturn String.prototype.includes ? heystack.includes(needle) : heystack.indexOf(needle, 0) !== -1;\r\n\t};\r\n\r\n\t/**\r\n\t * @param {string} heystack\r\n\t * @param {string} needle\r\n\t * @returns {boolean}\r\n\t */\r\n\tconst stringStartsWith = (heystack, needle) => {\r\n\t\treturn String.prototype.startsWith\r\n\t\t\t? heystack.startsWith(needle)\r\n\t\t\t: heystack.substr(0, needle.length) === needle;\r\n\t};\r\n\r\n\t/**\r\n\t * @param {Array} heystack\r\n\t * @param {Function} filter\r\n\t * @returns {number}\r\n\t */\r\n\tconst arrayFindIndex = (heystack, filter) => {\r\n\t\treturn Array.prototype.findIndex\r\n\t\t\t? heystack.findIndex(filter)\r\n\t\t\t: (() => {\r\n\t\t\t\t\tlet length = heystack.length,\r\n\t\t\t\t\t\tindex = -1;\r\n\t\t\t\t\twhile (++index < length) {\r\n\t\t\t\t\t\tif (filter(heystack[index], index, heystack)) {\r\n\t\t\t\t\t\t\treturn index;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn -1;\r\n\t\t\t  })();\r\n\t};\r\n\r\n\t/**\r\n\t * @param {HTMLElement} element\r\n\t * @param {string} events\r\n\t * @returns {undefined}\r\n\t */\r\n\tconst detachEventListener = (element, events) => {\r\n\t\tif (!element || typeof events !== 'string') {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (stringStartsWith(events, '.')) {\r\n\t\t\tfor (let key in privateEventsStorage) {\r\n\t\t\t\tconst eventNameWithNamespace = key.replace(eventNamespaceParserSeparator, '.');\r\n\t\t\t\tif (\r\n\t\t\t\t\tstringContains(eventNameWithNamespace, events) &&\r\n\t\t\t\t\tprivateEventsStorage[key].element === element\r\n\t\t\t\t) {\r\n\t\t\t\t\tdetachEventListener(element, eventNameWithNamespace);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tevents = events.split('.');\r\n\r\n\t\t\tconst type = events[0],\r\n\t\t\t\tnamespace = events[1];\r\n\r\n\t\t\tif (namespace) {\r\n\t\t\t\tevents = events.join(eventNamespaceParserSeparator);\r\n\t\t\t}\r\n\r\n\t\t\tif (events in privateEventsStorage) {\r\n\t\t\t\telement.removeEventListener(type, privateEventsStorage[events].handler);\r\n\t\t\t\tdelete privateEventsStorage[events];\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * @param {HTMLElement} element\r\n\t * @param {string} events\r\n\t * @param {Function} handler\r\n\t * @param {boolean} once\r\n\t * @returns {undefined}\r\n\t */\r\n\tconst attachEventListener = (element, events, handler, once) => {\r\n\t\tif (!element || typeof events !== 'string' || typeof handler !== 'function') {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tevents = events.split('.');\r\n\r\n\t\tconst type = events[0];\r\n\t\tconst namespace = events[1];\r\n\r\n\t\tif (namespace) {\r\n\t\t\tevents = events.join(eventNamespaceParserSeparator);\r\n\t\t}\r\n\r\n\t\tprivateEventsStorage[events] = { element: element, count: 0, once: false };\r\n\r\n\t\tif (true === once) {\r\n\t\t\tlet _handler = handler;\r\n\t\t\thandler = function(event) {\r\n\t\t\t\tif (events in privateEventsStorage) {\r\n\t\t\t\t\tprivateEventsStorage[events].count++;\r\n\t\t\t\t\tif (privateEventsStorage[events].once && privateEventsStorage[events].count > 1) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t_handler.call(this, event);\r\n\t\t\t\t}\r\n\t\t\t\tdetachEventListener(element, events);\r\n\t\t\t};\r\n\t\t} else {\r\n\t\t\tonce = false;\r\n\t\t}\r\n\r\n\t\tprivateEventsStorage[events] = {\r\n\t\t\t...privateEventsStorage[events],\r\n\t\t\t...{ handler: handler, once: once }\r\n\t\t};\r\n\r\n\t\telement.addEventListener(type, privateEventsStorage[events].handler, { once: once });\r\n\t};\r\n\r\n\t/**\r\n\t * @param {string} string\r\n\t * @returns {string}\r\n\t */\r\n\tconst hyphensToCamelCase = string => {\r\n\t\treturn string.replace(/-([a-z])/g, g => g[1].toUpperCase());\r\n\t};\r\n\r\n\t/**\r\n\t * @param {string} string\r\n\t * @returns {string}\r\n\t */\r\n\tconst capitalize = string => {\r\n\t\treturn string.charAt(0).toUpperCase() + string.slice(1);\r\n\t};\r\n\r\n\t/**\r\n\t * @param {NodeList} nodelist\r\n\t * @returns {Array}\r\n\t */\r\n\tconst nodelistToArray = nodelist => {\r\n\t\treturn [...nodelist];\r\n\t};\r\n\r\n\t/**\r\n\t * @param {String|number} needle\r\n\t * @param {Array} heystack\r\n\t * @returns {boolean}\r\n\t */\r\n\tconst isInArray = (needle, heystack) => {\r\n\t\treturn heystack.indexOf(needle) > -1;\r\n\t};\r\n\r\n\t/**\r\n\t * @param {HTMLElement} element\r\n\t * @returns {boolean}\r\n\t */\r\n\tconst isVisible = element => {\r\n\t\tif (IntersectionObserverSupported && 'intersectionRatio' in element) {\r\n\t\t\treturn element.intersectionRatio > 0;\r\n\t\t}\r\n\r\n\t\tif (window.getComputedStyle(element, 'display') === 'none') {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tconst bodyEl = document.getElementsByTagName('body')[0];\r\n\t\tconst winWidth = window.innerWidth || documnt.documentElement.clientWidth || bodyEl.clientWidth;\r\n\t\tconst winHeight = window.innerHeight || documnt.documentElement.clientHeight || bodyEl.clientHeight;\r\n\t\tconst rect = element.getBoundingClientRect();\r\n\r\n\t\treturn !(rect.right < 0 || rect.bottom < 0 || rect.left > winWidth || rect.top > winHeight);\r\n\t};\r\n\r\n\t/**\r\n\t * @param {HTMLElement} element\r\n\t * @returns {boolean}\r\n\t */\r\n\tconst isHTMLElement = element => {\r\n\t\tif (typeof element !== 'object') {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\ttry {\r\n\t\t\treturn element instanceof HTMLElement;\r\n\t\t} catch (e) {\r\n\t\t\treturn (\r\n\t\t\t\telement.nodeType === 1 &&\r\n\t\t\t\ttypeof element.style === 'object' &&\r\n\t\t\t\ttypeof element.ownerDocument === 'object'\r\n\t\t\t);\r\n\t\t}\r\n\t};\r\n\r\n\t/**\r\n\t * @param {(string|HTMLVideoElement|HTMLAudioElement|HTMLImageElement)} source\r\n\t * @returns {boolean}\r\n\t */\r\n\tconst isLoaded = source => {\r\n\t\treturn (\r\n\t\t\t(typeof source === 'string' && isInArray(source, privateCache)) ||\r\n\t\t\t(isHTMLElement(source) &&\r\n\t\t\t\t('currentSrc' in source && source.currentSrc.length > 0) &&\r\n\t\t\t\t(('complete' in source && source.complete) ||\r\n\t\t\t\t\t('readyState' in source && source.readyState >= 2)))\r\n\t\t);\r\n\t};\r\n\r\n\t/**\r\n\t * @param {(HTMLVideoElement|HTMLAudioElement)} source\r\n\t * @returns {boolean}\r\n\t */\r\n\tconst isFullyBuffered = media => {\r\n\t\treturn (\r\n\t\t\tmedia.buffered.length &&\r\n\t\t\tMath.round(media.buffered.end(0)) / Math.round(media.seekable.end(0)) === 1\r\n\t\t);\r\n\t};\r\n\r\n\t/**\r\n\t * @param {(string|HTMLElement)} source\r\n\t * @returns {boolean}\r\n\t */\r\n\tconst isBroken = source => {\r\n\t\treturn (\r\n\t\t\tisLoaded(source) &&\r\n\t\t\t((isHTMLElement(source) &&\r\n\t\t\t\t(('naturalWidth' in source && Math.floor(source.naturalWidth) === 0) ||\r\n\t\t\t\t\t('videoWidth' in source && source.videoWidth === 0))) ||\r\n\t\t\t\ttypeof source === 'string')\r\n\t\t);\r\n\t};\r\n\r\n\t/**\r\n\t * @param {Object} resource\r\n\t * @returns {Object}\r\n\t */\r\n\tconst decodeResource = resource => {\r\n\t\tlet output = { format: null, extension: null, tag: null, consistent: false };\r\n\r\n\t\tresource.resource = resource.resource.split('?')[0];\r\n\t\tresource.resource = resource.resource.split('#')[0];\r\n\t\tfor (let formatCandidate in supportedExtensions) {\r\n\t\t\tconst base64Heading = ';base64,';\r\n\r\n\t\t\tif (\r\n\t\t\t\tnew RegExp('(.(' + supportedExtensions[formatCandidate] + ')$)|' + base64Heading, 'g').test(\r\n\t\t\t\t\tresource.resource\r\n\t\t\t\t)\r\n\t\t\t) {\r\n\t\t\t\tif (new RegExp(base64Heading, 'g').test(resource.resource)) {\r\n\t\t\t\t\tlet matches64 = resource.resource.match(\r\n\t\t\t\t\t\tnew RegExp(\r\n\t\t\t\t\t\t\t'^data:' + formatCandidate + '/(' + supportedExtensions[formatCandidate] + ')',\r\n\t\t\t\t\t\t\t'g'\r\n\t\t\t\t\t\t)\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tif (null === matches64) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tmatches64 = matches64[0];\r\n\r\n\t\t\t\t\toutput.format = formatCandidate;\r\n\t\t\t\t\toutput.extension = matches64.replace('data:' + formatCandidate + '/', '');\r\n\t\t\t\t\toutput.tag = supportedTags[formatCandidate];\r\n\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet matches = resource.resource.match(\r\n\t\t\t\t\t\tnew RegExp(supportedExtensions[formatCandidate], 'g')\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tif (matches) {\r\n\t\t\t\t\t\toutput.format = formatCandidate;\r\n\t\t\t\t\t\toutput.extension = matches[0];\r\n\t\t\t\t\t\toutput.tag = supportedTags[formatCandidate];\r\n\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (isHTMLElement(resource.element)) {\r\n\t\t\tlet tagName = resource.element.tagName.toLowerCase();\r\n\t\t\tlet allTags = '';\r\n\r\n\t\t\tObject.values(supportedTags).forEach(tags => {\r\n\t\t\t\tallTags += '|' + tags;\r\n\t\t\t});\r\n\r\n\t\t\tallTags = allTags.split('|');\r\n\r\n\t\t\tif (isInArray(tagName, allTags)) {\r\n\t\t\t\toutput.tag = tagName;\r\n\t\t\t\toutput.consistent = true;\r\n\t\t\t\tif (output.format === null) {\r\n\t\t\t\t\tfor (let format in supportedTags) {\r\n\t\t\t\t\t\tif (stringContains(supportedTags[format], output.tag)) {\r\n\t\t\t\t\t\t\toutput.format = format;\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (stringContains(output.tag, '|')) {\r\n\t\t\toutput.tag = output.tag.split('|')[0];\r\n\t\t}\r\n\r\n\t\treturn output;\r\n\t};\r\n\r\n\tlet privateEventsStorage = {};\r\n\r\n\tlet privateCache = [];\r\n\r\n\t// TODO: Promise support\r\n\t// TODO: think about useful vars in callback args (this class is not public but its vars are returned in .progress() callback)\r\n\t/** TODO: description of the MyClass constructor function.\r\n\t * @class\r\n\t * @classdesc TODO: description of the SingleLoader class.\r\n\t */\r\n\tclass SingleLoader {\r\n\t\t/**\r\n\t\t * @param {Object} [options={ srcAttr: 'data-src', srcsetAttr: 'data-srcset', playthrough: false, visible: false }]\r\n\t\t */\r\n\t\tconstructor(options) {\r\n\t\t\tthis._settings = {\r\n\t\t\t\t...{\r\n\t\t\t\t\tsrcAttr: 'data-src',\r\n\t\t\t\t\tsrcsetAttr: 'data-srcset',\r\n\t\t\t\t\tplaythrough: false,\r\n\t\t\t\t\tvisible: false\r\n\t\t\t\t},\r\n\t\t\t\t...options\r\n\t\t\t};\r\n\r\n\t\t\tif (\r\n\t\t\t\t!stringStartsWith(this._settings.srcAttr, 'data-') ||\r\n\t\t\t\t!stringStartsWith(this._settings.srcsetAttr, 'data-')\r\n\t\t\t) {\r\n\t\t\t\tthrow new Error(\r\n\t\t\t\t\t'Wrong arguments format: srcAttr and srcsetAttr parameters must be dataset values.'\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tthis.srcAttr = hyphensToCamelCase(this._settings.srcAttr.replace('data-', ''));\r\n\t\t\tthis.srcsetAttr = hyphensToCamelCase(this._settings.srcsetAttr.replace('data-', ''));\r\n\r\n\t\t\tthis._id = null;\r\n\t\t\tthis._idEvent = null;\r\n\t\t\tthis._busy = false;\r\n\r\n\t\t\tthis._element = null;\r\n\t\t\tthis._resource = null;\r\n\t\t\tthis._format = null;\r\n\t\t\tthis._observer = null;\r\n\r\n\t\t\tthis._done = () => {};\r\n\t\t\tthis._success = () => {};\r\n\t\t\tthis._error = () => {};\r\n\r\n\t\t\tthis._callback = e => {\r\n\t\t\t\tthis._busy = false;\r\n\t\t\t\tif (null !== this._observer) {\r\n\t\t\t\t\tthis._observer.unobserve(this._element);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tconst src = this._element.currentSrc || this._element.src;\r\n\r\n\t\t\t\tif (!isInArray(src, privateCache)) {\r\n\t\t\t\t\tprivateCache.push(src);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet thisArguments = [this._element, e.type, src, this._id];\r\n\r\n\t\t\t\tthis[e.type !== 'error' ? '_success' : '_error'].apply(this, thisArguments);\r\n\t\t\t\tthis._done.apply(this, thisArguments);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @param {Object} data\r\n\t\t */\r\n\t\tset resource(data) {\r\n\t\t\tif (typeof data === 'object' && 'id' in data && 'element' in data && 'resource' in data) {\r\n\t\t\t\tthis._id = data.id;\r\n\t\t\t\tthis._element = data.element;\r\n\t\t\t\tthis._resource = data.resource;\r\n\r\n\t\t\t\tlet info = decodeResource({\r\n\t\t\t\t\tresource: this._resource,\r\n\t\t\t\t\telement: this._element\r\n\t\t\t\t});\r\n\t\t\t\tthis._tag = info.tag;\r\n\t\t\t\tthis._consistent = info.consistent;\r\n\t\t\t\tthis._format = info.format;\r\n\t\t\t\tthis._exists = this._element !== null;\r\n\t\t\t\tthis._originalElement = this._element;\r\n\r\n\t\t\t\tif (!this._exists || !this._consistent) {\r\n\t\t\t\t\tthis._element = document.createElement(this._tag);\r\n\t\t\t\t\tthis._element.dataset[this.srcAttr] = this._resource;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (this._exists && this._settings.visible && IntersectionObserverSupported) {\r\n\t\t\t\t\tthis._observer = new IntersectionObserver(\r\n\t\t\t\t\t\t(entries, observer) => {\r\n\t\t\t\t\t\t\tentries.forEach(\r\n\t\t\t\t\t\t\t\tentry => (entry.target.intersectionRatio = entry.intersectionRatio)\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\troot: null,\r\n\t\t\t\t\t\t\trootMargin: '0px',\r\n\t\t\t\t\t\t\tthreshold: 0.1\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t);\r\n\t\t\t\t\tthis._observer.observe(this._originalElement);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._idEvent = this._element[pluginInstance + '_IDEvent'];\r\n\t\t\t\tthis._busy = this._idEvent !== undefined;\r\n\t\t\t\tthis._idEvent = this._busy\r\n\t\t\t\t\t? this._idEvent\r\n\t\t\t\t\t: pluginName + '_unique_' + this._element.tagName + '_' + generateInstanceID();\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @returns {string}\r\n\t\t */\r\n\t\tget resource() {\r\n\t\t\treturn this._resource;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @returns {boolean} se ha preso in carico il caricamento oppure no per vari motivi (è già caricato, non è nella viewport etc)\r\n\t\t */\r\n\t\tload() {\r\n\t\t\tif (isLoaded(this._exists && this._consistent ? this._element : this._resource)) {\r\n\t\t\t\tif (!this._busy) {\r\n\t\t\t\t\t// TODO: mayabe this should be called in this._callback\r\n\t\t\t\t\tdetachEventListener(this._element, '.' + this._idEvent);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._callback(\r\n\t\t\t\t\tnew CustomEvent(\r\n\t\t\t\t\t\t!isBroken(this._exists && this._consistent ? this._element : this._resource)\r\n\t\t\t\t\t\t\t? 'load'\r\n\t\t\t\t\t\t\t: 'error'\r\n\t\t\t\t\t)\r\n\t\t\t\t);\r\n\r\n\t\t\t\treturn false;\r\n\t\t\t} else if (this._exists && this._settings.visible && !isVisible(this._originalElement)) {\r\n\t\t\t\treturn false;\r\n\t\t\t} else {\r\n\t\t\t\tif (this._format === 'image') {\r\n\t\t\t\t\tattachEventListener(this._element, 'load.' + this._idEvent, this._callback, !this._busy);\r\n\t\t\t\t\tattachEventListener(this._element, 'error.' + this._idEvent, this._callback, !this._busy);\r\n\r\n\t\t\t\t\tconst picture = this._element.closest('picture');\r\n\r\n\t\t\t\t\tif (picture && pictureElementSupported) {\r\n\t\t\t\t\t\tdelete this._element.dataset[this.srcsetAttr];\r\n\t\t\t\t\t\tdelete this._element.dataset[this.srcAttr];\r\n\r\n\t\t\t\t\t\tpicture.querySelectorAll('source[' + this._settings.srcsetAttr + ']').forEach(el => {\r\n\t\t\t\t\t\t\tel.setAttribute('srcset', el.dataset[this.srcAttr]);\r\n\t\t\t\t\t\t\tdelete el.dataset[this.srcAttr];\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (this._element.matches('[' + this._settings.srcsetAttr + ']')) {\r\n\t\t\t\t\t\t\tthis._element.setAttribute('srcset', this._element.dataset[this.srcsetAttr]);\r\n\t\t\t\t\t\t\tdelete this._element.dataset[this.srcsetAttr];\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif (this._element.matches('[' + this._settings.srcAttr + ']')) {\r\n\t\t\t\t\t\t\tthis._element.setAttribute('src', this._element.dataset[this.srcAttr]);\r\n\t\t\t\t\t\t\tdelete this._element.dataset[this.srcAttr];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (this._format === 'video' || this._format === 'audio') {\r\n\t\t\t\t\tconst isStandardPlaythrough = true === this._settings.playthrough;\r\n\t\t\t\t\tconst isFullPlaythrough = 'full' === this._settings.playthrough;\r\n\t\t\t\t\tconst sources = this._element.querySelectorAll('source');\r\n\r\n\t\t\t\t\tlet callMediaLoad = false;\r\n\r\n\t\t\t\t\tif (sources) {\r\n\t\t\t\t\t\tsources.forEach(source => {\r\n\t\t\t\t\t\t\tif (source.matches('[' + this._settings.srcAttr + ']')) {\r\n\t\t\t\t\t\t\t\tsource.setAttribute('src', source.dataset[this.srcAttr]);\r\n\t\t\t\t\t\t\t\tdelete source.dataset[this.srcsetAttr];\r\n\r\n\t\t\t\t\t\t\t\tcallMediaLoad = true;\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tattachEventListener(\r\n\t\t\t\t\t\t\t\tsource,\r\n\t\t\t\t\t\t\t\t'error.' + this._idEvent,\r\n\t\t\t\t\t\t\t\te => {\r\n\t\t\t\t\t\t\t\t\tconst sourcesErrorId = pluginName + '_error';\r\n\r\n\t\t\t\t\t\t\t\t\tsource[pluginInstance + '_' + sourcesErrorId] = true;\r\n\r\n\t\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t\tsources.length ===\r\n\t\t\t\t\t\t\t\t\t\tnodelistToArray(sources).filter(\r\n\t\t\t\t\t\t\t\t\t\t\tthisSource =>\r\n\t\t\t\t\t\t\t\t\t\t\t\ttrue === thisSource[pluginInstance + '_' + sourcesErrorId]\r\n\t\t\t\t\t\t\t\t\t\t).length\r\n\t\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\t\tthis._callback(e);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t!this._busy\r\n\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t} else if (this._element.matches('[' + this._settings.srcAttr + ']')) {\r\n\t\t\t\t\t\tthis._element.setAttribute('src', this._element.dataset[this.srcAttr]);\r\n\t\t\t\t\t\tdelete this._element.dataset[this.srcAttr];\r\n\r\n\t\t\t\t\t\tattachEventListener(\r\n\t\t\t\t\t\t\tthis._element,\r\n\t\t\t\t\t\t\t'error.' + this._idEvent,\r\n\t\t\t\t\t\t\tthis._callback,\r\n\t\t\t\t\t\t\t!this._busy\r\n\t\t\t\t\t\t);\r\n\r\n\t\t\t\t\t\tcallMediaLoad = true;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (callMediaLoad) {\r\n\t\t\t\t\t\tthis._element.load();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tattachEventListener(\r\n\t\t\t\t\t\tthis._element,\r\n\t\t\t\t\t\t'loadedmetadata.' + this._idEvent,\r\n\t\t\t\t\t\t() => {\r\n\t\t\t\t\t\t\tif (!isStandardPlaythrough && !isFullPlaythrough) {\r\n\t\t\t\t\t\t\t\tthis._callback(new CustomEvent('load'));\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tif (isFullPlaythrough) {\r\n\t\t\t\t\t\t\t\tlet onProgressReplacementInterval = setInterval(() => {\r\n\t\t\t\t\t\t\t\t\tlet isError = this._element.readyState > 0 && !this._element.duration;\r\n\r\n\t\t\t\t\t\t\t\t\tif (isError || isFullyBuffered(this._element)) {\r\n\t\t\t\t\t\t\t\t\t\tthis._element.currentTime = 0;\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\t\t\t\t!isError &&\r\n\t\t\t\t\t\t\t\t\t\t\t!this._busy &&\r\n\t\t\t\t\t\t\t\t\t\t\tthis._element.paused &&\r\n\t\t\t\t\t\t\t\t\t\t\tthis._element.matches('[autoplay]')\r\n\t\t\t\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\t\t\t\tthis._element.play();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tclearInterval(onProgressReplacementInterval);\r\n\r\n\t\t\t\t\t\t\t\t\t\tthis._callback(new CustomEvent(!isError ? 'load' : 'error'));\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tif (!this._element.paused) {\r\n\t\t\t\t\t\t\t\t\t\t\tthis._element.pause();\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (!this._busy) {\r\n\t\t\t\t\t\t\t\t\t\t\tthis._element.currentTime += 2;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}, 500);\r\n\r\n\t\t\t\t\t\t\t\tthis._element[\r\n\t\t\t\t\t\t\t\t\tpluginName + '_' + this._idEvent\r\n\t\t\t\t\t\t\t\t] = onProgressReplacementInterval;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t!this._busy\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tattachEventListener(\r\n\t\t\t\t\t\tthis._element,\r\n\t\t\t\t\t\t'canplay.' + this._idEvent,\r\n\t\t\t\t\t\t() => {\r\n\t\t\t\t\t\t\tif (\r\n\t\t\t\t\t\t\t\tisFullPlaythrough &&\r\n\t\t\t\t\t\t\t\tthis._element.currentTime === 0 &&\r\n\t\t\t\t\t\t\t\t!isFullyBuffered(this._element)\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tthis._element.currentTime++;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t!this._busy\r\n\t\t\t\t\t);\r\n\r\n\t\t\t\t\tattachEventListener(\r\n\t\t\t\t\t\tthis._element,\r\n\t\t\t\t\t\t'canplaythrough.' + this._idEvent,\r\n\t\t\t\t\t\t() => {\r\n\t\t\t\t\t\t\tif (isStandardPlaythrough) {\r\n\t\t\t\t\t\t\t\tthis._callback(new CustomEvent('load'));\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t!this._busy\r\n\t\t\t\t\t);\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (!this._busy) {\r\n\t\t\t\t\tthis._element[pluginInstance + '_IDEvent'] = this._idEvent;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis._resource = this._element.currentSrc || this._element.src;\r\n\r\n\t\t\treturn !this._busy;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @param {Function} callback\r\n\t\t * @returns {undefined}\r\n\t\t */\r\n\t\tdone(callback) {\r\n\t\t\tif (typeof callback !== 'function') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis._done = function(element, status, resource, id) {\r\n\t\t\t\tcallback.apply(this, [element, status, resource, id]);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @returns {undefined}\r\n\t\t */\r\n\t\tabort() {\r\n\t\t\tdetachEventListener(this._element, '.' + this._idEvent);\r\n\r\n\t\t\tif (isLoaded(this._exists ? this._element : this._resource)) {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tconst src = this._element.getAttribute('srcset'),\r\n\t\t\t\tsrcset = this._element.getAttribute('src');\r\n\r\n\t\t\tif (undefined !== src) {\r\n\t\t\t\tthis._element.dataset[this.srcAttr] = src;\r\n\t\t\t\tthis._element.setAttribute(this._settings.srcAttr, src);\r\n\t\t\t\tthis._element.removeAttribute('src');\r\n\t\t\t\tthis._element.removeAttribute('srcset');\r\n\t\t\t}\r\n\r\n\t\t\tif (undefined !== srcset) {\r\n\t\t\t\tthis._element.dataset[this.srcsetAttr] = srcset;\r\n\t\t\t\tthis._element.setAttribute(this._settings.srcsetAttr, srcset);\r\n\t\t\t\tthis._element.removeAttribute('src');\r\n\t\t\t\tthis._element.removeAttribute('srcset');\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\t// TODO: Promise support\r\n\t// TODO: private vars\r\n\t// TODO: refactory succes/done/progress code...\r\n\t/** TODO: description of the MyClass constructor function.\r\n\t * @class\r\n\t * @classdesc TODO: description of the Loader class.\r\n\t */\r\n\tclass Loader {\r\n\t\t/**\r\n\t\t * @param {Object} [options={srcAttr: 'data-src', srcsetAttr: 'data-srcset', playthrough: false, visible: false, backgrounds: false }]\r\n\t\t */\r\n\t\tconstructor(options) {\r\n\t\t\tthis._collection = [];\r\n\t\t\tthis._collectionLoaded = [];\r\n\t\t\tthis._collectionInstances = [];\r\n\t\t\tthis._collectionPending = [];\r\n\t\t\tthis._resourcesLoaded = [];\r\n\r\n\t\t\tthis._settings = {\r\n\t\t\t\t...{\r\n\t\t\t\t\tsrcAttr: 'data-src',\r\n\t\t\t\t\tsrcsetAttr: 'data-srcset',\r\n\t\t\t\t\tplaythrough: false,\r\n\t\t\t\t\tvisible: false,\r\n\t\t\t\t\tbackgrounds: false\r\n\t\t\t\t},\r\n\t\t\t\t...options\r\n\t\t\t};\r\n\r\n\t\t\tif (\r\n\t\t\t\t!stringStartsWith(this._settings.srcAttr, 'data-') ||\r\n\t\t\t\t!stringStartsWith(this._settings.srcsetAttr, 'data-')\r\n\t\t\t) {\r\n\t\t\t\tthrow new Error(\r\n\t\t\t\t\t'Wrong arguments format: srcAttr and srcsetAttr parameters must be dataset values.'\r\n\t\t\t\t);\r\n\t\t\t}\r\n\r\n\t\t\tthis.srcAttr = hyphensToCamelCase(this._settings.srcAttr.replace('data-', ''));\r\n\t\t\tthis.srcsetAttr = hyphensToCamelCase(this._settings.srcsetAttr.replace('data-', ''));\r\n\r\n\t\t\tthis.percentage = 0;\r\n\r\n\t\t\tthis._done = () => {};\r\n\t\t\tthis._progress = () => {};\r\n\t\t\tthis._success = () => {};\r\n\t\t\tthis._error = () => {};\r\n\t\t\tthis._loop = this.load;\r\n\r\n\t\t\tthis._abort = false;\r\n\t\t\tthis._loaded = 0;\r\n\t\t\tthis._complete = false;\r\n\t\t\tthis._busy = false;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t *\r\n\t\t * @param {HTMLElement} [element=document.body]\r\n\t\t * @param {Object} [options={ srcAttr: 'src', srcsetAttr: 'srcset', backgrounds: false }]\r\n\t\t */\r\n\t\tstatic findResources(element, options) {\r\n\t\t\tlet settings = {\r\n\t\t\t\tsrcAttr: 'src',\r\n\t\t\t\tsrcsetAttr: 'srcset',\r\n\t\t\t\tbackgrounds: false\r\n\t\t\t};\r\n\r\n\t\t\tif (typeof element === 'object' && undefined === options) {\r\n\t\t\t\tfor (let key in settings) {\r\n\t\t\t\t\tif (key in element) {\r\n\t\t\t\t\t\toptions = element;\r\n\t\t\t\t\t\telement = undefined;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif (undefined === element || element === document) {\r\n\t\t\t\telement = document.body;\r\n\t\t\t}\r\n\r\n\t\t\tif (!isHTMLElement(element)) {\r\n\t\t\t\tthrow new Error('TypeError: ' + element + ' is not of type HTMLElement.');\r\n\t\t\t}\r\n\r\n\t\t\tlet collectedResources = [];\r\n\r\n\t\t\tsettings = {\r\n\t\t\t\t...settings,\r\n\t\t\t\t...options\r\n\t\t\t};\r\n\r\n\t\t\tconst targets = 'img, video, audio';\r\n\t\t\tconst targetsExtended = targets + ', picture, source';\r\n\t\t\tconst targetsFilter = '[' + settings.srcAttr + '], [' + settings.srcsetAttr + ']';\r\n\r\n\t\t\tlet targetsTags = nodelistToArray(element.querySelectorAll(targets));\r\n\r\n\t\t\tif (element.matches(targetsExtended)) {\r\n\t\t\t\ttargetsTags.push(element);\r\n\t\t\t}\r\n\r\n\t\t\ttargetsTags = targetsTags.filter(target => {\r\n\t\t\t\tlet children = nodelistToArray(target.children);\r\n\t\t\t\tchildren = children.filter(x => x.matches(targetsExtended));\r\n\t\t\t\tchildren = children.filter(x => x.matches(targetsFilter));\r\n\t\t\t\treturn target.matches(targetsFilter) || children.length;\r\n\t\t\t});\r\n\t\t\ttargetsTags.forEach(target => {\r\n\t\t\t\tlet targetSource = target;\r\n\r\n\t\t\t\tif (!targetSource.matches(targetsFilter)) {\r\n\t\t\t\t\ttargetSource = targetSource.querySelectorAll(targetsFilter);\r\n\t\t\t\t\ttargetSource = [...targetSource][0];\r\n\t\t\t\t}\r\n\r\n\t\t\t\tcollectedResources.push({\r\n\t\t\t\t\telement: target,\r\n\t\t\t\t\tresource:\r\n\t\t\t\t\t\ttargetSource.getAttribute(settings.srcAttr) ||\r\n\t\t\t\t\t\ttargetSource.getAttribute(settings.srcsetAttr)\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\tif (true === settings.backgrounds) {\r\n\t\t\t\tlet targetsBg = nodelistToArray(element.querySelectorAll('*'));\r\n\t\t\t\ttargetsBg.push(element);\r\n\t\t\t\ttargetsBg = targetsBg.filter(target => !target.matches(targetsExtended));\r\n\t\t\t\ttargetsBg = targetsBg.filter(target => getComputedStyle(target).backgroundImage !== 'none');\r\n\t\t\t\ttargetsBg.forEach(target => {\r\n\t\t\t\t\tconst url = getComputedStyle(target).backgroundImage.match(/\\((.*?)\\)/);\r\n\r\n\t\t\t\t\tif (null !== url && url.length >= 2) {\r\n\t\t\t\t\t\tcollectedResources.push({\r\n\t\t\t\t\t\t\telement: target,\r\n\t\t\t\t\t\t\tresource: url[1].replace(/('|\")/g, '')\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\treturn collectedResources;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @param {(Array.<String>|HTMLElement)} collection\r\n\t\t */\r\n\t\tset collection(collection) {\r\n\t\t\tlet collectedResources = collection;\r\n\r\n\t\t\ttry {\r\n\t\t\t\tcollectedResources = Loader.findResources(collection, this._settings);\r\n\t\t\t} catch (err) {}\r\n\r\n\t\t\tcollectedResources.forEach(item => {\r\n\t\t\t\tlet element = {\r\n\t\t\t\t\tresource: '',\r\n\t\t\t\t\telement: null,\r\n\t\t\t\t\tid: generateInstanceID()\r\n\t\t\t\t};\r\n\r\n\t\t\t\tif (typeof item === 'string') {\r\n\t\t\t\t\telement.resource = item;\r\n\t\t\t\t} else if (typeof item === 'object' && 'resource' in item) {\r\n\t\t\t\t\telement = { ...element, ...item };\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis._collection.push(element);\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @returns {Array} collection\r\n\t\t */\r\n\t\tget collection() {\r\n\t\t\treturn this._collection;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @returns {undefined}\r\n\t\t */\r\n\t\tload() {\r\n\t\t\tif (!this._collection.length) {\r\n\t\t\t\tthis._done.call(this, this._resourcesLoaded);\r\n\t\t\t}\r\n\r\n\t\t\t// resets pending elements (sequential opt helper array) every time we loop\r\n\t\t\tthis._collectionPending = [];\r\n\r\n\t\t\tconst sequentialMode = true === this._settings.sequential;\r\n\r\n\t\t\tfor (let i = 0; i < this._collection.length; i++) {\r\n\t\t\t\tif (this._abort) {\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet thisLoadId = this._collection[i].id;\r\n\t\t\t\tlet thisLoadIndex = arrayFindIndex(this._collectionInstances, x => x.id === thisLoadId);\r\n\t\t\t\tlet thisLoadInstance = new SingleLoader(this._settings);\r\n\r\n\t\t\t\tif (thisLoadIndex === -1) {\r\n\t\t\t\t\tthis._collectionInstances.push({\r\n\t\t\t\t\t\tid: thisLoadId,\r\n\t\t\t\t\t\tinstance: thisLoadInstance\r\n\t\t\t\t\t});\r\n\t\t\t\t\tthisLoadIndex = arrayFindIndex(this._collectionInstances, x => x.id === thisLoadId);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis._collectionInstances[thisLoadIndex].instance = thisLoadInstance;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthisLoadInstance.resource = this._collection[i];\r\n\r\n\t\t\t\tthisLoadInstance.done((element, status, resource, id) => {\r\n\t\t\t\t\tif (this._complete || this._abort) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst aProgress = !isInArray(id, this._collectionLoaded);\r\n\r\n\t\t\t\t\tif (aProgress) {\r\n\t\t\t\t\t\tthis._collectionLoaded.push(id);\r\n\t\t\t\t\t\tthis._busy = false;\r\n\r\n\t\t\t\t\t\tthis._loaded++;\r\n\t\t\t\t\t\tthis.percentage = this._loaded / this._collection.length * 100;\r\n\t\t\t\t\t\tthis.percentage = parseFloat(this.percentage.toFixed(4));\r\n\r\n\t\t\t\t\t\tconst thisResource = {\r\n\t\t\t\t\t\t\tresource: resource,\r\n\t\t\t\t\t\t\tstatus: status,\r\n\t\t\t\t\t\t\telement: element\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._resourcesLoaded.push(thisResource);\r\n\t\t\t\t\t\tthis._progress.call(this, thisResource);\r\n\t\t\t\t\t\tthis[status !== 'error' ? '_success' : '_error'].call(this, thisResource);\r\n\t\t\t\t\t\t// TODO: dispatch event on element maybe?\r\n\t\t\t\t\t\t// element.dispatchEvent(new CustomEvent(pluginPrefix + capitalize(status) + '.' + pluginPrefix));\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (this._loaded === this._collection.length) {\r\n\t\t\t\t\t\tthis._done.call(this, this._resourcesLoaded);\r\n\r\n\t\t\t\t\t\tthis._complete = true;\r\n\t\t\t\t\t} else if (aProgress && sequentialMode && this._collectionPending.length) {\r\n\t\t\t\t\t\tthis._collectionPending = this._collectionPending.filter(x => x.id !== id);\r\n\r\n\t\t\t\t\t\tif (this._collectionPending.length) {\r\n\t\t\t\t\t\t\tthis._busy = this._collectionPending[0].instance.load();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif (!sequentialMode || (sequentialMode && !this._busy)) {\r\n\t\t\t\t\tthis._busy = thisLoadInstance.load();\r\n\t\t\t\t} else if (\r\n\t\t\t\t\tsequentialMode &&\r\n\t\t\t\t\tthis._busy &&\r\n\t\t\t\t\t(!this._settings.visible ||\r\n\t\t\t\t\t\t!thisLoadInstance._exists ||\r\n\t\t\t\t\t\t(this._settings.visible &&\r\n\t\t\t\t\t\t\tthisLoadInstance._exists &&\r\n\t\t\t\t\t\t\tisVisible(thisLoadInstance._originalElement)))\r\n\t\t\t\t) {\r\n\t\t\t\t\tthis._collectionPending.push({\r\n\t\t\t\t\t\tid: thisLoadId,\r\n\t\t\t\t\t\tinstance: thisLoadInstance\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @param {Function} callback\r\n\t\t * @returns {undefined}\r\n\t\t */\r\n\t\tdone(callback) {\r\n\t\t\tif (typeof callback !== 'function') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis._done = function(resources) {\r\n\t\t\t\tcallback.call(this, resources);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @param {Function} callback\r\n\t\t * @returns {undefined}\r\n\t\t */\r\n\t\tprogress(callback) {\r\n\t\t\tif (typeof callback !== 'function') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis._progress = function(resource) {\r\n\t\t\t\tcallback.call(this, resource);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @param {Function} callback\r\n\t\t * @returns {undefined}\r\n\t\t */\r\n\t\tsuccess(callback) {\r\n\t\t\tif (typeof callback !== 'function') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis._success = function(resource) {\r\n\t\t\t\tcallback.call(this, resource);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @param {Function} callback\r\n\t\t * @returns {undefined}\r\n\t\t */\r\n\t\terror(callback) {\r\n\t\t\tif (typeof callback !== 'function') {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tthis._error = function(resource) {\r\n\t\t\t\tcallback.call(this, resource);\r\n\t\t\t};\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * @returns {undefined}\r\n\t\t */\r\n\t\tabort() {\r\n\t\t\tthis._collectionInstances.forEach(thisInstance => {\r\n\t\t\t\tthisInstance.instance.abort();\r\n\t\t\t});\r\n\r\n\t\t\tthis._abort = true;\r\n\t\t}\r\n\t}\r\n\r\n\t// public interface\r\n\t// - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n\t// requirejs\r\n\tif (typeof define === 'function' && define.amd) {\r\n\t\tdefine(capitalize(pluginName), Loader);\r\n\t\t// nodejs\r\n\t} else if ('object' === typeof exports) {\r\n\t\tmodule.exports[capitalize(pluginName)] = Loader;\r\n\t\t// vanilla\r\n\t} else {\r\n\t\twindow[capitalize(pluginName)] = Loader;\r\n\t}\r\n\t// - - - - - - - - - - - - - - - - - - - - - - - - - - -\r\n\r\n\t// jQuery interface\r\n\t// - - - - - - - - - - - - - - - - - - - -\r\n\tif (!('jQuery' in window)) {\r\n\t\treturn;\r\n\t}\r\n\r\n\tconst $ = jQuery;\r\n\r\n\t$[capitalize(pluginName)] = Loader;\r\n\r\n\tconst $document = $(document);\r\n\tconst $window = $(window);\r\n\t// thanks https://gist.github.com/beaucharman/e46b8e4d03ef30480d7f4db5a78498ca\r\n\tconst throttle = (callback, wait, context = this) => {\r\n\t\tlet timeout = null;\r\n\t\tlet callbackArgs = null;\r\n\t\tconst later = () => {\r\n\t\t\tcallback.apply(context, callbackArgs);\r\n\t\t\ttimeout = null;\r\n\t\t};\r\n\t\treturn function() {\r\n\t\t\tif (!timeout) {\r\n\t\t\t\tcallbackArgs = arguments;\r\n\t\t\t\ttimeout = setTimeout(later, wait);\r\n\t\t\t}\r\n\t\t};\r\n\t};\r\n\r\n\tlet methodCollection = [];\r\n\r\n\t$.fn[pluginMethod] = function(options) {\r\n\t\tlet originalUserOptions = options;\r\n\r\n\t\tif (typeof options !== 'object') {\r\n\t\t\toptions = {};\r\n\t\t}\r\n\r\n\t\tlet settings = {\r\n\t\t\t...{\r\n\t\t\t\tsrcAttr: 'data-src',\r\n\t\t\t\tsrcsetAttr: 'data-srcset',\r\n\r\n\t\t\t\tvisible: false,\r\n\t\t\t\tsequential: false,\r\n\r\n\t\t\t\tbackgrounds: false,\r\n\t\t\t\tplaythrough: false,\r\n\r\n\t\t\t\tearly: false,\r\n\t\t\t\tearlyTimeout: 0,\r\n\r\n\t\t\t\tonProgress: () => {},\r\n\t\t\t\tonLoad: () => {},\r\n\t\t\t\tonError: () => {},\r\n\r\n\t\t\t\tonComplete: () => {}\r\n\t\t\t},\r\n\t\t\t...options\r\n\t\t};\r\n\r\n\t\tlet callback = settings.onComplete;\r\n\t\tif ($.isFunction(originalUserOptions)) {\r\n\t\t\tcallback = originalUserOptions;\r\n\t\t}\r\n\r\n\t\treturn this.each(function(i) {\r\n\t\t\t// TODO: mutation observer when new children are appended\r\n\r\n\t\t\tconst $element = $(this);\r\n\t\t\tconst uniqueMethodPluginName = generateInstanceID() + i;\r\n\t\t\tconst thisLoadInstance = new Loader(settings);\r\n\r\n\t\t\tthisLoadInstance.collection = this;\r\n\r\n\t\t\tmethodCollection.push({\r\n\t\t\t\tid: uniqueMethodPluginName,\r\n\t\t\t\tinstance: thisLoadInstance,\r\n\t\t\t\telement: this,\r\n\t\t\t\ttimeout: null\r\n\t\t\t});\r\n\r\n\t\t\tthisLoadInstance.progress(resource => {\r\n\t\t\t\t$(resource.element).trigger(pluginPrefix + capitalize(resource.status) + '.' + pluginPrefix, [\r\n\t\t\t\t\tresource.element,\r\n\t\t\t\t\tresource.resource\r\n\t\t\t\t]);\r\n\t\t\t\t$element.trigger(pluginPrefix + 'Progress.' + pluginPrefix, [this, resource]);\r\n\r\n\t\t\t\tconst thisArguments = [thisLoadInstance, resource];\r\n\r\n\t\t\t\tif (typeof settings.onProgress === 'function') {\r\n\t\t\t\t\tsettings.onProgress.apply(this, thisArguments);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet eventName = capitalize(resource.status);\r\n\t\t\t\tif (typeof settings['on' + eventName] === 'function') {\r\n\t\t\t\t\tsettings['on' + eventName].apply(this, thisArguments);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\tthisLoadInstance.done(resources => {\r\n\t\t\t\t$element.trigger(pluginPrefix + 'Complete.' + pluginPrefix, [this, resources]);\r\n\t\t\t\tcallback.apply(this, [thisLoadInstance, resources]);\r\n\r\n\t\t\t\tif (settings.visible) {\r\n\t\t\t\t\t/*if (IntersectionObserverSupported) {\r\n                        thisLoadInstance.collection.forEach(item => item.element.intersectionObserver.unobserve(item.element));\r\n\r\n                    } else {*/\r\n\t\t\t\t\t$window.off('scroll.' + uniqueMethodPluginName);\r\n\r\n\t\t\t\t\t//}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// refresh other method calls for same el (omitting this one)\r\n\t\t\t\tmethodCollection = methodCollection.filter(x => x.id !== uniqueMethodPluginName);\r\n\t\t\t\tmethodCollection.forEach(thisMethodCollection => {\r\n\t\t\t\t\tif ($element.is(thisMethodCollection.element)) {\r\n\t\t\t\t\t\tthisMethodCollection.instance.load();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\tthisLoadInstance.load();\r\n\r\n\t\t\tif (settings.visible) {\r\n\t\t\t\t/* if (IntersectionObserverSupported) {\r\n\r\n                    thisLoadInstance.collection.forEach(item => {\r\n\r\n                        item.element.intersectionObserver = new IntersectionObserver((entries, observer) => {\r\n                            entries.forEach(entry => {\r\n                                if( entry.intersectionRatio > 0 ){\r\n                                    thisLoadInstance.load();\r\n                                }\r\n                            });\r\n                        }, {\r\n                            root: null,\r\n                            rootMargin: '0px',\r\n                            threshold: 0.0\r\n                        });\r\n\r\n                        item.element.intersectionObserver.observe(item.element);\r\n\r\n                    });\r\n\r\n                } else {*/\r\n\r\n\t\t\t\t$window.on('scroll.' + uniqueMethodPluginName, throttle(() => thisLoadInstance.load(), 250));\r\n\r\n\t\t\t\t//}\r\n\t\t\t}\r\n\r\n\t\t\tif (true === settings.early) {\r\n\t\t\t\tlet breakLoop = false;\r\n\r\n\t\t\t\tmethodCollection.forEach(thisMethodCollection => {\r\n\t\t\t\t\tif (breakLoop) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (methodCollection[key].id === uniqueMethodPluginName) {\r\n\t\t\t\t\t\tclearTimeout(thisMethodCollection.timeout);\r\n\r\n\t\t\t\t\t\tlet timeout = parseInt(settings.earlyTimeout);\r\n\r\n\t\t\t\t\t\tthisMethodCollection.timeout = setTimeout(() => {\r\n\t\t\t\t\t\t\t// TODO: appropriate method to set/update settings?\r\n\t\t\t\t\t\t\tthisMethodCollection.instance._settings.visible = false;\r\n\t\t\t\t\t\t\tthisMethodCollection.instance._settings.sequential = true;\r\n\r\n\t\t\t\t\t\t\tthisMethodCollection.instance.load();\r\n\t\t\t\t\t\t}, !isNaN(timeout) && isFinite(timeout) ? timeout : 0);\r\n\r\n\t\t\t\t\t\tbreakLoop = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n})();\r\n"],"file":"nite.loader.min.js"}