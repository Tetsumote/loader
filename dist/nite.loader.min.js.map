{"version":3,"sources":["nite.loader.js"],"names":["window","document","$","undefined","console","prop","method","con","dummy","properties","methods","split","pop","CustomEvent","event","params","bubbles","cancelable","detail","evt","createEvent","initCustomEvent","prototype","Event","Array","findIndex","callback","this","TypeError","list","Object","length","thisArg","arguments","i","call","isArray","arg","toString","filter","a","b","c","d","e","push","generateInstanceID","Math","floor","random","pluginPrefix","pluginMethod","pluginName","pluginInstance","detachEventListener","element","eventName","attachEventListener","oneTime","isInArray","needle","stack","indexOf","capitalize","string","charAt","toUpperCase","slice","isVisible","bodyEl","getElementsByTagName","winWidth","innerWidth","documnt","documentElement","clientWidth","winHeight","innerHeight","clientHeight","rect","getBoundingClientRect","right","bottom","left","top","getComputedStyle","isHTMLObject","object","HTMLElement","nodeType","style","ownerDocument","isLoaded","currentSrc","complete","readyState","isBroken","naturalWidth","videoWidth","isFormat","item","expectedFormat","formatExtensions","image","audio","video","formatNames","keys","output","format","extension","formatQueue","x","hasOwnProperty","RegExp","test","matches64","match","replace","matches","tagName","toLowerCase","ResourceLoader","[object Object]","options","_settings","srcAttr","srcsetAttr","playthrough","visible","_id","_id_event","_element","_resource","_busy","_format","_done","_success","_error","_callback","src","this_arguments","type","apply","resource","data","element_resource","string_resource","id","_exists","is_img","createElement","dataset","setAttribute","_resourc","src_clean","_elemnt","picture","closest","srcset","srcset_clean","removeAttribute","queryAll","forEach","el","addAttribute","is_playthrough_mode__normal","is_playthrough_mode__full","sources","isFullyBuffered","media","buffered","round","end","seekable","call_media_load","source","sources_error_id","_$element","load","on_progress_replacement_interval","setInterval","is_error","duration","currentTime","paused","play","clearInterval","pause","status","getAttribute","ResourcesLoader","collection","_collection","_collection_loaded","_collection_instances","_collection_pending","_resources_loaded","percentage","_progress","_abort","_loaded","_complete","_loop","setTimeout","loop","sequential_mode","sequential","this_load_id","this_load_index","this_load_instance","instance","done","a_progress","parseFloat","toFixed","this_resource","trigger","process","_func","resources","key","abort","define","amd","exports","module","$window","throttle","wait","context","timeout","callbackArgs","later","method_collection","fn","original_user_options","settings","backgrounds","extraAttrs","early","earlyTimeout","onProgress","onLoad","onError","onComplete","isFunction","attributes","each","$element","is_plain_data_collection","targets","targets_extended","$targets","find","is","add","$t","children","collection_item","attr","addBack","not","css","url","collect","unique_method_pluginName","progress","event_name","off","this_method_collection","on","clearTimeout","parseInt","isNaN","isFinite","jQuery"],"mappings":"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","sourcesContent":["/*! JQuery Nite Loader | Daniele Fioroni | dfioroni91@gmail.com */\n(function (window, document, $, undefined) {\n    'use strict';\n\n    // thanks to https://github.com/paulmillr/console-polyfill\n    // - - - - - - - - - - - - - - - - - - - -\n    (function () {\n        if (!window.console) {\n            window.console = {};\n        }\n        let con = window.console,\n            prop, method,\n            dummy = function () { },\n            properties = ['memory'],\n            methods = ('assert,clear,count,debug,dir,dirxml,error,exception,group,' +\n                'groupCollapsed,groupEnd,info,log,markTimeline,profile,profiles,profileEnd,' +\n                'show,table,time,timeEnd,timeline,timelineEnd,timeStamp,trace,warn').split(',');\n        while (prop = properties.pop()) {\n            if (!con[prop]) {\n                con[prop] = {};\n            }\n        }\n        while (method = methods.pop()) {\n            if (!con[method]) {\n                con[method] = dummy;\n            }\n        }\n    })();\n    // - - - - - - - - - - - - - - - - - - - -\n\n    // https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent/CustomEvent#Polyfill\n    // - - - - - - - - - - - - - - - - - - - -\n    (function () {\n        if (typeof window.CustomEvent === \"function\") {\n            return false; //If not IE\n        }\n        function CustomEvent(event, params) {\n            params = params || { bubbles: false, cancelable: false, detail: undefined };\n            let evt = document.createEvent('CustomEvent');\n            evt.initCustomEvent(event, params.bubbles, params.cancelable, params.detail);\n            return evt;\n        }\n        CustomEvent.prototype = window.Event.prototype;\n        window.CustomEvent = CustomEvent;\n    })();\n    // - - - - - - - - - - - - - - - - - - - -\n\n    // thanks to https://github.com/jsPolyfill/Array.prototype.findIndex\n    // - - - - - - - - - - - - - - - - - - - -\n    Array.prototype.findIndex = Array.prototype.findIndex || function (callback) {\n        if (this === null) {\n            throw new TypeError('Array.prototype.findIndex called on null or undefined');\n        } else if (typeof callback !== 'function') {\n            throw new TypeError('callback must be a function');\n        }\n        const\n            list = Object(this),\n            // Makes sures is always has an positive integer as length.\n            length = list.length >>> 0,\n            thisArg = arguments[1];\n        for (let i = 0; i < length; i++) {\n            if (callback.call(thisArg, list[i], i, list)) {\n                return i;\n            }\n        }\n        return -1;\n    };\n    // - - - - - - - - - - - - - - - - - - - -\n\n    // https://developer.mozilla.org/it/docs/Web/JavaScript/Reference/Global_Objects/Array/isArray\n    // - - - - - - - - - - - - - - - - - - - -\n    Array.isArray = Array.isArray || function (arg) {\n        return Object.prototype.toString.call(arg) === '[object Array]';\n    };\n    // - - - - - - - - - - - - - - - - - - - -\n\n    // thanks to https://gist.github.com/eliperelman/1031656\n    // - - - - - - - - - - - - - - - - - - - -\n    [].filter || (Array.prototype.filter = function (a, b, c, d, e) { c = this; d = []; for (e in c) ~~e + '' == e && e >= 0 && a.call(b, c[e], +e, c) && d.push(c[e]); return d })\n    // - - - - - - - - - - - - - - - - - - - -\n\n    const\n        generateInstanceID = function () {\n            return Math.floor(Math.random() * (9999 - 1000)) + 1000;\n        },\n        pluginPrefix = 'nite',\n        pluginMethod = pluginPrefix + 'Load',\n        pluginName = pluginMethod + 'er',\n        pluginInstance = generateInstanceID();\n\n    window[pluginName + 'Cache'] = [];\n\n    const\n        detachEventListener = (element, eventName) => {\n// TODO: func core + win global var with id .namspaced (like jQuery one)\n        },\n        attachEventListener = (element, eventName, oneTime) => {\n// TODO: func core + win global var with id .namspaced (like jQuery one)\n        },\n        isInArray = (needle, stack) => {\n            return stack.indexOf(needle) > -1;\n        },\n        capitalize = (string) => {\n            return string.charAt(0).toUpperCase() + string.slice(1);\n        },\n        isVisible = (element) => {\n\n            const\n                bodyEl = document.getElementsByTagName('body')[0],\n                winWidth = window.innerWidth || documnt.documentElement.clientWidth || bodyEl.clientWidth,\n                winHeight = window.innerHeight || documnt.documentElement.clientHeight || bodyEl.clientHeight,\n                rect = element.getBoundingClientRect();\n\n            return !(rect.right < 0 || rect.bottom < 0 || rect.left > winWidth || rect.top > winHeight) && window.getComputedStyle(element, 'display') !== 'none';\n\n        },\n        isHTMLObject = function (object) {\n\n            if (typeof object !== 'object') {\n                return false;\n            }\n\n            try {\n                return object instanceof HTMLElement;\n            }\n            catch (e) {\n                return object.nodeType === 1 && typeof object.style === 'object' && typeof object.ownerDocument === 'object';\n            }\n\n        },\n        isLoaded = function (element) {\n\n            return (\n                typeof element === 'string'\n                &&\n                isInArray(element, window[pluginName + 'Cache'])\n            )\n                || (\n                    isHTMLObject(element)\n                    && ('currentSrc' in element && element.currentSrc.length)\n                    && (('complete' in element && element.complete) || ('readyState' in element && element.readyState >= 2))\n                );\n\n        },\n        isBroken = function (element) {\n\n            return isLoaded(element) && (\n                (\n                    typeof element === 'object' && (\n                        ('naturalWidth' in element && Math.floor(element.naturalWidth) === 0)\n                        ||\n                        ('videoWidth' in element && element.videoWidth === 0)\n                    )\n                )\n                || typeof element === 'string' // todo check if is url maybe?\n            );\n\n        },\n        isFormat = function (item, expectedFormat) {\n\n            const\n                formatExtensions = {\n                    image: 'jp[e]?g||jpe|jif|jfif|jfi|gif|png|tif[f]?|bmp|dib|webp|ico|cur|svg',\n                    audio: 'mp3|ogg|oga|spx|ogg|wav',\n                    video: 'mp4|ogv|webm'\n                },\n                formatNames = Object.keys(formatExtensions),\n                base64Heading = '\\;base64\\,';\n\n            let output = { format: null, extension: null };\n\n            if (typeof item === 'string') {\n\n                item = item.split('?')[0]; // this gets rid of query strings\n                item = item.split('#')[0]; // this gets rid of hashes\n\n                if (item === '') {\n                    return false;\n                }\n\n                let formatQueue = undefined !== expectedFormat ? [expectedFormat] : formatNames;\n\n                for (const x in formatQueue) {\n\n                    if (formatQueue.hasOwnProperty(x)) {\n\n                        if (new RegExp('(\\.(' + formatExtensions[formatQueue[x]] + ')$)|' + base64Heading, 'g').test(item)) {\n\n                            if (new RegExp(base64Heading, 'g').test(item)) {\n\n                                let matches64 = item.match(new RegExp('^data:' + formatQueue[x] + '\\/(' + formatExtensions[formatQueue[x]] + ')', 'g'));\n\n                                if (!matches64 || null === matches64) {\n                                    continue;\n                                }\n\n                                matches64 = matches64[0];\n\n                                output.format = formatQueue[x];\n                                output.extension = matches64.replace('data:' + formatQueue[x] + '/', '');\n\n                                break;\n\n                            } else {\n\n                                let matches = item.match(new RegExp(formatExtensions[formatQueue[x]], 'g'));\n\n                                if (matches) {\n\n                                    output.format = formatQueue[x];\n                                    output.extension = matches[0];\n\n                                    break;\n\n                                }\n\n                            }\n\n                        }\n\n                    }\n\n                }\n\n            }\n\n            if (isHTMLObject(item)) {\n\n                let tagName = item.tagName.toLowerCase();\n\n                if (isInArray(tagName, formatNames)) {\n                    output.format = item.tagName.toLowerCase();\n                }\n\n                if (tagName === 'img') {\n                    output.format = 'image';\n                }\n\n            }\n\n            return output;\n\n        };\n\n    class ResourceLoader {\n\n        constructor(options) {\n\n            // todo make _vars really private\n            // todo think about useful vars (this class is not public but its vars are returned in .progress() callback)\n            this._settings = {\n                srcAttr: 'data-src',\n                srcsetAttr: 'data-srcset',\n                playthrough: false,\n                visible: false,\n            };\n            this._settings = { ...this._settings, ...options };\n\n            this._id = null;\n            this._id_event = null;\n\n            this._element = null;\n\n            this._resource = null;\n            this._busy = false;\n\n            this._format = null;\n\n            this._done = () => {};\n            this._success = () => {};\n            this._error = () => {};\n\n            this._callback = (e) => {\n\n                this._busy = false;\n\n                const src = this._element.currentSrc || this._element.src;\n\n                if (!isInArray(src, window[pluginName + 'Cache']))\n                    window[pluginName + 'Cache'].push(src);\n\n                let this_arguments = [this._element, e.type, src, this._id];\n\n                this[e.type !== 'error' ? '_success' : '_error'].apply(this, this_arguments);\n                this._done.apply(this, this_arguments);\n\n            };\n\n        }\n\n        set resource(data) {\n\n            const\n                element_resource = isHTMLObject(data.resource),\n                string_resource = typeof data.resource === 'string';\n\n            if (!element_resource && !string_resource) {\n                return;\n            }\n\n            this._id = data.id;\n            this._format = isFormat(data.resource).format;\n\n            this._exists = element_resource; // todo maybe search for an element with this src\n\n            if (string_resource) {\n\n                let is_img = this._format === 'image';\n\n                this._element = document.createElement(is_img ? 'img' : this._format);\n\n                if (is_img) {\n                    this._settings.srcsetAttr = 'data-srcset';\n                }\n\n                this._settings.srcAttr = 'data-src';\n\n                this._resource = data.resource;\n\n            }\n\n            if (element_resource) {\n                this._element = data.resource;\n            }\n\n            if (string_resource) {\n\n                this._element.dataset[this._settings.srcAttr.replace('data-', '')] = this._resource;\n                this._element.dataset[this._settings.srcsetAttr.replace('data-', '')] = this._resource;\n                this._element.setAttribute(this._settings.srcAttr, this._resourc);\n                this._element.setAttribute(this._settings.srcsetAttr, this._resourc);\n\n            }\n\n            this._id_event = this._element[pluginInstance + '_IDEvent'];\n            this._busy = this._id_event !== undefined;\n            this._id_event = this._busy ? this._id_event : pluginName + '_unique_' + this._element.tagName + '_' + generateInstanceID();\n\n        }\n\n        /**\n         *\n         * @returns {boolean} se ha preso in carico il caricamento oppure no per vari motivi (è già caricato, non è nella viewport etc)\n         */\n        process() {\n\n            const\n                src = this._settings.srcAttr,\n                src_clean = this._settings.srcAttr.replace('data-', '');\n\n            if (isLoaded(this._exists ? this._element : this._resource)) {\n\n                if (!this._busy) {\n                    detachEventListener(this._elemnt, '.' + this._id_event); //FIXME: vanilla alt //TODO: this should be called when in callback\n                }\n\n                this._callback(new CustomEvent(!isBroken(this._exists ? this._element : this._resource) ? 'load' : 'error'));\n\n                return false;\n\n            } else if (this._exists && this._settings.visible && !isVisible(this._element)) {\n\n                return false;\n\n            } else {\n\n                if (this._format === 'image') {\n\n                    attachEventListener(this._element, 'load.' + this._id_event, this._callback, !this._busy);\n                    attachEventListener(this._element, 'error.' + this._id_event, this._callback, !this._busy);\n\n                    const\n                        picture = this._element.closest('picture'),\n                        srcset = this._settings.srcsetAttr,\n                        srcset_clean = this._settings.srcsetAttr.replace('data-', '');\n\n                    if (picture && 'HTMLPictureElement' in window) {\n\n                        delete this._element.dataset[srcset_clean];\n                        delete this._element.dataset[src_clean];\n                        this._element.removeAttribute(srcset);\n                        this._element.removeAttribute(src);\n\n                        picture.queryAll('source[' + srcset + ']').forEach((el) => {\n                            el.addAttribute('srcset', this._element.dataset[srcset_clean]);\n                            delete this._element.dataset[srcset_clean];\n                            el.removeAttribute(srcset);\n                        });\n\n                    } else {\n\n                        if (this._element.matches('[' + srcset + ']')) {\n                            this._element.addAttribute('srcset', this._element.dataset[srcset_clean]);\n                            delete this._element.dataset[srcset_clean];\n                            this._element.removeAttribute(srcset);\n                        }\n\n                        if (this._element.matches('[' + src + ']')) {\n                            this._element.addAttribute('src', this._element.dataset[src_clean]);\n                            delete this._element.dataset[src_clean];\n                            this._element.removeAttribute(src);\n                        }\n\n                    }\n\n                } else if (this._format === 'video' || this._format === 'audio') {\n\n                    const\n\n                        is_playthrough_mode__normal = true === this._settings.playthrough,\n                        is_playthrough_mode__full = 'full' === this._settings.playthrough,\n\n                        sources = this._element.queryAll('source'),\n                        isFullyBuffered = function (media) {\n\n                            return media.buffered.length && Math.round(media.buffered.end(0)) / Math.round(media.seekable.end(0)) === 1;\n\n                        };\n\n                    let call_media_load = false;\n\n                    if (sources) {\n\n                        sources.forEach((source) => {\n\n                            if (source.matches('[' + src + ']')) {\n\n                                source.setAttribute('src', source.dataset[src_clean]);\n                                delete source.dataset[src_clean];\n                                source.removeAttribute(src);\n\n                                call_media_load = true;\n\n                            }\n\n                            attachEventListener(source, 'error.' + this._id_event, (e) => {\n\n                                const sources_error_id = pluginName + '_error';\n    \n                                source[pluginInstance + '_' + sources_error_id] = true;\n    \n                                if ( sources.length === sources.filter(() => true === source[pluginInstance + '_' + sources_error_id] ).length ) {\n                                    this._callback(e);\n                                }\n    \n                            }, !this._busy);\n\n                        });\n\n                    } else {\n\n                        if (this._element.matches('[' + src + ']')) {\n\n                            this._element.setAttribute('src', this._$element.data(src_clean));\n                            delete this._element.dataset[src_clean];\n                            this._element.removeAttribute(src);\n\n                            attachEventListener(this._element, 'error.' + this._id_event, this._callback, !this._busy);\n\n                            call_media_load = true;\n\n                        }\n\n                    }\n\n                    if (call_media_load) {\n                        this._element.load();\n                    }\n\n\n                    attachEventListener(this._element, 'loadedmetadata.' + this._id_event, () => {\n\n                        if (!is_playthrough_mode__normal && !is_playthrough_mode__full) {\n                            this._callback(new CustomEvent('load'));\n                        }\n\n                        if (is_playthrough_mode__full) {\n\n                            let on_progress_replacement_interval = setInterval(() => {\n\n                                let is_error = this._element.readyState > 0 && !this._element.duration;\n\n                                if (is_error || isFullyBuffered(this._element)) {\n\n                                    this._element.currentTime = 0;\n\n                                    if (!is_error && !this._busy && this._element.paused && this._element.matches('[autoplay]')) {\n                                        this._element.play();\n                                    }\n\n                                    clearInterval(on_progress_replacement_interval);\n\n                                    this._callback(new CustomEvent(!is_error ? 'load' : 'error'));\n\n                                } else {\n\n                                    if (!this._element.paused) {\n                                        this._element.pause();\n                                    }\n\n                                    if (!this._busy) {\n                                        this._element.currentTime += 2;\n                                    }\n\n                                }\n\n                            }, 500);\n\n                            this._element[ pluginName +'_'+ this._id_event ] = on_progress_replacement_interval;\n\n                        }\n\n                    }, !this._busy);\n\n                    attachEventListener(this._element, 'canplay.' + this._id_event, () => {\n                        if (is_playthrough_mode__full && this._element.currentTime === 0 && !isFullyBuffered(this._element)) {\n                            this._element.currentTime++;\n                        }\n                    }, !this._busy);\n\n                    attachEventListener(this._element, 'canplaythrough.' + this._id_event, () => {\n                        if (is_playthrough_mode__normal) {\n                            this._callback(new CustomEvent('load'));\n                        }\n                    }, !this._busy);\n\n                } else {\n\n                    return false;\n\n                }\n\n                if (!this._busy) {\n                    this._element[pluginInstance + '_IDEvent'] = this._id_event;\n                }\n\n            }\n\n            this._resource = this._element.currentSrc || this._element.src;\n\n            return !this._busy;\n\n        }\n\n        done(callback) {\n\n            if (typeof callback !== 'function') {\n                return;\n            }\n\n            this._done = function (element, status, resource, id) {\n                callback.apply(this, [element, status, resource, id]);\n            };\n\n        };\n\n        abort() {\n\n            detachEventListener(this._elemnt, '.' + this._id_event);\n\n            if (isLoaded(this._exists ? this._element : this._resource)) {\n                return;\n            }\n\n            const\n                src = this._element.getAttribute('srcset'),\n                srcset = this._element.getAttribute('src');\n\n            if (undefined !== src) {\n                this._element.dataset[src] = this._settings.srcAttr;\n                this._element.setAttribute(this._settings.srcAttr, src);\n                this._element.removeAttribute('src');\n                this._element.removeAttribute('srcset');\n            }\n\n            if (undefined !== srcset) {\n                this._element.dataset[srcset] = this._settings.srcsetAttr;\n                this._element.setAttribute(this._settings.srcsetAttr, srcset);\n                this._element.removeAttribute('src');\n                this._element.removeAttribute('srcset');\n            }\n\n        }\n\n    }\n\n    class ResourcesLoader {\n\n        constructor(collection, options) {\n\n            // todo make _vars really private\n            this._collection = [];\n            this._collection_loaded = [];\n            this._collection_instances = [];\n            this._collection_pending = [];\n            this._resources_loaded = [];\n\n            if (Array.isArray(collection) && (typeof collection[0] === 'string' || isHTMLObject(collection[0]))) {\n                for (const resource in collection) {\n                    if (collection.hasOwnProperty(resource)) {\n                        this._collection.push({ id: generateInstanceID(), resource: collection[resource] });\n                    }\n                }\n            }\n            if (typeof collection === 'string' || isHTMLObject(collection)) {\n                this._collection.push({ id: generateInstanceID(), resource: collection });\n            }\n\n            this._settings = {\n                srcAttr: 'data-src',\n                srcsetAttr: 'data-srcset',\n                playthrough: false,\n                visible: false,\n            };\n            this._settings = { ...this._settings, ...options };\n\n            this.percentage = 0;\n\n            this._done = () => { };\n            this._progress = () => { };\n            this._success = () => { };\n            this._error = () => { };\n\n            this._abort = false;\n            this._loaded = 0;\n            this._complete = false;\n            this._busy = false;\n\n            // self invoking this._loop + force asynchrony (gives time to chain methods synchronously)\n            (this._loop = () => setTimeout(() => this.loop(), 25))();\n\n        }\n\n        loop() {\n\n            this._collection_pending = []; // resets pending elements (sequential opt helper array) every time we loop\n\n            const sequential_mode = true === this._settings.sequential;\n\n            for (let i = 0; i < this._collection.length; i++) {\n\n                if (this._abort) {\n                    break;\n                }\n\n                let this_load_id = this._collection[i].id,\n                    this_load_index = this._collection_instances.findIndex(x => x.id === this_load_id),\n                    this_load_instance = new ResourceLoader(this._settings);\n\n                if (this_load_index === -1) {\n                    this._collection_instances.push({ id: this_load_id, instance: this_load_instance });\n                    this_load_index = this._collection_instances.findIndex(x => x.id === this_load_id);\n                } else {\n                    this._collection_instances[this_load_index].instance = this_load_instance;\n                }\n\n                this_load_instance.resource = this._collection[i];\n\n                this_load_instance.done((element, status, resource, id) => {\n\n                    if (this._complete || this._abort) {\n                        return;\n                    }\n\n                    let a_progress = !isInArray(id, this._collection_loaded);\n\n                    if (a_progress) {\n\n                        this._collection_loaded.push(id);\n                        this._busy = false;\n\n                        this._loaded++;\n                        this.percentage = this._loaded / this._collection.length * 100;\n                        this.percentage = parseFloat(this.percentage.toFixed(4));\n\n                        let this_resource = { resource: resource, status: status };\n                        this._resources_loaded.push(this_resource);\n\n                        this._progress.call(this, this_resource);\n                        this[status !== 'error' ? '_success' : '_error'].call(this, this_resource);\n\n                        if( $ ){ // TODO: clean?\n                            $(element).trigger(pluginPrefix + capitalize(status) + '.' + pluginPrefix, [element, resource]);\n                        }\n\n                    }\n\n                    if (this._loaded === this._collection.length) {\n\n                        this._done.call(this, this._resources_loaded);\n\n                        this._complete = true;\n\n                    } else if (a_progress && sequential_mode) {\n\n                        if (this._collection_pending.length) {\n\n                            this._collection_pending = this._collection_pending.filter(x => x.id !== id);\n                            this._collection_pending = this._collection_pending.filter(x => x.id !== id);\n\n                            if (this._collection_pending.length) {\n                                this._busy = this._collection_pending[0].instance.process();\n                            }\n\n                        }\n\n                    }\n\n                });\n\n                if (!sequential_mode || (sequential_mode && !this._busy)) {\n                    this._busy = this_load_instance.process();\n                }\n\n                else if (sequential_mode && this._busy) {\n\n                    if (!this._settings.visible || (this._settings.visible && isVisible(this_load_instance._element))) {\n                        this._collection_pending.push({ id: this_load_id, instance: this_load_instance });\n                    }\n\n                }\n\n\n            }\n\n        }\n\n        done(callback) { // todo refactory\n\n            if (typeof callback !== 'function') {\n                return;\n            }\n\n            const _func = function (resources) {\n                callback.call(this, resources);\n            };\n\n            if (this._collection.length) {\n\n                this._done = _func;\n\n                this._loop();\n\n            } else {\n                _func();\n            }\n\n        };\n\n        progress(callback) { // todo refactory\n\n            if (typeof callback !== 'function')\n                return;\n\n            const _func = function (resource) {\n                callback.call(this, resource);\n            };\n\n            if (this._collection.length) {\n\n                this._progress = _func;\n\n                this._loop();\n\n            }\n\n        };\n\n        success(callback) { // todo refactory\n\n            if (typeof callback !== 'function') {\n                return;\n            }\n\n            const _func = function (resource) {\n                callback.call(this, resource);\n            };\n\n            if (this._collection.length) {\n\n                this._success = _func;\n\n                this._loop();\n\n            }\n\n        };\n\n        error(callback) { // todo refactory\n\n            if (typeof callback !== 'function') {\n                return;\n            }\n\n            const _func = function (resource) {\n                callback.call(this, resource);\n            };\n\n            if (this._collection.length) {\n\n                this._error = _func;\n\n                this._loop();\n\n            }\n\n        };\n\n        abort() {\n\n            for (const key in this._collection_instances) {\n                this._collection_instances[key].instance.abort();\n            }\n\n            if (this._collection.length) {\n                this._abort = true;\n            }\n\n        };\n\n    }\n\n    // vanilla public interface\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - -\n    // requirejs syntax\n    if (typeof define === 'function' && define.amd) {\n        define(pluginMethod, pluginMethod);\n        // nodejs syntax\n    } else if ('object' === typeof exports) {\n        module.exports[pluginMethod] = pluginMethod;\n        // standard \"global variable\" syntax\n    } else {\n        window[pluginMethod] = pluginMethod;\n    }\n    // - - - - - - - - - - - - - - - - - - - - - - - - - - -\n\n    // from here jQuery is needed\n    // - - - - - - - - - - - - - - - - - - - -\n    if (!$) {\n        return undefined;\n    }\n    // - - - - - - - - - - - - - - - - - - - -\n\n    $[pluginMethod] = ResourcesLoader;\n\n    class CollectionPopulator {\n\n        constructor($element, options) {\n\n            this._$element = $element;\n            this._element = $element[0];\n\n            this._settings = {\n                srcAttr: 'data-src',\n                srcsetAttr: 'data-srcset',\n                backgrounds: false,\n                attributes: []\n            };\n            this._settings = {...this._settings, ...options};\n\n        }\n\n        collect(output) {\n\n            let collection = [];\n\n            const\n                is_plain_data_collection = output === 'plain',\n\n                src = this._settings.srcAttr,\n                srcset = this._settings.srcsetAttr,\n\n                targets = 'img, video, audio',\n                targets_extended = targets + ', picture, source';\n\n            let $targets = this._$element.find(targets);\n            if (this._$element.is(targets)) {\n                $targets = $targets.add(this._$element);\n            }\n            $targets = $targets.filter(function () {\n                let $t = $(this),\n                    filter = '[' + src + '], [' + srcset + ']';\n                return $t.is(filter) || $t.children(targets_extended).filter(filter).length;\n            });\n            $targets.each(function () {\n\n                let collection_item = {\n                    element: this,\n                    resource: $(this).attr(src) || $(this).attr(srcset)\n                };\n\n                if (is_plain_data_collection) {\n                    collection_item = collection_item.element;\n                }\n\n                collection.push(collection_item);\n\n            });\n\n            if (true === this._settings.backgrounds)\n                this._$element.find('*').addBack().not(targets_extended).filter(function () {\n                    return $(this).css('background-image') !== 'none';\n                }).each(function () {\n\n                    const url = $(this).css('background-image').match(/\\((.*?)\\)/);\n\n                    if (null === url || url.length < 2) {\n                        return true;\n                    }\n\n                    let collection_item = {\n                        element: this,\n                        resource: url[1].replace(/('|\")/g, '')\n                    };\n\n                    if (is_plain_data_collection) {\n                        collection_item = collection_item.resource;\n                    }\n\n                    collection.push(collection_item);\n\n                });\n\n            if (this._settings.attributes.length)\n                for (const attr in this._settings.attributes) {\n                    if (this._settings.attributes.hasOwnProperty(attr)) {\n\n                        this._$element.find('[' + attr + ']:not(' + targets_extended + ')').each(function () {\n\n                            let collection_item = {\n                                element: this,\n                                resource: $(this).attr(attr)\n                            };\n\n                            if (is_plain_data_collection) {\n                                collection_item = collection_item.resource;\n                            }\n\n                            collection.push(collection_item);\n\n                        });\n\n                        if (this._$element.is('[' + attr + ']') && !this._$element.is(targets_extended)) {\n\n                            let collection_item = {\n                                element: this._element,\n                                resource: this._$element.attr(attr)\n                            };\n\n                            if (is_plain_data_collection) {\n                                collection_item = collection_item.resource;\n                            }\n\n                            collection.push(collection_item);\n\n                        }\n\n                    }\n                }\n\n            return collection;\n\n        }\n\n    }\n\n    const\n        $document = $(document),\n        $window = $(window),\n        // thanks https://gist.github.com/beaucharman/e46b8e4d03ef30480d7f4db5a78498ca\n        throttle = (callback, wait, context = this) => {\n            let timeout = null,\n                callbackArgs = null\n            const later = () => {\n                callback.apply(context, callbackArgs)\n                timeout = null\n            }\n            return function () {\n                if (!timeout) {\n                    callbackArgs = arguments\n                    timeout = setTimeout(later, wait)\n                }\n            }\n        };\n\n    let method_collection = [];\n\n    $.fn[pluginMethod] = function (options) {\n\n        let original_user_options = options;\n\n        if (typeof options !== 'object') {\n            options = {};\n        }\n\n        let settings = {\n\n            srcAttr: 'data-src',\n            srcsetAttr: 'data-srcset',\n\n            visible: false,\n\n            sequential: false,\n\n            backgrounds: false,\n            extraAttrs: [],\n\n            playthrough: false,\n\n            early: false,\n            earlyTimeout: 0,\n\n            onProgress: () => { },\n            onLoad: () => { },\n            onError: () => { },\n\n            onComplete: () => { },\n\n        };\n        settings = {...settings,...options};\n\n        let callback = settings.onComplete;\n        if ($.isFunction(original_user_options)) {\n            callback = original_user_options;\n        }\n\n        if (!$.isArray(settings.attributes)) {\n            settings.attributes = [];\n        }\n        if (typeof settings.attributes === 'string') {\n            settings.attributes = settings.attributes.split(' ');\n        }\n\n        return this.each(function (i) {\n\n            const\n                element = this,\n                $element = $(element),\n                collection = new CollectionPopulator($element, settings).collect('plain'),\n                unique_method_pluginName = generateInstanceID() + i,\n\n                this_load_instance = new ResourcesLoader(collection, settings);\n\n            method_collection.push({\n                id: unique_method_pluginName,\n                instance: this_load_instance,\n                element: element,\n                timeout: null\n            });\n\n            this_load_instance.progress(function (resource) {\n\n                $element.trigger(pluginPrefix + 'Progress.' + pluginPrefix, [element, resource]);\n\n                const this_arguments = [this_load_instance, resource];\n\n                if (typeof settings.onProgress === 'function') {\n                    settings.onProgress.apply(element, this_arguments);\n                }\n\n                let event_name = capitalize(resource.status);\n                if (typeof settings['on' + event_name] === 'function') {\n                    settings['on' + event_name].apply(element, this_arguments);\n                }\n\n            });\n\n            this_load_instance.done(function (resources) {\n\n                $element.trigger(pluginPrefix + 'Complete.' + pluginPrefix, [element, resources]);\n                callback.apply(element, [this_load_instance, resources]);\n\n                if (settings.visible) {\n                    $window.off('scroll.' + unique_method_pluginName);\n                }\n\n                // refresh other method calls for same el (omitting this one)\n                method_collection = method_collection.filter(x => x.id !== unique_method_pluginName);\n                method_collection.forEach((this_method_collection) => {\n                    if ($element.is(this_method_collection.element)) {\n                        this_method_collection.instance.loop();\n                    }\n                });\n\n            });\n\n            if (settings.visible) {\n                $window.on('scroll.' + unique_method_pluginName, throttle(() => this_load_instance.loop(), 250));\n            }\n\n            if (true === settings.early) for (let key in method_collection) {\n\n                let this_method_collection = method_collection[key];\n\n                if (method_collection[key].id === unique_method_pluginName) {\n\n                    clearTimeout(this_method_collection.timeout);\n\n                    let timeout = parseInt(settings.earlyTimeout);\n\n                    this_method_collection.timeout = setTimeout(function () {\n\n                        // todo appropriate method for setting settings?\n                        this_method_collection.instance._settings.visible = false;\n                        this_method_collection.instance._settings.sequential = true;\n\n                        this_method_collection.instance.loop();\n\n                    }, !isNaN(timeout) && isFinite(timeout) ? timeout : 0);\n\n                    break;\n\n                }\n\n            }\n\n        });\n\n    };\n\n})(window, document, jQuery);"],"file":"nite.loader.min.js"}