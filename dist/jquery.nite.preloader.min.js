"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(function(a,b,c){"use strict";if(!c)return console.error("jQuery is needed for $.fn.nitePreload(), $.nitePreload, $.niteLazyLoad to work!"),void 0;var d="nite",f=d+"Preload",g=d+"er",h=c(b),i=function(a){var b=c();if("string"!=typeof a)return!1;try{b=c(a)}catch(a){return!1}return b.length},j=function(a,b){if(a=a.toLowerCase().split("?")[0],""===a)return!1;var c={image:"jp[e]?g|gif|png|tif[f]?|bmp",audio:"mp3|ogg",video:"mp4|ogv|ogg|webm"},d=void 0===b?Object.keys(c):[b],f={format:null,extension:null};for(var g in d)if(new RegExp("(.("+c[d[g]]+")$)|"+";base64,","g").test(a))if(/;base64,/g.test(a)){var h=a.match(new RegExp("^data:"+d[g]+"/("+c[d[g]]+")","g"));if(!h||null===h){console.warn(a+": base64 "+d[g]+" format not recognized.");continue}h=h[0],f={format:h.replace("data:"+d[g]+"/g",""),extension:"base64"};break}else{var i=a.match(new RegExp(c[d[g]],"g"));if(i){f={format:d[g],extension:i[0]};break}}return f},k=function(){function a(b){_classCallCheck(this,a);var f=this;this._settings=b,this._element=null,this._$element=c(),this._resource=null,this._format=null,this._instance=null,this._processed=!1,this._callback=c.noop,this._done=function(a){f._callback.call(null,f._resource),f._processed||(f._$element.trigger(a.type+"."+d),h.trigger(a.type+"."+d,[this._$element]))}}return _createClass(a,[{key:"abort",value:function(){this._$element.filter("[src], [srcset]").data(this._settings.srcsetAttr,this._$element.attr("srcset")).data(this._settings.srcAttr,this._$element.attr("src")).attr(this._settings.srcsetAttr,this._$element.attr("srcset")).attr(this._settings.srcAttr,this._$element.attr("src")).removeAttr("src").removeAttr("srcset").end().off("load."+this._instance+" error."+this._instance)}},{key:"done",value:function(a){if(c.isFunction(a)){var b=this;this._callback=function(c){console.log(c),a.call(b,c)}}}},{key:"resource",set:function(a){var d="object"===("undefined"==typeof a?"undefined":_typeof(a))&&"standard"in a,f=d&&!0===a.standard,h="string"==typeof a;if(!d&&!h)return!1;this;switch((h||!f)&&(this._format=j(a).format,this._element="image"===this._format?new Image:b.createElement(this._format),this._settings.srcsetAttr="data-srcset",this._settings.srcAttr="data-src",this._resource=a),this._$element=c(this._element),(h||!f)&&this._$element.data(this._settings.srcAttr.replace("data-",""),this._resource).data(this._settings.srcsetAttr.replace("data-",""),this._resource).attr(this._settings.srcAttr,this._resource).attr(this._settings.srcsetAttr,this._resource),!h&&f&&(this._element=a.element,this._format=a.format,this._$element=c(this._element)),this._instance=this._$element.data(g),this._processed=void 0!==this._instance,this._instance=this._processed?this._instance:g+"_unique_"+(c.nite?c.nite.uniqueId():Math.random(1e3,9999)),this._format){case"image":this._$element[this._processed?"on":"one"]("load."+this._instance+" error."+this._instance,this._done);var i=this._$element.closest("picture"),k=this._settings.srcAttr,l=this._settings.srcAttr.replace("data-",""),m=this._settings.srcsetAttr,n=this._settings.srcsetAttr.replace("data-","");i.length?(this._$element.removeData(n).removeAttr(m).removeData(l).removeAttr(k),i.find("source[data-srcset]").attr("srcset",i.data("srcset")).removeData(n).removeAttr(m)):(this._$element.is("[data-srcset]")&&this._$element.attr("srcset",this._$element.data("srcset")).removeData(n).removeAttr(m),this._$element.is("[data-src]")&&this._$element.attr("src",this._$element.data("src")).removeData(l).removeAttr(k)),this._resource=this._element.currentSrc||this._element.src,!0===this._element.complete&&0!==this._element.naturalWidth&&0!==this._element.naturalHeight&&(!this._processed&&this._$element.off("."+this._instance),this._done.call(new Event(void 0===this._element.naturalWidth?"error":"load")));break;case"media":break;case"iframe":}this._processed||this._$element.data(g,this._instance)}}]),a}(),l=function(){function a(b,d){var f=this;_classCallCheck(this,a);var g=this;if(this._collection=[],c.isArray(b)&&("string"==typeof b[0]||"object"===_typeof(b[0])&&"subject"in b[0])&&(this._collection=b),"string"==typeof b&&this._collection.push(b),this._settings=c.extend(!0,{sequential:!1,pipelineDelay:0,playthrough:!1},d),this.percentage=0,this._callback=c.noop(),this._progress=c.noop(),this._abort=!1,this._load_instances=[new k(this._settings)],this._collection.length)if(!0!==this._settings.sequential)(function(){for(var a,b=0,c=0;c<f._collection.length&&!f._abort;c++)a=new k(f._settings),f._load_instances.push(a),a.resource=f._collection[c],a.done(function(a){b++,g.percentage=100*(b/g._collection.length),g._progress.call(null,a),b>g._collection.length||g._abort||b===g._collection.length&&g._callback.call(null)})})();else{var h=-1,i=function a(){h++,h>this._collection.length||this._abort||(h===this._collection.length&&this._callback.call(null),this._load_instances[0].resource=this._collection[h],this._load_instances[0].done(function(b){g.percentage=100*(h/g._collection.length),g._progress.call(null,b),setTimeout(a,c.isNumeric(this._settings.pipelineDelay)?parseInt(this._settings.pipelineDelay):0)}))};i()}}return _createClass(a,[{key:"done",value:function(a){if(c.isFunction(a)){var b=this,d=function(){a.call(b)};this._collection.length?this._callback=d:d()}}},{key:"progress",value:function(a){if(c.isFunction(a)){var b=this,d=function(c){a.call(b,c)};this._collection.length?this._progress=d:d()}}},{key:"abort",value:function(){for(var a in this._load_instances)this._load_instances[a].abort();this._collection.length&&(this._abort=!0)}}]),a}(),m=function(){function a(b,c){_classCallCheck(this,a),this._$element=b,this._settings=c}return _createClass(a,[{key:"collect",value:function(){var a=[],b="img, video, audio, iframe",d=b+", picture, source",f=this._$element.find(b);if(this._$element.is(b)&&f.add($element),f.each(function(){a.push({element:this,resource:this.currentSrc||this.src,standard:!0})}),!0===this._settings.backgrounds&&this._$element.find("*").addBack().not(d).filter(function(){return"none"!==c(this).css("background-image")}).each(function(){a.push({element:this,resource:c(this).css("background-image").replace(/url\(\"|url\(\'|url\(|((\"|\')\)$)/igm,""),standard:!1})}),this._settings.attributes.length){var g=function(b){this._$element.find("["+b+"]:not("+d+")").each(function(){a.push({element:this,resource:c(this).attr(b),standard:!1})}),this._$element.is("["+b+"]")&&!this._$element.is(d)&&a.add({element:this,resource:this._$element.attr(b),standard:!1})};for(let a in this._settings.attributes)g(a)}return a}}]),a}();c[f]=l,c.fn[f]=function(a,b){c.isFunction(a)&&(b=a),c.isFunction(b)||(b=c.noop),"object"!==("undefined"==typeof a?"undefined":_typeof(a))&&(a={});var d=c.extend(!0,{srcAttr:"data-src",srcsetAttr:"data-srcset",sequential:!1,pipelineDelay:0,extraAttrs:[],backgrounds:!1,playthrough:!1},a);return c.isArray(d.attributes)||(d.attributes=[]),"string"==typeof d.attributes&&(d.attributes=d.attributes.split(" ")),this.each(function(){var a=this,f=c(a),h=f.data(g);void 0!==h&&h.abort(),h=new l(new m(f,d).collect(),d),h.progress(function(){}),h.done(function(){b.call(a)}),f.data(g,h)})},c[d+"Lazyload"]=function(a){return c.nite&&"inViewport"in c.nite&&"scroll"in c.nite?void c.nite.scroll(g,function(){c(i(a)?a:"[data-nite-src]").inViewport()[f](function(){var a=c(this);a.trigger(e.type+"."+d+"LazyLoad"),h.trigger(e.type+"."+d+"LazyLoad",[a])})},{fps:25}):void console.log("A recent version of $.nite is needed.")}})(window,document,jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5uaXRlLnByZWxvYWRlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiMGtCQUFBLENBQ0EsQ0FBQyxBQUFTLEFBQVEsQUFBVSxBQUFHLGVBQVUsQUFDckMsQ0FFQSxBQUNBLGdCQUFBLEFBQUksQUFBQyxBQUFJLEFBQ0wsR0FDQSxBQUFPLEFBQ1YsQUFDRCxBQUdBLGVBTkksQUFBUSxNQUFSLEFBQWMsQUFDZCw2RkFNQSxHQURKLEFBQ3VCLE9BQ25CLEVBQW1CLEVBRnZCLEFBRXdDLFVBQ3BDLEVBQVksRUFIaEIsQUFHaUMsS0FFN0IsRUFMSixBQUtnQixBQUFFLEtBRWQsRUFBQSxBQUFvQixBQUFTLFdBQVMsQUFFbEMsSUFBSSxHQUFKLEFBQWUsQUFFZixPQUFBLEFBQTBCLFFBQXJCLEFBQU8sV0FDUixBQUFPLEFBRVgsWUFBSSxBQUVBLEdBQUEsQUFBVyxBQUFFLEFBRWhCLElBSkQsQ0FJRSxBQUFNLFFBQU8sQUFFWCxDQUFBLEFBQU8sQUFFVixRQUVELE9BQU8sR0FBUCxBQUFnQixBQUNuQixNQXpCTCxFQTJCSSxFQUFBLEFBQVksQUFBVSxBQUFRLGFBQWlCLEFBRTNDLE1BQVMsRUFBQSxBQUNKLGNBREksQUFFSixNQUZJLEFBRUUsS0FKZ0MsQUFFM0MsQUFBUyxBQUVPLEFBQUksQUFFcEIsR0FBQSxBQUFlLEVBQVgsS0FDQSxBQUFPLEFBRVgsWUFDSSxHQUFVLEFBQ04sT0FETSxBQUNFLEFBQ1Isb0NBRk0sQUFFRSxBQUNSLGdCQUpSLEFBQ2MsQUFHRSxBQUVaLG9CQUNBLEVBQWdCLEFBQWMsV0FBd0MsT0FQMUUsQUFPMEUsQUFBTyxBQUFLLEFBRXRGLFFBRm9CLEFBQWdDLEFBQUUsSUFFbEQsRUFBUyxDQUFFLE9BQUYsQUFBVyxLQUFNLFVBQTlCLEFBQWEsQUFBNkIsQUFFMUMsVUFBSyxHQUFMLEFBQVMsQUFBSyxBQUFnQixBQUUxQixXQUFJLEdBQUEsQUFBSSxRQUFPLE1BQVMsRUFBVCxBQUFTLEFBQVMsQUFBYyxNQUEzQyxBQUFX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QUFFaEUsSUFQRCxBQVNILEVBWEQsRUFXRyxDQUFFLElBWEwsQUFXRyxBQUFRLEFBRWQsa0JBbkJPLEFBQVEsSUFBUixBQUFZLEFBRVosQUFFSCxBQUVELHdDQVZKLEFBeUJILENBOWtCRCxHQUFBLEFBOGtCRyxPQTlrQkgsQUE4a0JXLFNBOWtCWCxBQThrQnFCIiwiZmlsZSI6ImpxdWVyeS5uaXRlLnByZWxvYWRlci5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKiEgSlF1ZXJ5IEhlYXZ5IFJlc291cmNlc0xvYWRlciB8IERhbmllbGUgRmlvcm9uaSB8IGRmaW9yb25pOTFAZ21haWwuY29tICovXG4oZnVuY3Rpb24od2luZG93LCBkb2N1bWVudCwgJCwgdW5kZWZpbmVkKXtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICAvLyB+IH4gfiB+IH4gfiB+IH4gfiB+IH4gflxuICAgIGlmKCAhJCApIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignalF1ZXJ5IGlzIG5lZWRlZCBmb3IgJC5mbi5uaXRlUHJlbG9hZCgpLCAkLm5pdGVQcmVsb2FkLCAkLm5pdGVMYXp5TG9hZCB0byB3b3JrIScpO1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICAvLyB+IH4gfiB+IH4gfiB+IH4gfiB+IH4gflxuXG5cbiAgICBjb25zdFxuICAgICAgICBuYW1lc3BhY2VfcHJlZml4ID0gJ25pdGUnLFxuICAgICAgICBuYW1lc3BhY2VfbWV0aG9kID0gbmFtZXNwYWNlX3ByZWZpeCsnUHJlbG9hZCcsXG4gICAgICAgIG5hbWVzcGFjZSA9IG5hbWVzcGFjZV9wcmVmaXgrJ2VyJyxcblxuICAgICAgICAkZG9jdW1lbnQgPSAkKGRvY3VtZW50KSxcblxuICAgICAgICBpc192YWxpZF9zZWxlY3RvciA9IGZ1bmN0aW9uKHNlbGVjdG9yKXtcblxuICAgICAgICAgICAgbGV0ICRlbGVtZW50ID0gJCgpO1xuXG4gICAgICAgICAgICBpZiAoIHR5cGVvZihzZWxlY3RvcikgIT09ICdzdHJpbmcnIClcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgIHRyeSB7XG5cbiAgICAgICAgICAgICAgICAkZWxlbWVudCA9ICQoc2VsZWN0b3IpO1xuXG4gICAgICAgICAgICB9IGNhdGNoKGVycm9yKSB7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuICRlbGVtZW50Lmxlbmd0aDtcbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGlzX2Zvcm1hdCA9IGZ1bmN0aW9uKCBzdHJpbmcsIGV4cGVjdGVkX2Zvcm1hdCApe1xuICAgIFxuICAgICAgICAgICAgc3RyaW5nID0gc3RyaW5nXG4gICAgICAgICAgICAgICAgLnRvTG93ZXJDYXNlKClcbiAgICAgICAgICAgICAgICAuc3BsaXQoJz8nKVswXTsgLy8gZ2V0IHJpZCBvZiBxdWVyeSBzdHJpbmdzXG4gICAgXG4gICAgICAgICAgICBpZiggc3RyaW5nID09PSAnJyAgKVxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICBcbiAgICAgICAgICAgIGNvbnN0XG4gICAgICAgICAgICAgICAgZm9ybWF0cyA9IHtcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2UgOiAnanBbZV0/Z3xnaWZ8cG5nfHRpZltmXT98Ym1wJyxcbiAgICAgICAgICAgICAgICAgICAgYXVkaW8gOiAnbXAzfG9nZycsXG4gICAgICAgICAgICAgICAgICAgIHZpZGVvIDogJ21wNHxvZ3Z8b2dnfHdlYm0nXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBiYXNlNjRfaGVhZGluZyA9ICdcXDtiYXNlNjRcXCwnLFxuICAgICAgICAgICAgICAgIGZvcm1hdHNfcXVldWUgPSB1bmRlZmluZWQgIT09IGV4cGVjdGVkX2Zvcm1hdCA/IFsgZXhwZWN0ZWRfZm9ybWF0IF0gOiBPYmplY3Qua2V5cyhmb3JtYXRzKTtcblxuICAgICAgICAgICAgbGV0IG91dHB1dCA9IHsgZm9ybWF0IDogbnVsbCwgZXh0ZW5zaW9uIDogbnVsbCB9O1xuXG4gICAgICAgICAgICBmb3IoIGxldCB4IGluIGZvcm1hdHNfcXVldWUgKSB7XG5cbiAgICAgICAgICAgICAgICBpZiAobmV3IFJlZ0V4cCgnKFxcLignICsgZm9ybWF0c1sgZm9ybWF0c19xdWV1ZVt4XSBdICsgJykkKXwnICsgYmFzZTY0X2hlYWRpbmcsICdnJykudGVzdChzdHJpbmcpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKG5ldyBSZWdFeHAoYmFzZTY0X2hlYWRpbmcsICdnJykudGVzdChzdHJpbmcpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtYXRjaGVzNjQgPSBzdHJpbmcubWF0Y2gobmV3IFJlZ0V4cCgnXmRhdGE6JyArICBmb3JtYXRzX3F1ZXVlW3hdICArICdcXC8oJyArIGZvcm1hdHNbIGZvcm1hdHNfcXVldWVbeF0gXSArICcpJywgJ2cnKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghbWF0Y2hlczY0IHx8IG51bGwgPT09IG1hdGNoZXM2NCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS53YXJuKHN0cmluZyArICc6IGJhc2U2NCAnICsgIGZvcm1hdHNfcXVldWVbeF0gICsgJyBmb3JtYXQgbm90IHJlY29nbml6ZWQuJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRjaGVzNjQgPSBtYXRjaGVzNjRbMF07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dCA9IHsgZm9ybWF0IDogbWF0Y2hlczY0LnJlcGxhY2UoJ2RhdGE6JyArICBmb3JtYXRzX3F1ZXVlW3hdICArICcvZycsICcnKSwgZXh0ZW5zaW9uIDogJ2Jhc2U2NCcgfTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1hdGNoZXMgPSBzdHJpbmcubWF0Y2gobmV3IFJlZ0V4cChmb3JtYXRzWyBmb3JtYXRzX3F1ZXVlW3hdIF0sICdnJykpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggbWF0Y2hlcyApe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0geyBmb3JtYXQgOiBmb3JtYXRzX3F1ZXVlW3hdLCBleHRlbnNpb24gOiBtYXRjaGVzWzBdIH07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gb3V0cHV0O1xuICAgIFxuICAgICAgICB9O1xuXG4gICAgY2xhc3MgUmVzb3VyY2VMb2FkZXIge1xuXG4gICAgICAgIGNvbnN0cnVjdG9yKHNldHRpbmdzKXtcblxuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3M7XG5cbiAgICAgICAgICAgIHRoaXMuX2VsZW1lbnQgID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuXyRlbGVtZW50ID0gJCgpO1xuXG4gICAgICAgICAgICB0aGlzLl9yZXNvdXJjZSA9IG51bGw7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRoaXMuX2Zvcm1hdCAgICA9IG51bGw7XG4gICAgICAgICAgICB0aGlzLl9pbnN0YW5jZSAgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fcHJvY2Vzc2VkID0gZmFsc2U7XG5cbiAgICAgICAgICAgIHRoaXMuX2NhbGxiYWNrICA9ICQubm9vcDtcbiAgICAgICAgICAgIHRoaXMuX2RvbmUgID0gZnVuY3Rpb24oZSl7XG5cbiAgICAgICAgICAgICAgICBzZWxmLl9jYWxsYmFjay5jYWxsKG51bGwgLyp0ZW1wKi8sIHNlbGYuX3Jlc291cmNlKTtcblxuICAgICAgICAgICAgICAgIGlmKCBzZWxmLl9wcm9jZXNzZWQgKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICAgICBzZWxmLl8kZWxlbWVudC50cmlnZ2VyKGUudHlwZSArICcuJytuYW1lc3BhY2VfcHJlZml4KTtcbiAgICAgICAgICAgICAgICAkZG9jdW1lbnQudHJpZ2dlcihlLnR5cGUgKyAnLicrbmFtZXNwYWNlX3ByZWZpeCwgW3RoaXMuXyRlbGVtZW50XSk7XG5cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgc2V0IHJlc291cmNlKCByZXNvdXJjZSApe1xuXG4gICAgICAgICAgICBjb25zdFxuICAgICAgICAgICAgICAgIHJlY29nbml6ZWRfcmVzb3VyY2UgPSB0eXBlb2YgcmVzb3VyY2UgPT09ICdvYmplY3QnICYmICdzdGFuZGFyZCcgaW4gcmVzb3VyY2UsXG4gICAgICAgICAgICAgICAgc3RhbmRhcmRfcmVzb3VyY2UgICA9IHJlY29nbml6ZWRfcmVzb3VyY2UgJiYgcmVzb3VyY2Uuc3RhbmRhcmQgPT09IHRydWUsXG4gICAgICAgICAgICAgICAgc3RyaW5nX3Jlc291cmNlICAgICA9IHR5cGVvZiByZXNvdXJjZSA9PT0gJ3N0cmluZyc7XG5cbiAgICAgICAgICAgIGlmKCAhcmVjb2duaXplZF9yZXNvdXJjZSAmJiAhc3RyaW5nX3Jlc291cmNlIClcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICBpZiggc3RyaW5nX3Jlc291cmNlIHx8ICFzdGFuZGFyZF9yZXNvdXJjZSApe1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fZm9ybWF0ID0gaXNfZm9ybWF0KHJlc291cmNlKS5mb3JtYXQ7XG5cbiAgICAgICAgICAgICAgICBpZiggdGhpcy5fZm9ybWF0ID09PSAnaW1hZ2UnIClcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZWxlbWVudCA9IG5ldyBJbWFnZSgpO1xuICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGhpcy5fZm9ybWF0KTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX3NldHRpbmdzLnNyY3NldEF0dHIgPSAnZGF0YS1zcmNzZXQnO1xuICAgICAgICAgICAgICAgIHRoaXMuX3NldHRpbmdzLnNyY0F0dHIgICAgPSAnZGF0YS1zcmMnO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVzb3VyY2UgPSByZXNvdXJjZTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLl8kZWxlbWVudCA9ICQodGhpcy5fZWxlbWVudCk7XG5cbiAgICAgICAgICAgIGlmKCBzdHJpbmdfcmVzb3VyY2UgfHwgIXN0YW5kYXJkX3Jlc291cmNlICl7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl8kZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICAuZGF0YSh0aGlzLl9zZXR0aW5ncy5zcmNBdHRyLnJlcGxhY2UoJ2RhdGEtJywgJycpLCB0aGlzLl9yZXNvdXJjZSlcbiAgICAgICAgICAgICAgICAgICAgLmRhdGEodGhpcy5fc2V0dGluZ3Muc3Jjc2V0QXR0ci5yZXBsYWNlKCdkYXRhLScsICcnKSwgdGhpcy5fcmVzb3VyY2UpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKHRoaXMuX3NldHRpbmdzLnNyY0F0dHIsIHRoaXMuX3Jlc291cmNlKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cih0aGlzLl9zZXR0aW5ncy5zcmNzZXRBdHRyLCB0aGlzLl9yZXNvdXJjZSk7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYoICFzdHJpbmdfcmVzb3VyY2UgJiYgc3RhbmRhcmRfcmVzb3VyY2UgKXtcblxuICAgICAgICAgICAgICAgIHRoaXMuX2VsZW1lbnQgPSByZXNvdXJjZS5lbGVtZW50O1xuICAgICAgICAgICAgICAgIHRoaXMuX2Zvcm1hdCAgPSByZXNvdXJjZS5mb3JtYXQ7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl8kZWxlbWVudCA9ICQodGhpcy5fZWxlbWVudCk7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5faW5zdGFuY2UgID0gdGhpcy5fJGVsZW1lbnQuZGF0YShuYW1lc3BhY2UpO1xuICAgICAgICAgICAgdGhpcy5fcHJvY2Vzc2VkID0gdGhpcy5faW5zdGFuY2UgIT09IHVuZGVmaW5lZDtcblxuICAgICAgICAgICAgdGhpcy5faW5zdGFuY2UgID0gdGhpcy5fcHJvY2Vzc2VkID8gdGhpcy5faW5zdGFuY2UgOiBuYW1lc3BhY2UgKyAnX3VuaXF1ZV8nICsgKCAkLm5pdGUgPyAkLm5pdGUudW5pcXVlSWQoKSA6IE1hdGgucmFuZG9tKDEwMDAsIDk5OTkpICk7XG5cbiAgICAgICAgICAgIHN3aXRjaCggdGhpcy5fZm9ybWF0ICkge1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnaW1hZ2UnOlxuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuXyRlbGVtZW50WyB0aGlzLl9wcm9jZXNzZWQgPyAnb24nIDogJ29uZSddKCdsb2FkLicgKyB0aGlzLl9pbnN0YW5jZSArICcgZXJyb3IuJyArIHRoaXMuX2luc3RhbmNlLCB0aGlzLl9kb25lKTtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdFxuICAgICAgICAgICAgICAgICAgICAgICAgJHBpY3R1cmUgICAgID0gdGhpcy5fJGVsZW1lbnQuY2xvc2VzdCgncGljdHVyZScpLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3JjICAgICAgICAgID0gdGhpcy5fc2V0dGluZ3Muc3JjQXR0cixcbiAgICAgICAgICAgICAgICAgICAgICAgIHNyY19jbGVhbiAgICA9IHRoaXMuX3NldHRpbmdzLnNyY0F0dHIucmVwbGFjZSgnZGF0YS0nLCAnJyksXG4gICAgICAgICAgICAgICAgICAgICAgICBzcmNzZXQgICAgICAgPSB0aGlzLl9zZXR0aW5ncy5zcmNzZXRBdHRyLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3Jjc2V0X2NsZWFuID0gdGhpcy5fc2V0dGluZ3Muc3Jjc2V0QXR0ci5yZXBsYWNlKCdkYXRhLScsICcnKTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoJHBpY3R1cmUubGVuZ3RoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuXyRlbGVtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZURhdGEoc3Jjc2V0X2NsZWFuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVBdHRyKHNyY3NldClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlRGF0YShzcmNfY2xlYW4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUF0dHIoc3JjKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgJHBpY3R1cmUuZmluZCgnc291cmNlW2RhdGEtc3Jjc2V0XScpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3NyY3NldCcsICRwaWN0dXJlLmRhdGEoJ3NyY3NldCcpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVEYXRhKHNyY3NldF9jbGVhbilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQXR0cihzcmNzZXQpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCB0aGlzLl8kZWxlbWVudC5pcygnW2RhdGEtc3Jjc2V0XScpIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl8kZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cignc3Jjc2V0JywgdGhpcy5fJGVsZW1lbnQuZGF0YSgnc3Jjc2V0JykpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVEYXRhKHNyY3NldF9jbGVhbilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUF0dHIoc3Jjc2V0KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIHRoaXMuXyRlbGVtZW50LmlzKCdbZGF0YS1zcmNdJykgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuXyRlbGVtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCdzcmMnLCB0aGlzLl8kZWxlbWVudC5kYXRhKCdzcmMnKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZURhdGEoc3JjX2NsZWFuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQXR0cihzcmMpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXNvdXJjZSA9IHRoaXMuX2VsZW1lbnQuY3VycmVudFNyYyB8fCB0aGlzLl9lbGVtZW50LnNyYztcblxuICAgICAgICAgICAgICAgICAgICBpZiAodHJ1ZSA9PT0gdGhpcy5fZWxlbWVudC5jb21wbGV0ZSAmJiB0aGlzLl9lbGVtZW50Lm5hdHVyYWxXaWR0aCAhPT0gMCAmJiB0aGlzLl9lbGVtZW50Lm5hdHVyYWxIZWlnaHQgIT09IDApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAhdGhpcy5fcHJvY2Vzc2VkIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl8kZWxlbWVudC5vZmYoJy4nICsgdGhpcy5faW5zdGFuY2UpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9kb25lLmNhbGwobmV3IEV2ZW50KHVuZGVmaW5lZCAhPT0gdGhpcy5fZWxlbWVudC5uYXR1cmFsV2lkdGggPyAnbG9hZCcgOiAnZXJyb3InKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgY2FzZSAnbWVkaWEnOlxuXG5cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ2lmcmFtZSc6XG5cblxuXG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICB9XG5cblxuICAgICAgICAgICAgaWYgKCAhdGhpcy5fcHJvY2Vzc2VkIClcbiAgICAgICAgICAgICAgICB0aGlzLl8kZWxlbWVudC5kYXRhKG5hbWVzcGFjZSwgdGhpcy5faW5zdGFuY2UpO1xuXG4gICAgICAgIH1cblxuICAgICAgICBhYm9ydCgpe1xuXG4gICAgICAgICAgICB0aGlzLl8kZWxlbWVudFxuICAgICAgICAgICAgICAgIC5maWx0ZXIoJ1tzcmNdLCBbc3Jjc2V0XScpXG4gICAgICAgICAgICAgICAgICAgIC5kYXRhKHRoaXMuX3NldHRpbmdzLnNyY3NldEF0dHIsIHRoaXMuXyRlbGVtZW50LmF0dHIoJ3NyY3NldCcpKVxuICAgICAgICAgICAgICAgICAgICAuZGF0YSh0aGlzLl9zZXR0aW5ncy5zcmNBdHRyLCB0aGlzLl8kZWxlbWVudC5hdHRyKCdzcmMnKSlcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIodGhpcy5fc2V0dGluZ3Muc3Jjc2V0QXR0ciwgdGhpcy5fJGVsZW1lbnQuYXR0cignc3Jjc2V0JykpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKHRoaXMuX3NldHRpbmdzLnNyY0F0dHIsIHRoaXMuXyRlbGVtZW50LmF0dHIoJ3NyYycpKVxuICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQXR0cignc3JjJykucmVtb3ZlQXR0cignc3Jjc2V0JylcbiAgICAgICAgICAgICAgICAuZW5kKClcbiAgICAgICAgICAgICAgICAub2ZmKCdsb2FkLicgKyB0aGlzLl9pbnN0YW5jZSArICcgZXJyb3IuJyArIHRoaXMuX2luc3RhbmNlKTtcblxuICAgICAgICB9XG5cbiAgICAgICAgZG9uZShjYWxsYmFjayl7XG5cbiAgICAgICAgICAgIGlmKCAhJC5pc0Z1bmN0aW9uKGNhbGxiYWNrKSApXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICBjb25zdCBjb250ZXh0ID0gdGhpcztcblxuICAgICAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBmdW5jdGlvbihyZXNvdXJjZSl7XG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2cocmVzb3VyY2UpXG4gICAgICAgICAgICAgICAgY2FsbGJhY2suY2FsbChjb250ZXh0LCByZXNvdXJjZSk7XG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH07XG5cbiAgICB9XG4gICAgXG4gICAgY2xhc3MgUmVzb3VyY2VzTG9hZGVyIHtcblxuICAgICAgICBjb25zdHJ1Y3Rvcihjb2xsZWN0aW9uLCBvcHRpb25zKSB7XG5cbiAgICAgICAgICAgIGNvbnN0IHNlbGYgPSB0aGlzO1xuXG4gICAgICAgICAgICB0aGlzLl9jb2xsZWN0aW9uID0gW107XG5cbiAgICAgICAgICAgIGlmICgkLmlzQXJyYXkoY29sbGVjdGlvbikgJiYgKCB0eXBlb2YgY29sbGVjdGlvblswXSA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIGNvbGxlY3Rpb25bMF0gPT09ICdvYmplY3QnICYmICdzdWJqZWN0JyBpbiBjb2xsZWN0aW9uWzBdICkpXG4gICAgICAgICAgICAgICAgdGhpcy5fY29sbGVjdGlvbiA9IGNvbGxlY3Rpb247XG5cbiAgICAgICAgICAgIGlmICh0eXBlb2YgY29sbGVjdGlvbiA9PT0gJ3N0cmluZycpXG4gICAgICAgICAgICAgICAgdGhpcy5fY29sbGVjdGlvbi5wdXNoKGNvbGxlY3Rpb24pO1xuXG4gICAgICAgICAgICB0aGlzLl9zZXR0aW5ncyA9ICQuZXh0ZW5kKHRydWUsIHtcbiAgICAgICAgICAgICAgICBzZXF1ZW50aWFsOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBwaXBlbGluZURlbGF5OiAwLFxuICAgICAgICAgICAgICAgIHBsYXl0aHJvdWdoOiBmYWxzZVxuICAgICAgICAgICAgfSwgb3B0aW9ucyk7XG5cbiAgICAgICAgICAgIHRoaXMucGVyY2VudGFnZSA9IDA7XG5cbiAgICAgICAgICAgIHRoaXMuX2NhbGxiYWNrID0gJC5ub29wKCk7XG4gICAgICAgICAgICB0aGlzLl9wcm9ncmVzcyA9ICQubm9vcCgpO1xuICAgICAgICAgICAgdGhpcy5fYWJvcnQgPSBmYWxzZTtcblxuICAgICAgICAgICAgdGhpcy5fbG9hZF9pbnN0YW5jZXMgPSBbIG5ldyBSZXNvdXJjZUxvYWRlcih0aGlzLl9zZXR0aW5ncykgXTtcblxuICAgICAgICAgICAgaWYgKHRoaXMuX2NvbGxlY3Rpb24ubGVuZ3RoKSB7XG5cbiAgICAgICAgICAgICAgICBpZiAodHJ1ZSAhPT0gdGhpcy5fc2V0dGluZ3Muc2VxdWVudGlhbCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGxldCBsb2FkZWQgPSAwO1xuXG4gICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5fY29sbGVjdGlvbi5sZW5ndGg7IGkrKykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fYWJvcnQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBsb2FkX2luc3RhbmNlID0gbmV3IFJlc291cmNlTG9hZGVyKHRoaXMuX3NldHRpbmdzKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbG9hZF9pbnN0YW5jZXMucHVzaChsb2FkX2luc3RhbmNlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZF9pbnN0YW5jZS5yZXNvdXJjZSA9IHRoaXMuX2NvbGxlY3Rpb25baV07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRfaW5zdGFuY2UuZG9uZShmdW5jdGlvbihyZXNvdXJjZSl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2FkZWQrKztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYucGVyY2VudGFnZSA9IGxvYWRlZCAvIHNlbGYuX2NvbGxlY3Rpb24ubGVuZ3RoICogMTAwO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fcHJvZ3Jlc3MuY2FsbChudWxsIC8qIHRvZG8gKi8sIHJlc291cmNlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggbG9hZGVkID4gc2VsZi5fY29sbGVjdGlvbi5sZW5ndGggfHwgc2VsZi5fYWJvcnQgKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiggbG9hZGVkID09PSBzZWxmLl9jb2xsZWN0aW9uLmxlbmd0aCApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2NhbGxiYWNrLmNhbGwobnVsbCAvKiB0b2RvICovICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IGxvYWRlZCA9IC0xO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlcXVlbnRpYWxfcmVjdXJzaW9uID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkZWQrKztcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCBsb2FkZWQgPiB0aGlzLl9jb2xsZWN0aW9uLmxlbmd0aCB8fCB0aGlzLl9hYm9ydCApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiggbG9hZGVkID09PSB0aGlzLl9jb2xsZWN0aW9uLmxlbmd0aCApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2FsbGJhY2suY2FsbChudWxsIC8qIHRvZG8gKi8gKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fbG9hZF9pbnN0YW5jZXNbMF0ucmVzb3VyY2UgPSB0aGlzLl9jb2xsZWN0aW9uW2xvYWRlZF07XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2xvYWRfaW5zdGFuY2VzWzBdLmRvbmUoZnVuY3Rpb24gKHJlc291cmNlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLnBlcmNlbnRhZ2UgPSBsb2FkZWQgLyBzZWxmLl9jb2xsZWN0aW9uLmxlbmd0aCAqIDEwMDtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3Byb2dyZXNzLmNhbGwobnVsbCAvKiB0b2RvICovLCByZXNvdXJjZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KHNlcXVlbnRpYWxfcmVjdXJzaW9uLCAkLmlzTnVtZXJpYyh0aGlzLl9zZXR0aW5ncy5waXBlbGluZURlbGF5KSA/IHBhcnNlSW50KHRoaXMuX3NldHRpbmdzLnBpcGVsaW5lRGVsYXkpIDogMCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgc2VxdWVudGlhbF9yZWN1cnNpb24oKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgICAgICBkb25lKGNhbGxiYWNrKXtcblxuICAgICAgICAgICAgaWYoICEkLmlzRnVuY3Rpb24oY2FsbGJhY2spIClcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgIGNvbnN0XG4gICAgICAgICAgICAgICAgY29udGV4dCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgX2Z1bmMgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5jYWxsKGNvbnRleHQpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmKCB0aGlzLl9jb2xsZWN0aW9uLmxlbmd0aCApXG4gICAgICAgICAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBfZnVuYztcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBfZnVuYygpO1xuXG4gICAgICAgIH07XG5cbiAgICAgICAgcHJvZ3Jlc3MoY2FsbGJhY2spe1xuXG4gICAgICAgICAgICBpZiggISQuaXNGdW5jdGlvbihjYWxsYmFjaykgKVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgY29uc3RcbiAgICAgICAgICAgICAgICBjb250ZXh0ID0gdGhpcyxcbiAgICAgICAgICAgICAgICBfZnVuYyA9IGZ1bmN0aW9uKHJlc291cmNlKXtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2suY2FsbChjb250ZXh0LCByZXNvdXJjZSk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYoIHRoaXMuX2NvbGxlY3Rpb24ubGVuZ3RoIClcbiAgICAgICAgICAgICAgICB0aGlzLl9wcm9ncmVzcyA9IF9mdW5jO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIF9mdW5jKCk7XG5cbiAgICAgICAgfTtcblxuICAgICAgICBhYm9ydCgpe1xuXG4gICAgICAgICAgICBmb3IoIGxldCBpbnN0YW5jZSBpbiB0aGlzLl9sb2FkX2luc3RhbmNlcyApXG4gICAgICAgICAgICAgICAgdGhpcy5fbG9hZF9pbnN0YW5jZXNbIGluc3RhbmNlIF0uYWJvcnQoKTtcblxuICAgICAgICAgICAgaWYoICF0aGlzLl9jb2xsZWN0aW9uLmxlbmd0aCApXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICB0aGlzLl9hYm9ydCA9IHRydWU7XG5cbiAgICAgICAgfTtcblxuICAgIH1cblxuICAgIGNsYXNzIENvbGxlY3Rpb25Qb3B1bGF0b3Ige1xuXG4gICAgICAgIGNvbnN0cnVjdG9yKCRlbGVtZW50LCBzZXR0aW5ncykge1xuXG4gICAgICAgICAgICB0aGlzLl8kZWxlbWVudCA9ICRlbGVtZW50O1xuICAgICAgICAgICAgdGhpcy5fc2V0dGluZ3MgPSBzZXR0aW5ncztcblxuICAgICAgICB9XG5cbiAgICAgICAgY29sbGVjdCgpIHtcblxuICAgICAgICAgICAgbGV0IGNvbGxlY3Rpb24gPSBbXTtcblxuICAgICAgICAgICAgY29uc3RcbiAgICAgICAgICAgICAgICB0YXJnZXRzID0gJ2ltZywgdmlkZW8sIGF1ZGlvLCBpZnJhbWUnLFxuICAgICAgICAgICAgICAgIHRhcmdldHNfZXh0ZW5kZWQgPSB0YXJnZXRzICsgJywgcGljdHVyZSwgc291cmNlJztcblxuICAgICAgICAgICAgbGV0ICR0YXJnZXRzID0gdGhpcy5fJGVsZW1lbnQuZmluZCh0YXJnZXRzKTtcbiAgICAgICAgICAgIGlmICh0aGlzLl8kZWxlbWVudC5pcyh0YXJnZXRzKSlcbiAgICAgICAgICAgICAgICAkdGFyZ2V0cy5hZGQoJGVsZW1lbnQpO1xuICAgICAgICAgICAgJHRhcmdldHMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbi5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudCAgOiB0aGlzLFxuICAgICAgICAgICAgICAgICAgICByZXNvdXJjZSA6IHRoaXMuY3VycmVudFNyYyB8fCB0aGlzLnNyYyxcbiAgICAgICAgICAgICAgICAgICAgc3RhbmRhcmQgOiB0cnVlXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKHRydWUgPT09IHRoaXMuX3NldHRpbmdzLmJhY2tncm91bmRzKVxuICAgICAgICAgICAgICAgIHRoaXMuXyRlbGVtZW50LmZpbmQoJyonKS5hZGRCYWNrKCkubm90KHRhcmdldHNfZXh0ZW5kZWQpLmZpbHRlcihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiAkKHRoaXMpLmNzcygnYmFja2dyb3VuZC1pbWFnZScpICE9PSAnbm9uZSc7XG4gICAgICAgICAgICAgICAgfSkuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24ucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICBlbGVtZW50ICA6IHRoaXMsXG4gICAgICAgICAgICAgICAgICAgICAgICByZXNvdXJjZSA6ICQodGhpcykuY3NzKCdiYWNrZ3JvdW5kLWltYWdlJykucmVwbGFjZSgvdXJsXFwoXFxcInx1cmxcXChcXCd8dXJsXFwofCgoXFxcInxcXCcpXFwpJCkvaWdtLCAnJyksXG4gICAgICAgICAgICAgICAgICAgICAgICBzdGFuZGFyZCA6IGZhbHNlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5fc2V0dGluZ3MuYXR0cmlidXRlcy5sZW5ndGgpXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgYXR0ciBpbiB0aGlzLl9zZXR0aW5ncy5hdHRyaWJ1dGVzKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fJGVsZW1lbnQuZmluZCgnWycgKyBhdHRyICsgJ106bm90KCcgKyB0YXJnZXRzX2V4dGVuZGVkICsgJyknKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24ucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudCAgOiB0aGlzLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc291cmNlIDogJCh0aGlzKS5hdHRyKGF0dHIpLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YW5kYXJkIDogZmFsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fJGVsZW1lbnQuaXMoJ1snICsgYXR0ciArICddJykgJiYgIXRoaXMuXyRlbGVtZW50LmlzKHRhcmdldHNfZXh0ZW5kZWQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbi5hZGQoe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQgIDogdGhpcyxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvdXJjZSA6IHRoaXMuXyRlbGVtZW50LmF0dHIoYXR0ciksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhbmRhcmQgOiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBjb2xsZWN0aW9uO1xuXG4gICAgICAgIH1cblxuICAgIH1cblxuICAgICRbbmFtZXNwYWNlX21ldGhvZF0gPSBSZXNvdXJjZXNMb2FkZXI7XG5cbiAgICAkLmZuW25hbWVzcGFjZV9tZXRob2RdID0gZnVuY3Rpb24ob3B0aW9ucywgY2FsbGJhY2spe1xuXG4gICAgICAgIGlmKCAkLmlzRnVuY3Rpb24ob3B0aW9ucykgKVxuICAgICAgICAgICAgY2FsbGJhY2sgPSBvcHRpb25zO1xuICAgICAgICBpZiggISQuaXNGdW5jdGlvbihjYWxsYmFjaykgKVxuICAgICAgICAgICAgY2FsbGJhY2sgPSAkLm5vb3A7XG4gICAgICAgIGlmKCB0eXBlb2Ygb3B0aW9ucyAhPT0gJ29iamVjdCcgKVxuICAgICAgICAgICAgb3B0aW9ucyA9IHt9O1xuXG4gICAgICAgIGxldCBzZXR0aW5ncyA9ICQuZXh0ZW5kKHRydWUsIHtcbiAgICAgICAgICAgIHNyY0F0dHIgICAgICAgOiAnZGF0YS1zcmMnLFxuICAgICAgICAgICAgc3Jjc2V0QXR0ciAgICA6ICdkYXRhLXNyY3NldCcsXG4gICAgICAgICAgICBzZXF1ZW50aWFsICAgIDogZmFsc2UsXG4gICAgICAgICAgICBwaXBlbGluZURlbGF5IDogMCxcbiAgICAgICAgICAgIGV4dHJhQXR0cnMgICAgOiBbXSxcbiAgICAgICAgICAgIGJhY2tncm91bmRzICAgOiBmYWxzZSxcbiAgICAgICAgICAgIHBsYXl0aHJvdWdoICAgOiBmYWxzZVxuICAgICAgICB9LCBvcHRpb25zKTtcblxuICAgICAgICBpZiggISQuaXNBcnJheShzZXR0aW5ncy5hdHRyaWJ1dGVzKSApXG4gICAgICAgICAgICBzZXR0aW5ncy5hdHRyaWJ1dGVzID0gW107XG4gICAgICAgIGlmKCB0eXBlb2Ygc2V0dGluZ3MuYXR0cmlidXRlcyA9PT0gJ3N0cmluZycgKVxuICAgICAgICAgICAgc2V0dGluZ3MuYXR0cmlidXRlcyA9IHNldHRpbmdzLmF0dHJpYnV0ZXMuc3BsaXQoJyAnKTtcblxuICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgIGNvbnN0IGVsZW1lbnQgPSB0aGlzLFxuICAgICAgICAgICAgICAgICAgJGVsZW1lbnQgPSAkKGVsZW1lbnQpO1xuXG4gICAgICAgICAgICBsZXQgbG9hZF9pbnN0YW5jZSA9ICRlbGVtZW50LmRhdGEobmFtZXNwYWNlKTtcblxuICAgICAgICAgICAgaWYoIHVuZGVmaW5lZCAhPT0gbG9hZF9pbnN0YW5jZSApXG4gICAgICAgICAgICAgICAgbG9hZF9pbnN0YW5jZS5hYm9ydCgpO1xuXG4gICAgICAgICAgICBsb2FkX2luc3RhbmNlID0gbmV3IFJlc291cmNlc0xvYWRlcihuZXcgQ29sbGVjdGlvblBvcHVsYXRvcigkZWxlbWVudCwgc2V0dGluZ3MpLmNvbGxlY3QoKSwgc2V0dGluZ3MpO1xuXG4gICAgICAgICAgICBsb2FkX2luc3RhbmNlLnByb2dyZXNzKGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICAgICAvLyB0b2RvIHRyaWdnZXIgZXZlbnQgLi4uXG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBsb2FkX2luc3RhbmNlLmRvbmUoZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwoZWxlbWVudCk7XG5cbiAgICAgICAgICAgICAgICAvLyB0b2RvIHRyaWdnZXIgZXZlbnQgLi4uXG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkZWxlbWVudC5kYXRhKG5hbWVzcGFjZSwgbG9hZF9pbnN0YW5jZSk7XG5cbiAgICAgICAgfSk7XG5cbiAgICB9O1xuXG4gICAgJFtuYW1lc3BhY2VfcHJlZml4KydMYXp5bG9hZCddID0gZnVuY3Rpb24oc2VsZWN0b3Ipe1xuXG4gICAgICAgIGlmKCAhJC5uaXRlIHx8ICEoICdpblZpZXdwb3J0JyBpbiAkLm5pdGUgKSB8fCAhKCAnc2Nyb2xsJyBpbiAkLm5pdGUgKSApIHtcblxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0EgcmVjZW50IHZlcnNpb24gb2YgJC5uaXRlIGlzIG5lZWRlZC4nKTtcblxuICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgIH1cblxuICAgICAgICAkLm5pdGUuc2Nyb2xsKG5hbWVzcGFjZSwgZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgJCggaXNfdmFsaWRfc2VsZWN0b3Ioc2VsZWN0b3IpID8gc2VsZWN0b3IgOiAnW2RhdGEtbml0ZS1zcmNdJyApLmluVmlld3BvcnQoKVtuYW1lc3BhY2VfbWV0aG9kXShmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICAgICAgY29uc3QgJHRoaXMgPSAkKHRoaXMpO1xuXG4gICAgICAgICAgICAgICAgJHRoaXMudHJpZ2dlcihlLnR5cGUgKyAnLicrbmFtZXNwYWNlX3ByZWZpeCsnTGF6eUxvYWQnKTtcbiAgICAgICAgICAgICAgICAkZG9jdW1lbnQudHJpZ2dlcihlLnR5cGUgKyAnLicrbmFtZXNwYWNlX3ByZWZpeCsnTGF6eUxvYWQnLCBbJHRoaXNdKTtcblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSwgeyBmcHMgOiAyNSB9KTtcblxuICAgIH07XG5cbn0pKHdpbmRvdywgZG9jdW1lbnQsIGpRdWVyeSk7Il19
