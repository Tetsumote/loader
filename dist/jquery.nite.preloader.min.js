"use strict";var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a};function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(function(a,b,c){"use strict";var d=Math.floor,f="nite",e=f+"Preload",g=e+"er";if(function(a){a.console||(a.console={});for(var b,c,d=a.console,e=function(){},f=["memory"],g=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profiles","profileEnd","show","table","time","timeEnd","timeline","timelineEnd","timeStamp","trace","warn"];b=f.pop();)d[b]||(d[b]={});for(;c=g.pop();)d[c]||(d[c]=e)}(a),!c)return console.error("jQuery is needed for "+g+" to work!"),void 0;var h=c(b),i=c(a),j=function(){return c.nite?c.nite.uniqueId():d(8999*Math.random())+1e3},k=function(a){var b=c(a),d=!1;if(c.nite)d=c.nite.inViewport(a).ratio;else{var e=a.getBoundingClientRect();d=!(0>e.right||0>e.bottom||e.left>i.width()||e.top>i.height())}return d&&b.is(":visible")&&"hidden"!==b.css("visibility")},l=function(a){if("object"!==("undefined"==typeof a?"undefined":_typeof(a)))return!1;try{return a instanceof HTMLElement}catch(b){return 1===a.nodeType&&"object"===_typeof(a.style)&&"object"===_typeof(a.ownerDocument)}},m=function(a){return l(a)&&(a.complete&&1<=d(a.naturalWidth)&&1<=d(a.naturalHeight)||2<=a.readyState&&0!==a.videoWidth&&0!==a.videoHeight)},n=function(a,b){var d={image:"jp[e]?g|gif|png|tif[f]?|bmp",audio:"mp3|ogg",video:"mp4|ogv|ogg|webm"},e=Object.keys(d),f={format:null,extension:null};if("string"==typeof a){if(a=a.split("?")[0],a=a.split("#")[0],""===a)return!1;var g=void 0===b?e:[b];for(var h in g)if(g.hasOwnProperty(h)&&new RegExp("(.("+d[g[h]]+")$)|"+";base64,","g").test(a))if(/;base64,/g.test(a)){var i=a.match(new RegExp("^data:"+g[h]+"/("+d[g[h]]+")","g"));if(!i||null===i)continue;i=i[0],f.format=i.replace("data:"+g[h]+"/g","");break}else{var j=a.match(new RegExp(d[g[h]],"g"));if(j){f.format=g[h],f.extension=j[0];break}}}if(l(a)){var k=a.tagName.toLowerCase();-1<c.inArray(k,e)&&(f.format=a.tagName.toLowerCase()),"img"===k&&(f.format="image")}return f},o=function(){function d(a){_classCallCheck(this,d);var b=this;this._settings=c.extend(!0,{playthrough:!1,srcsetAttr:"data-srcset",srcAttr:"data-src",visible:!1},a),this._id=null,this._id_event=null,this._element=null,this._$element=c(),this._resource=null,this._process=!1,this._format=null,this._callback=c.noop,this._done=function(a){if(!b._process){var c=a.type.charAt(0).toUpperCase()+a.type.slice(1);b._$element.trigger(f+c+"."+f,[b._$element])}b._callback.call(null,b._id,b._element.currentSrc||b._element.src)}}return _createClass(d,[{key:"process",value:function(){if(!this._settings.visible||k(this._element)){var b=this,d=this._settings.srcAttr,e=this._settings.srcAttr.replace("data-","");if(m(this._element))this._process||this._$element.off("."+this._id_event),this._done(new Event(c.isNumeric(this._element.naturalWidth)?f+"Load":f+"Error"));else{if("image"===this._format){this._$element[this._process?"on":"one"]("load."+this._id_event+" error."+this._id_event,this._done);var h=this._$element.closest("picture"),i=this._settings.srcsetAttr,j=this._settings.srcsetAttr.replace("data-","");h.length&&"HTMLPictureElement"in a?(this._$element.removeData(j).removeAttr(i).removeData(e).removeAttr(d),h.find("source["+i+"]").attr("srcset",h.data(j)).removeData(j).removeAttr(i)):(this._$element.is("["+i+"]")&&this._$element.attr("srcset",this._$element.data(j)).removeData(j).removeAttr(i),this._$element.is("["+d+"]")&&this._$element.attr("src",this._$element.data(e)).removeData(e).removeAttr(d))}if("video"===this._format||"audio"===this._format){var l=this._$element.find("source"),n=function(a){var b=Math.round;return a.buffered.length&&1==b(a.buffered.end(0))/b(a.seekable.end(0))},o=!1;l.length?l.each(function(){c(this).is("["+d+"]")&&(c(this).attr("src",c(this).data(e)).removeData(e).removeAttr(d),o=!0)})[this._process?"on":"one"]("error."+this._id_event,function(a){var d=g+"_error";c(this).data(d,!0),l.length===l.filter(function(){return!0===c(this).data(d)}).length&&b._done(a)}):this._$element.is("["+d+"]")&&(this._$element.attr("src",this._$element.data(e)).removeData(e).removeAttr(d)[this._process?"on":"one"]("error."+this._id_event,b._done),o=!0),o&&this._element.load(),this._$element[this._process?"on":"one"]("loadedmetadata."+this._id_event,function(){if(!0!==b._settings.playthrough&&"full"!==b._settings.playthrough&&b._done(new Event("load")),"full"===b._settings.playthrough){var a=setInterval(function(){0<b._element.readyState&&!b._element.duration?(clearInterval(a),b._done(new Event("error"))):n(b._element)?(b._element.currentTime=0,!b._process&&b._element.paused&&c(b._element).is("[autoplay]")&&b._element.play(),clearInterval(a),b._done(new Event("load"))):(!b._element.paused&&b._element.pause(),!b._process&&(b._element.currentTime+=2))},500);b._$element.data(b._id_event,a)}})[this._process?"on":"one"]("canplay."+this._id_event,function(){"full"!==b._settings.playthrough||0!==this.currentTime||n(this)||this.currentTime++})[this._process?"on":"one"]("canplaythrough."+this._id_event,function(){!0===b._settings.playthrough&&b._done(new Event("load"))})}this._process||this._$element.data(g,this._id_event)}this._resource=this._element.currentSrc||this._element.src}}},{key:"abort",value:function(){if(this._$element.off("."+this._id_event),!m(this._element)){var a=this._$element.attr("srcset"),b=this._$element.attr("src");void 0!==a&&this._$element.data(this._settings.srcAttr,a).attr(this._settings.srcAttr,a).removeAttr("src").removeAttr("srcset"),void 0!==b&&this._$element.data(this._settings.srcsetAttr,b).attr(this._settings.srcsetAttr,b).removeAttr("src").removeAttr("srcset")}}},{key:"done",value:function(a){if(c.isFunction(a)){var b=this;this._callback=function(c){a.call(b,c)}}}},{key:"resource",set:function(a){var d=l(a.resource),e="string"==typeof a.resource;if(d||e){if(this._id=a.id,this._format=n(a.resource).format,e){var f="image"===this._format;this._element=b.createElement(f?"img":this._format),f&&(this._settings.srcsetAttr="data-srcset"),this._settings.srcAttr="data-src",this._resource=a.resource}d&&(this._element=a.resource),this._$element=c(this._element),e&&this._$element.data(this._settings.srcAttr.replace("data-",""),this._resource).data(this._settings.srcsetAttr.replace("data-",""),this._resource).attr(this._settings.srcAttr,this._resource).attr(this._settings.srcsetAttr,this._resource),this._id_event=this._$element.data(g),this._process=void 0!==this._id_event,this._id_event=this._process?this._id_event:g+"_unique_"+this._element.tagName+"_"+j()}}}]),d}(),p=function(){function a(b,d){if(_classCallCheck(this,a),this._collection=[],this._collection_loaded=[],this._collection_instances=[new o(this._settings)],c.isArray(b)&&("string"==typeof b[0]||l(b[0])))for(var e in b)b.hasOwnProperty(e)&&this._collection.push({id:j(),resource:b[e]});("string"==typeof b||l(b))&&this._collection.push({id:j(),resource:b}),this._settings=c.extend(!0,{sequential:!1},d),this.percentage=0,this._callback=c.noop(),this._progress=c.noop(),this._abort=!1,this._complete=!1,this._loaded=0,this.loop()}return _createClass(a,[{key:"loop",value:function(){var a=this;if(this._collection.length){if(!0===this._complete)return void a._callback.call(null);for(var b,d=0;d<this._collection.length&&!this._abort;d++)b=new o(this._settings),this._collection_instances.push(b),b.resource=this._collection[d],b.process(),b.done(function(b,d){-1===c.inArray(b,a._collection_loaded)&&(a._loaded++,a._collection_loaded.push(b),a.percentage=100*(a._loaded/a._collection.length),a._progress.call(null,d)),a._loaded>a._collection.length||a._abort||a._loaded===a._collection.length&&(a._callback.call(null),a._complete=!0)})}}},{key:"done",value:function(a){if(!c.isFunction(a))return!1;var b=this,d=function(){a.call(b)};return this._collection.length?this._callback=d:d(),!0}},{key:"progress",value:function(a){if(!c.isFunction(a))return!1;var b=this,d=function(c){a.call(b,c)};return this._collection.length?this._progress=d:d(),!0}},{key:"abort",value:function(){for(var a in this._collection_instances)this._collection_instances[a].abort();this._collection.length&&(this._abort=!0)}}]),a}(),q=function(){function a(b,c){_classCallCheck(this,a),this._$element=b,this._settings=c}return _createClass(a,[{key:"collect",value:function(){var a=[],b="img, video, audio",d=b+", picture, source",e=this._$element.find(b);if(this._$element.is(b)&&e.add(this._$element),e.each(function(){a.push(this)}),!0===this._settings.backgrounds&&this._$element.find("*").addBack().not(d).filter(function(){return"none"!==c(this).css("background-image")}).each(function(){a.push(c(this).css("background-image").replace(/url\("|url\('|url\(|(("')\)$)/igm,""))}),this._settings.attributes.length){var f=function(b){this._settings.attributes.hasOwnProperty(b)&&(this._$element.find("["+b+"]:not("+d+")").each(function(){a.push(c(this).attr(b))}),this._$element.is("["+b+"]")&&!this._$element.is(d)&&a.push(this._$element.attr(b)))};for(const a in this._settings.attributes)f(a)}return a}}]),a}();c[e]=p,c.fn[e]=function(a,b){c.isFunction(a)&&(b=a),c.isFunction(b)||(b=c.noop),"object"!==("undefined"==typeof a?"undefined":_typeof(a))&&(a={});var d=c.extend(!0,{srcAttr:"data-src",srcsetAttr:"data-srcset",visible:!1,sequential:!1,backgrounds:!1,extraAttrs:[],playthrough:!1},a);return c.isArray(d.attributes)||(d.attributes=[]),"string"==typeof d.attributes&&(d.attributes=d.attributes.split(" ")),this.each(function(){var a=!1,e=this,k=c(e),l=new q(k,d).collect(),m=g+"_"+j(),n=function(){c.nite?h.off("scroll."+m):i.off("scroll."+m),k.removeData(g),a=!0},o=k.data(g);if(void 0!==o&&(o.abort(),n()),o=new p(l,d),o.progress(function(){k.trigger(f+"Progress."+f,[k])}),o.done(function(){a||(n(),k.trigger(f+"Load."+f,[k]),b.call(e),b=c.noop)}),k.data(g,o),d.visible)if(c.nite)c.nite.scroll(m,function(){o.loop()},{fps:25});else{var r=function(a,b){var c=Date.now();return function(){0>c+b-Date.now()&&(a(),c=Date.now())}};i.on("scroll."+m,r(function(){o.loop()},1e3))}})}})(window,document,jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5uaXRlLnByZWxvYWRlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiMGtCQUFBLENBQ0EsQ0FBQyxBQUFTLEFBQVEsQUFBVSxBQUFHLGVBQVUsQUFDckMsQ0FFQSxtQkEyQzRDLEtBQUEsQUFBSyxNQTFDN0MsRUFESixBQUN1QixPQUNuQixFQUFtQixFQUZ2QixBQUV3QyxVQUNwQyxFQUFZLEVBSGhCLEFBR2lDLEFBR2pDLEFBQ0EsQUFDQSxRQUFDLEFBQVMsV0FBUSxBQUNkLEFBQUksQ0FBQyxFQUFMLEFBQVksVUFDUixFQUFBLEFBQU8sQUFBVSxBQUNyQixtQkFBQSxBQUNJLEdBREosQUFDVSxFQUROLEVBQU0sRUFBVixBQUFpQixRQUViLEVBQUEsQUFBUSxVQUFXLEFBQUUsQ0FGekIsRUFBQSxBQUdJLEFBQWEsQUFBQyxhQUhsQixBQUlJLEFBQVUsQUFBQyxBQUNQLEFBQ0EsQUFBcUUsQUFBTSxBQUNuRiw4UEFBTyxFQUFPLEVBQWQsQUFBYyxBQUFXLEFBQ3JCLEFBQUksT0FBSixBQUFLLEFBQUksT0FEYixBQUVRLEFBQUksQUFBUSxBQUNwQixjQUFPLEVBQVMsRUFBaEIsQUFBZ0IsQUFBUSxBQUNwQixBQUFJLE9BQUosQUFBSyxBQUFJLE9BRGIsQUFFUSxBQUFJLEFBQVUsQUFDekIsT0FoQkQsQUFnQkcsQUFDSCxBQUdBLEFBQ0EsS0FBQSxBQUFJLEFBQUMsQUFBSSxBQUNMLEdBQ0EsQUFBTyxBQUNWLEFBQ0QsQUFHQSxlQU5JLEFBQVEsTUFBTSxBQUF3QiwwQkFBdEMsQUFBZ0QsQUFDaEQsdUJBT0EsR0FGSixBQUVnQixBQUFFLEtBQ2QsRUFISixBQUdjLEFBQUUsS0FFWixFQUFBLEFBQVksVUFBVSxBQUVsQixPQUFPLEdBQUEsQUFBRSxLQUFPLEVBQUEsQUFBRSxLQUFYLEFBQVMsQUFBTyxhQUF3QixVQUEvQyxBQUFvQyxBQUFXLEFBQUssQUFBWSxBQUFPLEFBQVMsQUFFbkYsYUFUTCxFQVdJLEVBQUEsQUFBYSxBQUFTLFdBQVEs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bi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qISBKUXVlcnkgSGVhdnkgUmVzb3VyY2VzTG9hZGVyIHwgRGFuaWVsZSBGaW9yb25pIHwgZGZpb3Jvbmk5MUBnbWFpbC5jb20gKi9cbihmdW5jdGlvbih3aW5kb3csIGRvY3VtZW50LCAkLCB1bmRlZmluZWQpe1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGNvbnN0XG4gICAgICAgIG5hbWVzcGFjZV9wcmVmaXggPSAnbml0ZScsXG4gICAgICAgIG5hbWVzcGFjZV9tZXRob2QgPSBuYW1lc3BhY2VfcHJlZml4KydQcmVsb2FkJyxcbiAgICAgICAgbmFtZXNwYWNlID0gbmFtZXNwYWNlX21ldGhvZCsnZXInO1xuXG5cbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vcGF1bG1pbGxyL2NvbnNvbGUtcG9seWZpbGxcbiAgICAvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cbiAgICAoZnVuY3Rpb24oZ2xvYmFsKSB7XG4gICAgICAgIGlmICghZ2xvYmFsLmNvbnNvbGUpXG4gICAgICAgICAgICBnbG9iYWwuY29uc29sZSA9IHt9O1xuICAgICAgICBsZXQgY29uID0gZ2xvYmFsLmNvbnNvbGUsXG4gICAgICAgICAgICBwcm9wLCBtZXRob2QsXG4gICAgICAgICAgICBkdW1teSA9IGZ1bmN0aW9uKCkge30sXG4gICAgICAgICAgICBwcm9wZXJ0aWVzID0gWydtZW1vcnknXSxcbiAgICAgICAgICAgIG1ldGhvZHMgPSAoJ2Fzc2VydCxjbGVhcixjb3VudCxkZWJ1ZyxkaXIsZGlyeG1sLGVycm9yLGV4Y2VwdGlvbixncm91cCwnICtcbiAgICAgICAgICAgICAgICAnZ3JvdXBDb2xsYXBzZWQsZ3JvdXBFbmQsaW5mbyxsb2csbWFya1RpbWVsaW5lLHByb2ZpbGUscHJvZmlsZXMscHJvZmlsZUVuZCwnICtcbiAgICAgICAgICAgICAgICAnc2hvdyx0YWJsZSx0aW1lLHRpbWVFbmQsdGltZWxpbmUsdGltZWxpbmVFbmQsdGltZVN0YW1wLHRyYWNlLHdhcm4nKS5zcGxpdCgnLCcpO1xuICAgICAgICB3aGlsZSAocHJvcCA9IHByb3BlcnRpZXMucG9wKCkpXG4gICAgICAgICAgICBpZiAoIWNvbltwcm9wXSlcbiAgICAgICAgICAgICAgICBjb25bcHJvcF0gPSB7fTtcbiAgICAgICAgd2hpbGUgKG1ldGhvZCA9IG1ldGhvZHMucG9wKCkpXG4gICAgICAgICAgICBpZiAoIWNvblttZXRob2RdKVxuICAgICAgICAgICAgICAgIGNvblttZXRob2RdID0gZHVtbXk7XG4gICAgfSkod2luZG93KTtcbiAgICAvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblxuXG4gICAgLy8gfiB+IH4gfiB+IH4gfiB+IH4gfiB+IH5cbiAgICBpZiggISQgKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ2pRdWVyeSBpcyBuZWVkZWQgZm9yICcrbmFtZXNwYWNlKycgdG8gd29yayEnKTtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgLy8gfiB+IH4gfiB+IH4gfiB+IH4gfiB+IH5cblxuXG4gICAgY29uc3RcblxuICAgICAgICAkZG9jdW1lbnQgPSAkKGRvY3VtZW50KSxcbiAgICAgICAgJHdpbmRvdyA9ICQod2luZG93KSxcblxuICAgICAgICB1bmlxdWVfaWQgPSBmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICByZXR1cm4gJC5uaXRlID8gJC5uaXRlLnVuaXF1ZUlkKCkgOiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAoOTk5OSAtIDEwMDApKSArIDEwMDA7XG5cbiAgICAgICAgfSxcblxuICAgICAgICBpc192aXNpYmxlID0gZnVuY3Rpb24oZWxlbWVudCl7XG5cbiAgICAgICAgICAgIGNvbnN0ICRlbCA9ICQoZWxlbWVudCk7XG5cbiAgICAgICAgICAgIGxldCBpbl92aWV3cG9ydCA9IGZhbHNlO1xuXG4gICAgICAgICAgICBpZiggJC5uaXRlIClcbiAgICAgICAgICAgICAgICBpbl92aWV3cG9ydCA9ICQubml0ZS5pblZpZXdwb3J0KGVsZW1lbnQpLnJhdGlvO1xuXG4gICAgICAgICAgICBlbHNle1xuXG4gICAgICAgICAgICAgICAgY29uc3QgcmVjdCA9IGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG5cbiAgICAgICAgICAgICAgICBpbl92aWV3cG9ydCA9ICEoIHJlY3QucmlnaHQgPCAwIHx8IHJlY3QuYm90dG9tIDwgMCB8fCByZWN0LmxlZnQgPiAkd2luZG93LndpZHRoKCkgfHwgcmVjdC50b3AgPiAkd2luZG93LmhlaWdodCgpICk7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIGluX3ZpZXdwb3J0ICYmICRlbC5pcygnOnZpc2libGUnKSAmJiAkZWwuY3NzKCd2aXNpYmlsaXR5JykgIT09ICdoaWRkZW4nO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgaXNfaHRtbF9vYmplY3QgPSBmdW5jdGlvbiggb2JqZWN0ICl7XG5cbiAgICAgICAgICAgIGlmKCB0eXBlb2Ygb2JqZWN0ICE9PSAnb2JqZWN0JyApXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHJldHVybiBvYmplY3QgaW5zdGFuY2VvZiBIVE1MRWxlbWVudDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGNhdGNoKGUpe1xuICAgICAgICAgICAgICAgIHJldHVybiBvYmplY3Qubm9kZVR5cGUgPT09IDEgJiYgdHlwZW9mIG9iamVjdC5zdHlsZSA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG9iamVjdC5vd25lckRvY3VtZW50ID09PSAnb2JqZWN0JztcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9LFxuXG4gICAgICAgIGlzX2xvYWRlZCA9IGZ1bmN0aW9uKGVsZW1lbnQpe1xuXG4gICAgICAgICAgICByZXR1cm4gaXNfaHRtbF9vYmplY3QoZWxlbWVudCkgJiYgKFxuICAgICAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5jb21wbGV0ZSAmJlxuICAgICAgICAgICAgICAgICAgICBNYXRoLmZsb29yKGVsZW1lbnQubmF0dXJhbFdpZHRoKSA+PSAxICYmXG4gICAgICAgICAgICAgICAgICAgIE1hdGguZmxvb3IoZWxlbWVudC5uYXR1cmFsSGVpZ2h0KSA+PSAxXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgICAgIHx8XG4gICAgICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnJlYWR5U3RhdGUgPj0gMiAmJlxuICAgICAgICAgICAgICAgICAgICBlbGVtZW50LnZpZGVvV2lkdGggIT09IDAgJiZcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudC52aWRlb0hlaWdodCAhPT0gMFxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgICk7XG5cbiAgICAgICAgfSxcbiAgICAgICAgXG4gICAgICAgIGlzX2Zvcm1hdCA9IGZ1bmN0aW9uKCBpdGVtLCBleHBlY3RlZF9mb3JtYXQgKXtcblxuICAgICAgICAgICAgY29uc3RcbiAgICAgICAgICAgICAgICBmb3JtYXRfZXh0ZW5zaW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgaW1hZ2UgOiAnanBbZV0/Z3xnaWZ8cG5nfHRpZltmXT98Ym1wJyxcbiAgICAgICAgICAgICAgICAgICAgYXVkaW8gOiAnbXAzfG9nZycsXG4gICAgICAgICAgICAgICAgICAgIHZpZGVvIDogJ21wNHxvZ3Z8b2dnfHdlYm0nXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBmb3JtYXRfbmFtZXMgPSBPYmplY3Qua2V5cyhmb3JtYXRfZXh0ZW5zaW9ucyksXG4gICAgICAgICAgICAgICAgYmFzZTY0X2hlYWRpbmcgPSAnXFw7YmFzZTY0XFwsJztcblxuICAgICAgICAgICAgbGV0IG91dHB1dCA9IHsgZm9ybWF0OiBudWxsLCBleHRlbnNpb246IG51bGwgfTtcblxuICAgICAgICAgICAgaWYoIHR5cGVvZiBpdGVtID09PSAnc3RyaW5nJyApIHtcblxuICAgICAgICAgICAgICAgIGl0ZW0gPSBpdGVtLnNwbGl0KCc/JylbMF07IC8vIGdldCByaWQgb2YgcXVlcnkgc3RyaW5nc1xuICAgICAgICAgICAgICAgIGl0ZW0gPSBpdGVtLnNwbGl0KCcjJylbMF07IC8vIGdldCByaWQgb2YgaGFzaGVzXG5cbiAgICAgICAgICAgICAgICBpZiAoaXRlbSA9PT0gJycpXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcblxuICAgICAgICAgICAgICAgIGxldCBmb3JtYXRfcXVldWUgPSB1bmRlZmluZWQgIT09IGV4cGVjdGVkX2Zvcm1hdCA/IFsgZXhwZWN0ZWRfZm9ybWF0IF0gOiBmb3JtYXRfbmFtZXM7XG5cbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IHggaW4gZm9ybWF0X3F1ZXVlKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKGZvcm1hdF9xdWV1ZS5oYXNPd25Qcm9wZXJ0eSh4KSl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChuZXcgUmVnRXhwKCcoXFwuKCcgKyBmb3JtYXRfZXh0ZW5zaW9uc1tmb3JtYXRfcXVldWVbeF1dICsgJykkKXwnICsgYmFzZTY0X2hlYWRpbmcsICdnJykudGVzdChpdGVtKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5ldyBSZWdFeHAoYmFzZTY0X2hlYWRpbmcsICdnJykudGVzdChpdGVtKSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBtYXRjaGVzNjQgPSBpdGVtLm1hdGNoKG5ldyBSZWdFeHAoJ15kYXRhOicgKyBmb3JtYXRfcXVldWVbeF0gKyAnXFwvKCcgKyBmb3JtYXRfZXh0ZW5zaW9uc1tmb3JtYXRfcXVldWVbeF1dICsgJyknLCAnZycpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoICFtYXRjaGVzNjQgfHwgbnVsbCA9PT0gbWF0Y2hlczY0IClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hdGNoZXM2NCA9IG1hdGNoZXM2NFswXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBvdXRwdXQuZm9ybWF0ID0gbWF0Y2hlczY0LnJlcGxhY2UoJ2RhdGE6JyArIGZvcm1hdF9xdWV1ZVt4XSArICcvZycsICcnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IG1hdGNoZXMgPSBpdGVtLm1hdGNoKG5ldyBSZWdFeHAoZm9ybWF0X2V4dGVuc2lvbnNbZm9ybWF0X3F1ZXVlW3hdXSwgJ2cnKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG1hdGNoZXMpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3V0cHV0LmZvcm1hdCA9IGZvcm1hdF9xdWV1ZVt4XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG91dHB1dC5leHRlbnNpb24gPSBtYXRjaGVzWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYoIGlzX2h0bWxfb2JqZWN0KGl0ZW0pICl7XG5cbiAgICAgICAgICAgICAgICBsZXQgdGFnX25hbWUgPSBpdGVtLnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiggJC5pbkFycmF5KHRhZ19uYW1lLCBmb3JtYXRfbmFtZXMpID4gLTEgKVxuICAgICAgICAgICAgICAgICAgICBvdXRwdXQuZm9ybWF0ID0gaXRlbS50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgICAgICAgICBpZiggdGFnX25hbWUgPT09ICdpbWcnIClcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0LmZvcm1hdCA9ICdpbWFnZSc7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICBcbiAgICAgICAgfTtcblxuICAgIGNsYXNzIFJlc291cmNlTG9hZGVyIHtcblxuICAgICAgICBjb25zdHJ1Y3RvcihvcHRpb25zKXtcblxuICAgICAgICAgICAgY29uc3Qgc2VsZiA9IHRoaXM7XG5cbiAgICAgICAgICAgIHRoaXMuX3NldHRpbmdzICA9ICQuZXh0ZW5kKHRydWUsIHtcbiAgICAgICAgICAgICAgICBwbGF5dGhyb3VnaCAgOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBzcmNzZXRBdHRyICAgOiAnZGF0YS1zcmNzZXQnLFxuICAgICAgICAgICAgICAgIHNyY0F0dHIgICAgICA6ICdkYXRhLXNyYycsXG4gICAgICAgICAgICAgICAgdmlzaWJsZSAgICAgIDogZmFsc2VcbiAgICAgICAgICAgIH0sIG9wdGlvbnMpO1xuXG4gICAgICAgICAgICB0aGlzLl9pZCAgICAgICAgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5faWRfZXZlbnQgID0gbnVsbDtcblxuICAgICAgICAgICAgdGhpcy5fZWxlbWVudCAgID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuXyRlbGVtZW50ICA9ICQoKTtcblxuICAgICAgICAgICAgdGhpcy5fcmVzb3VyY2UgID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX3Byb2Nlc3MgICA9IGZhbHNlO1xuXG4gICAgICAgICAgICB0aGlzLl9mb3JtYXQgICAgPSBudWxsO1xuXG4gICAgICAgICAgICB0aGlzLl9jYWxsYmFjayAgPSAkLm5vb3A7XG4gICAgICAgICAgICB0aGlzLl9kb25lICAgICAgPSBmdW5jdGlvbihlKXtcblxuICAgICAgICAgICAgICAgIGlmKCAhc2VsZi5fcHJvY2VzcyApIHtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdCB0cmlnZ2VyX2V2ZW50ID0gZS50eXBlLmNoYXJBdCgwKS50b1VwcGVyQ2FzZSgpICsgZS50eXBlLnNsaWNlKDEpO1xuXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuXyRlbGVtZW50LnRyaWdnZXIobmFtZXNwYWNlX3ByZWZpeCArIHRyaWdnZXJfZXZlbnQgKyAnLicgKyBuYW1lc3BhY2VfcHJlZml4LCBbc2VsZi5fJGVsZW1lbnRdKTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHNlbGYuX2NhbGxiYWNrLmNhbGwobnVsbCAvKiB0b2RvIGNvbnRleHQgKi8sIHNlbGYuX2lkLCBzZWxmLl9lbGVtZW50LmN1cnJlbnRTcmMgfHwgc2VsZi5fZWxlbWVudC5zcmMpO1xuXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgIH1cblxuICAgICAgICBzZXQgcmVzb3VyY2UoIGRhdGEgKXtcblxuICAgICAgICAgICAgY29uc3RcbiAgICAgICAgICAgICAgICBlbGVtZW50X3Jlc291cmNlID0gaXNfaHRtbF9vYmplY3QoZGF0YS5yZXNvdXJjZSksXG4gICAgICAgICAgICAgICAgc3RyaW5nX3Jlc291cmNlID0gdHlwZW9mIGRhdGEucmVzb3VyY2UgPT09ICdzdHJpbmcnO1xuXG4gICAgICAgICAgICBpZiggIWVsZW1lbnRfcmVzb3VyY2UgJiYgIXN0cmluZ19yZXNvdXJjZSApXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICB0aGlzLl9pZCA9IGRhdGEuaWQ7XG4gICAgICAgICAgICB0aGlzLl9mb3JtYXQgPSBpc19mb3JtYXQoZGF0YS5yZXNvdXJjZSkuZm9ybWF0O1xuXG4gICAgICAgICAgICBpZiggc3RyaW5nX3Jlc291cmNlICl7XG5cbiAgICAgICAgICAgICAgICBsZXQgaXNfaW1nID0gdGhpcy5fZm9ybWF0ID09PSAnaW1hZ2UnO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fZWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoaXNfaW1nID8gJ2ltZycgOiB0aGlzLl9mb3JtYXQpO1xuXG4gICAgICAgICAgICAgICAgaWYoIGlzX2ltZyApXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NldHRpbmdzLnNyY3NldEF0dHIgPSAnZGF0YS1zcmNzZXQnO1xuICAgICAgICAgICAgICAgIHRoaXMuX3NldHRpbmdzLnNyY0F0dHIgPSAnZGF0YS1zcmMnO1xuXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVzb3VyY2UgPSBkYXRhLnJlc291cmNlO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmKCBlbGVtZW50X3Jlc291cmNlIClcbiAgICAgICAgICAgICAgICB0aGlzLl9lbGVtZW50ID0gZGF0YS5yZXNvdXJjZTtcblxuICAgICAgICAgICAgdGhpcy5fJGVsZW1lbnQgPSAkKHRoaXMuX2VsZW1lbnQpO1xuXG4gICAgICAgICAgICBpZiggc3RyaW5nX3Jlc291cmNlICl7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl8kZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICAuZGF0YSh0aGlzLl9zZXR0aW5ncy5zcmNBdHRyLnJlcGxhY2UoJ2RhdGEtJywgJycpLCB0aGlzLl9yZXNvdXJjZSlcbiAgICAgICAgICAgICAgICAgICAgLmRhdGEodGhpcy5fc2V0dGluZ3Muc3Jjc2V0QXR0ci5yZXBsYWNlKCdkYXRhLScsICcnKSwgdGhpcy5fcmVzb3VyY2UpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKHRoaXMuX3NldHRpbmdzLnNyY0F0dHIsIHRoaXMuX3Jlc291cmNlKVxuICAgICAgICAgICAgICAgICAgICAuYXR0cih0aGlzLl9zZXR0aW5ncy5zcmNzZXRBdHRyLCB0aGlzLl9yZXNvdXJjZSk7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5faWRfZXZlbnQgPSB0aGlzLl8kZWxlbWVudC5kYXRhKG5hbWVzcGFjZSk7XG4gICAgICAgICAgICB0aGlzLl9wcm9jZXNzICA9IHRoaXMuX2lkX2V2ZW50ICE9PSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB0aGlzLl9pZF9ldmVudCA9IHRoaXMuX3Byb2Nlc3MgPyB0aGlzLl9pZF9ldmVudCA6IG5hbWVzcGFjZSArICdfdW5pcXVlXycgKyB0aGlzLl9lbGVtZW50LnRhZ05hbWUgKyAnXycrIHVuaXF1ZV9pZCgpO1xuXG4gICAgICAgIH1cblxuICAgICAgICBwcm9jZXNzKCl7XG5cbiAgICAgICAgICAgIGlmKCB0aGlzLl9zZXR0aW5ncy52aXNpYmxlICYmICFpc192aXNpYmxlKHRoaXMuX2VsZW1lbnQpIClcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgIGNvbnN0XG4gICAgICAgICAgICAgICAgc2VsZiA9IHRoaXMsXG4gICAgICAgICAgICAgICAgc3JjID0gdGhpcy5fc2V0dGluZ3Muc3JjQXR0cixcbiAgICAgICAgICAgICAgICBzcmNfY2xlYW4gPSB0aGlzLl9zZXR0aW5ncy5zcmNBdHRyLnJlcGxhY2UoJ2RhdGEtJywgJycpO1xuXG4gICAgICAgICAgICBpZiAoIGlzX2xvYWRlZCh0aGlzLl9lbGVtZW50KSApIHtcblxuICAgICAgICAgICAgICAgIGlmICghdGhpcy5fcHJvY2VzcylcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fJGVsZW1lbnQub2ZmKCcuJyArIHRoaXMuX2lkX2V2ZW50KTtcblxuICAgICAgICAgICAgICAgIHRoaXMuX2RvbmUobmV3IEV2ZW50KCQuaXNOdW1lcmljKHRoaXMuX2VsZW1lbnQubmF0dXJhbFdpZHRoKSA/IG5hbWVzcGFjZV9wcmVmaXgrJ0xvYWQnIDogbmFtZXNwYWNlX3ByZWZpeCsnRXJyb3InKSk7XG5cbiAgICAgICAgICAgIH1lbHNle1xuXG4gICAgICAgICAgICAgICAgaWYoIHRoaXMuX2Zvcm1hdCA9PT0gJ2ltYWdlJyApIHtcblxuICAgICAgICAgICAgICAgICAgICB0aGlzLl8kZWxlbWVudFt0aGlzLl9wcm9jZXNzID8gJ29uJyA6ICdvbmUnXSgnbG9hZC4nICsgdGhpcy5faWRfZXZlbnQgKyAnIGVycm9yLicgKyB0aGlzLl9pZF9ldmVudCwgdGhpcy5fZG9uZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3RcbiAgICAgICAgICAgICAgICAgICAgICAgICRwaWN0dXJlID0gdGhpcy5fJGVsZW1lbnQuY2xvc2VzdCgncGljdHVyZScpLFxuICAgICAgICAgICAgICAgICAgICAgICAgc3Jjc2V0ID0gdGhpcy5fc2V0dGluZ3Muc3Jjc2V0QXR0cixcbiAgICAgICAgICAgICAgICAgICAgICAgIHNyY3NldF9jbGVhbiA9IHRoaXMuX3NldHRpbmdzLnNyY3NldEF0dHIucmVwbGFjZSgnZGF0YS0nLCAnJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKCRwaWN0dXJlLmxlbmd0aCAmJiAnSFRNTFBpY3R1cmVFbGVtZW50JyBpbiB3aW5kb3cgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuXyRlbGVtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZURhdGEoc3Jjc2V0X2NsZWFuKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVBdHRyKHNyY3NldClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlRGF0YShzcmNfY2xlYW4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUF0dHIoc3JjKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgJHBpY3R1cmUuZmluZCgnc291cmNlWycgKyBzcmNzZXQgKyAnXScpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3NyY3NldCcsICRwaWN0dXJlLmRhdGEoc3Jjc2V0X2NsZWFuKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlRGF0YShzcmNzZXRfY2xlYW4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUF0dHIoc3Jjc2V0KTtcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fJGVsZW1lbnQuaXMoJ1snICsgc3Jjc2V0ICsgJ10nKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl8kZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cignc3Jjc2V0JywgdGhpcy5fJGVsZW1lbnQuZGF0YShzcmNzZXRfY2xlYW4pKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlRGF0YShzcmNzZXRfY2xlYW4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVBdHRyKHNyY3NldCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl8kZWxlbWVudC5pcygnWycgKyBzcmMgKyAnXScpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuXyRlbGVtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCdzcmMnLCB0aGlzLl8kZWxlbWVudC5kYXRhKHNyY19jbGVhbikpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVEYXRhKHNyY19jbGVhbilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUF0dHIoc3JjKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYoIHRoaXMuX2Zvcm1hdCA9PT0gJ3ZpZGVvJyB8fCB0aGlzLl9mb3JtYXQgPT09ICdhdWRpbycgKXtcblxuICAgICAgICAgICAgICAgICAgICBjb25zdFxuICAgICAgICAgICAgICAgICAgICAgICAgJHNvdXJjZXMgPSB0aGlzLl8kZWxlbWVudC5maW5kKCdzb3VyY2UnKSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGlzX2Z1bGx5X2J1ZmZlcmVkID0gZnVuY3Rpb24obWVkaWEpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG1lZGlhLmJ1ZmZlcmVkLmxlbmd0aCAmJiBNYXRoLnJvdW5kKG1lZGlhLmJ1ZmZlcmVkLmVuZCgwKSkgLyBNYXRoLnJvdW5kKG1lZGlhLnNlZWthYmxlLmVuZCgwKSkgPT09IDE7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICAgICAgbGV0IGNhbGxfbWVkaWFfbG9hZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKCAkc291cmNlcy5sZW5ndGggKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgJHNvdXJjZXMuZWFjaChmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICggJCh0aGlzKS5pcygnWycgKyBzcmMgKyAnXScpICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQodGhpcylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCdzcmMnLCAkKHRoaXMpLmRhdGEoc3JjX2NsZWFuKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVEYXRhKHNyY19jbGVhbilcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVBdHRyKHNyYyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbF9tZWRpYV9sb2FkID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIFt0aGlzLl9wcm9jZXNzID8gJ29uJyA6ICdvbmUnXSgnZXJyb3IuJyArIHRoaXMuX2lkX2V2ZW50LCBmdW5jdGlvbihlKXtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHNvdXJjZXNfZXJyb3JfaWQgPSBuYW1lc3BhY2UrJ19lcnJvcic7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKHRoaXMpLmRhdGEoc291cmNlc19lcnJvcl9pZCwgdHJ1ZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiggJHNvdXJjZXMubGVuZ3RoID09PSAkc291cmNlcy5maWx0ZXIoZnVuY3Rpb24oKXsgcmV0dXJuIHRydWUgPT09ICQodGhpcykuZGF0YShzb3VyY2VzX2Vycm9yX2lkKTsgfSkubGVuZ3RoIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fZG9uZShlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfWVsc2V7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl8kZWxlbWVudC5pcygnWycgKyBzcmMgKyAnXScpKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl8kZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuYXR0cignc3JjJywgdGhpcy5fJGVsZW1lbnQuZGF0YShzcmNfY2xlYW4pKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlRGF0YShzcmNfY2xlYW4pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVBdHRyKHNyYylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW3RoaXMuX3Byb2Nlc3MgPyAnb24nIDogJ29uZSddKCdlcnJvci4nICsgdGhpcy5faWRfZXZlbnQsIHNlbGYuX2RvbmUpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbF9tZWRpYV9sb2FkID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiggY2FsbF9tZWRpYV9sb2FkIClcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2VsZW1lbnQubG9hZCgpO1xuXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuXyRlbGVtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICBbdGhpcy5fcHJvY2VzcyA/ICdvbicgOiAnb25lJ10oJ2xvYWRlZG1ldGFkYXRhLicgKyB0aGlzLl9pZF9ldmVudCwgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCB0cnVlICE9PSBzZWxmLl9zZXR0aW5ncy5wbGF5dGhyb3VnaCAmJiAnZnVsbCcgIT09IHNlbGYuX3NldHRpbmdzLnBsYXl0aHJvdWdoIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fZG9uZShuZXcgRXZlbnQoJ2xvYWQnKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiggJ2Z1bGwnID09PSBzZWxmLl9zZXR0aW5ncy5wbGF5dGhyb3VnaCApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgaW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0aGlzIHJlcGxhY2VzIHRoZSBmYXVsdHkgcHJvZ3Jlc3MgZXZlbnQgYmVsb3dcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxmLl9lbGVtZW50LnJlYWR5U3RhdGUgPiAwICYmICFzZWxmLl9lbGVtZW50LmR1cmF0aW9uKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjbGVhckludGVydmFsKGludGVydmFsKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2RvbmUobmV3IEV2ZW50KCdlcnJvcicpKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpc19mdWxseV9idWZmZXJlZChzZWxmLl9lbGVtZW50KSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fZWxlbWVudC5jdXJyZW50VGltZSA9IDA7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNlbGYuX3Byb2Nlc3MgJiYgc2VsZi5fZWxlbWVudC5wYXVzZWQgJiYgJChzZWxmLl9lbGVtZW50KS5pcygnW2F1dG9wbGF5XScpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9lbGVtZW50LnBsYXkoKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWwpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fZG9uZShuZXcgRXZlbnQoJ2xvYWQnKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNlbGYuX2VsZW1lbnQucGF1c2VkKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9lbGVtZW50LnBhdXNlKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoIXNlbGYuX3Byb2Nlc3MpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2VsZW1lbnQuY3VycmVudFRpbWUgKz0gMjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sIDUwMCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fJGVsZW1lbnQuZGF0YShzZWxmLl9pZF9ldmVudCwgaW50ZXJ2YWwpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgW3RoaXMuX3Byb2Nlc3MgPyAnb24nIDogJ29uZSddKCdjYW5wbGF5LicgKyB0aGlzLl9pZF9ldmVudCwgZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCdmdWxsJyA9PT0gc2VsZi5fc2V0dGluZ3MucGxheXRocm91Z2ggJiYgdGhpcy5jdXJyZW50VGltZSA9PT0gMCAmJiAhaXNfZnVsbHlfYnVmZmVyZWQodGhpcykpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY3VycmVudFRpbWUrKztcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIFt0aGlzLl9wcm9jZXNzID8gJ29uJyA6ICdvbmUnXSgnY2FucGxheXRocm91Z2guJyArIHRoaXMuX2lkX2V2ZW50LCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodHJ1ZSA9PT0gc2VsZi5fc2V0dGluZ3MucGxheXRocm91Z2gpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2RvbmUobmV3IEV2ZW50KCdsb2FkJykpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gdGhpcyBwcm9ncmVzcyBldmVudCB0aGluZyBpcyBub3QgcmVsaWFibGUgQUwgPjsoXG4gICAgICAgICAgICAgICAgICAgICAgICAvKlt0aGlzLl9wcm9jZXNzID8gJ29uJyA6ICdvbmUnXSgncHJvZ3Jlc3MuJyArIHRoaXMuX2lkX2V2ZW50LCBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoJ2Z1bGwnID09PSBzZWxmLl9zZXR0aW5ncy5wbGF5dGhyb3VnaClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHJvZ3Jlc3MgY2hlY2sgY29kZSBoZXJlIC4uLlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LCAyNSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pOyAqL1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKCAhdGhpcy5fcHJvY2VzcyApXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuXyRlbGVtZW50LmRhdGEobmFtZXNwYWNlLCB0aGlzLl9pZF9ldmVudCk7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fcmVzb3VyY2UgPSB0aGlzLl9lbGVtZW50LmN1cnJlbnRTcmMgfHwgdGhpcy5fZWxlbWVudC5zcmM7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGFib3J0KCl7XG5cbiAgICAgICAgICAgIHRoaXMuXyRlbGVtZW50XG4gICAgICAgICAgICAgICAgLm9mZignLicgKyB0aGlzLl9pZF9ldmVudCk7XG5cbiAgICAgICAgICAgIGlmKCBpc19sb2FkZWQodGhpcy5fZWxlbWVudCkgKVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgY29uc3RcbiAgICAgICAgICAgICAgICBzcmMgPSB0aGlzLl8kZWxlbWVudC5hdHRyKCdzcmNzZXQnKSxcbiAgICAgICAgICAgICAgICBzcmNzZXQgPSB0aGlzLl8kZWxlbWVudC5hdHRyKCdzcmMnKTtcblxuICAgICAgICAgICAgaWYoIHVuZGVmaW5lZCAhPT0gc3JjIClcbiAgICAgICAgICAgICAgICB0aGlzLl8kZWxlbWVudFxuICAgICAgICAgICAgICAgICAgICAuZGF0YSh0aGlzLl9zZXR0aW5ncy5zcmNBdHRyLCBzcmMpXG4gICAgICAgICAgICAgICAgICAgIC5hdHRyKHRoaXMuX3NldHRpbmdzLnNyY0F0dHIsIHNyYylcbiAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUF0dHIoJ3NyYycpLnJlbW92ZUF0dHIoJ3NyY3NldCcpO1xuXG4gICAgICAgICAgICBpZiggdW5kZWZpbmVkICE9PSBzcmNzZXQgKVxuICAgICAgICAgICAgICAgIHRoaXMuXyRlbGVtZW50XG4gICAgICAgICAgICAgICAgICAgIC5kYXRhKHRoaXMuX3NldHRpbmdzLnNyY3NldEF0dHIsIHNyY3NldClcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIodGhpcy5fc2V0dGluZ3Muc3Jjc2V0QXR0ciwgc3Jjc2V0KVxuICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQXR0cignc3JjJykucmVtb3ZlQXR0cignc3Jjc2V0Jyk7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGRvbmUoY2FsbGJhY2spe1xuXG4gICAgICAgICAgICBpZiggISQuaXNGdW5jdGlvbihjYWxsYmFjaykgKVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgY29uc3QgY29udGV4dCA9IHRoaXM7XG5cbiAgICAgICAgICAgIHRoaXMuX2NhbGxiYWNrID0gZnVuY3Rpb24ocmVzb3VyY2Upe1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwoY29udGV4dCwgcmVzb3VyY2UpO1xuICAgICAgICAgICAgfTtcblxuICAgICAgICB9O1xuXG4gICAgfVxuICAgIFxuICAgIGNsYXNzIFJlc291cmNlc0xvYWRlciB7XG5cbiAgICAgICAgY29uc3RydWN0b3IoY29sbGVjdGlvbiwgb3B0aW9ucykge1xuXG4gICAgICAgICAgICB0aGlzLl9jb2xsZWN0aW9uID0gW107XG4gICAgICAgICAgICB0aGlzLl9jb2xsZWN0aW9uX2xvYWRlZCA9IFtdO1xuICAgICAgICAgICAgdGhpcy5fY29sbGVjdGlvbl9pbnN0YW5jZXMgPSBbIG5ldyBSZXNvdXJjZUxvYWRlcih0aGlzLl9zZXR0aW5ncykgXTtcblxuICAgICAgICAgICAgaWYgKCQuaXNBcnJheShjb2xsZWN0aW9uKSAmJiAoIHR5cGVvZiBjb2xsZWN0aW9uWzBdID09PSAnc3RyaW5nJyB8fCBpc19odG1sX29iamVjdChjb2xsZWN0aW9uWzBdKSApKVxuICAgICAgICAgICAgICAgIGZvciAoIGNvbnN0IHJlc291cmNlIGluIGNvbGxlY3Rpb24gKVxuICAgICAgICAgICAgICAgICAgICBpZiggY29sbGVjdGlvbi5oYXNPd25Qcm9wZXJ0eShyZXNvdXJjZSkgKVxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fY29sbGVjdGlvbi5wdXNoKHsgaWQgOiB1bmlxdWVfaWQoKSwgcmVzb3VyY2UgOiBjb2xsZWN0aW9uW3Jlc291cmNlXSB9KTtcbiAgICAgICAgICAgIGlmICggdHlwZW9mIGNvbGxlY3Rpb24gPT09ICdzdHJpbmcnIHx8IGlzX2h0bWxfb2JqZWN0KGNvbGxlY3Rpb24pIClcbiAgICAgICAgICAgICAgICB0aGlzLl9jb2xsZWN0aW9uLnB1c2goeyBpZCA6IHVuaXF1ZV9pZCgpLCByZXNvdXJjZSA6IGNvbGxlY3Rpb24gfSk7XG5cbiAgICAgICAgICAgIHRoaXMuX3NldHRpbmdzID0gJC5leHRlbmQodHJ1ZSwge1xuICAgICAgICAgICAgICAgIHNlcXVlbnRpYWw6IGZhbHNlXG4gICAgICAgICAgICB9LCBvcHRpb25zKTtcblxuICAgICAgICAgICAgdGhpcy5wZXJjZW50YWdlID0gMDtcblxuICAgICAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSAkLm5vb3AoKTtcbiAgICAgICAgICAgIHRoaXMuX3Byb2dyZXNzID0gJC5ub29wKCk7XG4gICAgICAgICAgICB0aGlzLl9hYm9ydCA9IGZhbHNlO1xuXG4gICAgICAgICAgICB0aGlzLl9jb21wbGV0ZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICB0aGlzLl9sb2FkZWQgPSAwO1xuXG4gICAgICAgICAgICB0aGlzLmxvb3AoKTtcblxuICAgICAgICB9XG5cbiAgICAgICAgbG9vcCgpe1xuXG4gICAgICAgICAgICBjb25zdCBzZWxmID0gdGhpcztcblxuICAgICAgICAgICAgaWYgKCAhdGhpcy5fY29sbGVjdGlvbi5sZW5ndGggKVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgaWYoIHRydWUgPT09IHRoaXMuX2NvbXBsZXRlICl7XG5cbiAgICAgICAgICAgICAgICBzZWxmLl9jYWxsYmFjay5jYWxsKG51bGwgLyogdG9kbyBjb250ZXh0ICovKTtcblxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuX2NvbGxlY3Rpb24ubGVuZ3RoOyBpKyspIHtcblxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hYm9ydClcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICAvLyB0b2RvIHRoaXMuX3NldHRpbmdzLnNlcXVlbnRpYWwgLS0+IG11c3QgYmUgY2FsbGVkIGluIHRoZSBmb2xsb3dpbmcgLmRvbmUoKSBjYWxsIGFuZCB0YWtpbmcgYWNjb3VudCBvZiB2aXNpYmlsaXR5IGNoZWNrIGluIFJlc291cmNlTG9hZGVyKCk7XG5cbiAgICAgICAgICAgICAgICBsZXQgbG9hZF9pbnN0YW5jZSA9IG5ldyBSZXNvdXJjZUxvYWRlcih0aGlzLl9zZXR0aW5ncyk7XG5cbiAgICAgICAgICAgICAgICB0aGlzLl9jb2xsZWN0aW9uX2luc3RhbmNlcy5wdXNoKGxvYWRfaW5zdGFuY2UpO1xuXG4gICAgICAgICAgICAgICAgbG9hZF9pbnN0YW5jZS5yZXNvdXJjZSA9IHRoaXMuX2NvbGxlY3Rpb25baV07XG5cbiAgICAgICAgICAgICAgICBsb2FkX2luc3RhbmNlLnByb2Nlc3MoKTtcblxuICAgICAgICAgICAgICAgIGxvYWRfaW5zdGFuY2UuZG9uZShmdW5jdGlvbihpZCwgcmVzb3VyY2Upe1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKCAkLmluQXJyYXkoaWQsIHNlbGYuX2NvbGxlY3Rpb25fbG9hZGVkKSA9PT0gLTEgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2xvYWRlZCsrO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9jb2xsZWN0aW9uX2xvYWRlZC5wdXNoKGlkKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5wZXJjZW50YWdlID0gc2VsZi5fbG9hZGVkIC8gc2VsZi5fY29sbGVjdGlvbi5sZW5ndGggKiAxMDA7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX3Byb2dyZXNzLmNhbGwobnVsbCAvKiB0b2RvICovLCByZXNvdXJjZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgIGlmICggc2VsZi5fbG9hZGVkID4gc2VsZi5fY29sbGVjdGlvbi5sZW5ndGggfHwgc2VsZi5fYWJvcnQgKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKCBzZWxmLl9sb2FkZWQgPT09IHNlbGYuX2NvbGxlY3Rpb24ubGVuZ3RoICkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9jYWxsYmFjay5jYWxsKG51bGwgLyogdG9kbyAqLyk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuX2NvbXBsZXRlID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH1cblxuICAgICAgICBkb25lKGNhbGxiYWNrKXtcblxuICAgICAgICAgICAgaWYoICEkLmlzRnVuY3Rpb24oY2FsbGJhY2spIClcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgIGNvbnN0XG4gICAgICAgICAgICAgICAgY29udGV4dCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgX2Z1bmMgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjay5jYWxsKGNvbnRleHQpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmKCB0aGlzLl9jb2xsZWN0aW9uLmxlbmd0aCApXG4gICAgICAgICAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBfZnVuYztcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBfZnVuYygpO1xuXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcblxuICAgICAgICB9O1xuXG4gICAgICAgIHByb2dyZXNzKGNhbGxiYWNrKXtcblxuICAgICAgICAgICAgaWYoICEkLmlzRnVuY3Rpb24oY2FsbGJhY2spIClcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgIGNvbnN0XG4gICAgICAgICAgICAgICAgY29udGV4dCA9IHRoaXMsXG4gICAgICAgICAgICAgICAgX2Z1bmMgPSBmdW5jdGlvbihyZXNvdXJjZSl7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwoY29udGV4dCwgcmVzb3VyY2UpO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGlmKCB0aGlzLl9jb2xsZWN0aW9uLmxlbmd0aCApXG4gICAgICAgICAgICAgICAgdGhpcy5fcHJvZ3Jlc3MgPSBfZnVuYztcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBfZnVuYygpO1xuXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcblxuICAgICAgICB9O1xuXG4gICAgICAgIGFib3J0KCl7XG5cbiAgICAgICAgICAgIGZvciggY29uc3QgaW5zdGFuY2UgaW4gdGhpcy5fY29sbGVjdGlvbl9pbnN0YW5jZXMgKVxuICAgICAgICAgICAgICAgIHRoaXMuX2NvbGxlY3Rpb25faW5zdGFuY2VzWyBpbnN0YW5jZSBdLmFib3J0KCk7XG5cbiAgICAgICAgICAgIGlmKCAhdGhpcy5fY29sbGVjdGlvbi5sZW5ndGggKVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgdGhpcy5fYWJvcnQgPSB0cnVlO1xuXG4gICAgICAgIH07XG5cbiAgICB9XG5cbiAgICBjbGFzcyBDb2xsZWN0aW9uUG9wdWxhdG9yIHtcblxuICAgICAgICBjb25zdHJ1Y3RvcigkZWxlbWVudCwgc2V0dGluZ3MpIHtcblxuICAgICAgICAgICAgdGhpcy5fJGVsZW1lbnQgPSAkZWxlbWVudDtcbiAgICAgICAgICAgIHRoaXMuX3NldHRpbmdzID0gc2V0dGluZ3M7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbGxlY3QoIC8qb3V0cHV0Ki8gKSB7IC8vIHRvZG8gb3V0cHV0IHR5cGVzIGVzOiBvbmx5IGVsZW1lbnRzLCBvbmx5LCB1cmxzLCBtaXhlZCwgYWxsIC4uLiBkdW5ub1xuXG4gICAgICAgICAgICBsZXQgY29sbGVjdGlvbiA9IFtdO1xuXG4gICAgICAgICAgICBjb25zdFxuICAgICAgICAgICAgICAgIHRhcmdldHMgPSAnaW1nLCB2aWRlbywgYXVkaW8nLFxuICAgICAgICAgICAgICAgIHRhcmdldHNfZXh0ZW5kZWQgPSB0YXJnZXRzICsgJywgcGljdHVyZSwgc291cmNlJztcblxuICAgICAgICAgICAgbGV0ICR0YXJnZXRzID0gdGhpcy5fJGVsZW1lbnQuZmluZCh0YXJnZXRzKTtcbiAgICAgICAgICAgIGlmICh0aGlzLl8kZWxlbWVudC5pcyh0YXJnZXRzKSlcbiAgICAgICAgICAgICAgICAkdGFyZ2V0cy5hZGQodGhpcy5fJGVsZW1lbnQpO1xuICAgICAgICAgICAgJHRhcmdldHMuZWFjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbi5wdXNoKHRoaXMpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICh0cnVlID09PSB0aGlzLl9zZXR0aW5ncy5iYWNrZ3JvdW5kcylcbiAgICAgICAgICAgICAgICB0aGlzLl8kZWxlbWVudC5maW5kKCcqJykuYWRkQmFjaygpLm5vdCh0YXJnZXRzX2V4dGVuZGVkKS5maWx0ZXIoZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gJCh0aGlzKS5jc3MoJ2JhY2tncm91bmQtaW1hZ2UnKSAhPT0gJ25vbmUnO1xuICAgICAgICAgICAgICAgIH0pLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLnB1c2goJCh0aGlzKS5jc3MoJ2JhY2tncm91bmQtaW1hZ2UnKS5yZXBsYWNlKC91cmxcXChcInx1cmxcXCgnfHVybFxcKHwoKFwiJylcXCkkKS9pZ20sICcnKSk7XG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9zZXR0aW5ncy5hdHRyaWJ1dGVzLmxlbmd0aClcbiAgICAgICAgICAgICAgICBmb3IgKGNvbnN0IGF0dHIgaW4gdGhpcy5fc2V0dGluZ3MuYXR0cmlidXRlcykge1xuICAgICAgICAgICAgICAgICAgICBpZiggdGhpcy5fc2V0dGluZ3MuYXR0cmlidXRlcy5oYXNPd25Qcm9wZXJ0eShhdHRyKSApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fJGVsZW1lbnQuZmluZCgnWycgKyBhdHRyICsgJ106bm90KCcgKyB0YXJnZXRzX2V4dGVuZGVkICsgJyknKS5lYWNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLnB1c2goJCh0aGlzKS5hdHRyKGF0dHIpKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fJGVsZW1lbnQuaXMoJ1snICsgYXR0ciArICddJykgJiYgIXRoaXMuXyRlbGVtZW50LmlzKHRhcmdldHNfZXh0ZW5kZWQpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24ucHVzaCh0aGlzLl8kZWxlbWVudC5hdHRyKGF0dHIpKTtcblxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gY29sbGVjdGlvbjtcblxuICAgICAgICB9XG5cbiAgICB9XG5cbiAgICAkW25hbWVzcGFjZV9tZXRob2RdID0gUmVzb3VyY2VzTG9hZGVyO1xuXG4gICAgJC5mbltuYW1lc3BhY2VfbWV0aG9kXSA9IGZ1bmN0aW9uKG9wdGlvbnMsIGNhbGxiYWNrKXtcblxuICAgICAgICBpZiggJC5pc0Z1bmN0aW9uKG9wdGlvbnMpIClcbiAgICAgICAgICAgIGNhbGxiYWNrID0gb3B0aW9ucztcbiAgICAgICAgaWYoICEkLmlzRnVuY3Rpb24oY2FsbGJhY2spIClcbiAgICAgICAgICAgIGNhbGxiYWNrID0gJC5ub29wO1xuICAgICAgICBpZiggdHlwZW9mIG9wdGlvbnMgIT09ICdvYmplY3QnIClcbiAgICAgICAgICAgIG9wdGlvbnMgPSB7fTtcblxuICAgICAgICBsZXQgc2V0dGluZ3MgPSAkLmV4dGVuZCh0cnVlLCB7XG5cbiAgICAgICAgICAgIHNyY0F0dHIgICAgICAgOiAnZGF0YS1zcmMnLFxuICAgICAgICAgICAgc3Jjc2V0QXR0ciAgICA6ICdkYXRhLXNyY3NldCcsXG5cbiAgICAgICAgICAgIHZpc2libGUgICAgICAgOiBmYWxzZSxcblxuICAgICAgICAgICAgc2VxdWVudGlhbCAgICA6IGZhbHNlLFxuXG4gICAgICAgICAgICBiYWNrZ3JvdW5kcyAgIDogZmFsc2UsXG4gICAgICAgICAgICBleHRyYUF0dHJzICAgIDogW10sXG5cbiAgICAgICAgICAgIHBsYXl0aHJvdWdoICAgOiBmYWxzZVxuXG4gICAgICAgIH0sIG9wdGlvbnMpO1xuXG4gICAgICAgIGlmKCAhJC5pc0FycmF5KHNldHRpbmdzLmF0dHJpYnV0ZXMpIClcbiAgICAgICAgICAgIHNldHRpbmdzLmF0dHJpYnV0ZXMgPSBbXTtcbiAgICAgICAgaWYoIHR5cGVvZiBzZXR0aW5ncy5hdHRyaWJ1dGVzID09PSAnc3RyaW5nJyApXG4gICAgICAgICAgICBzZXR0aW5ncy5hdHRyaWJ1dGVzID0gc2V0dGluZ3MuYXR0cmlidXRlcy5zcGxpdCgnICcpO1xuXG4gICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgbGV0IF9jb21wbGV0ZSA9IGZhbHNlO1xuXG4gICAgICAgICAgICBjb25zdFxuICAgICAgICAgICAgICAgIGVsZW1lbnQgPSB0aGlzLFxuICAgICAgICAgICAgICAgICRlbGVtZW50ID0gJChlbGVtZW50KSxcbiAgICAgICAgICAgICAgICBjb2xsZWN0aW9uID0gbmV3IENvbGxlY3Rpb25Qb3B1bGF0b3IoJGVsZW1lbnQsIHNldHRpbmdzKS5jb2xsZWN0KCksXG4gICAgICAgICAgICAgICAgZXZlbnRfbmFtZXNwYWNlID0gbmFtZXNwYWNlICsgJ18nICsgdW5pcXVlX2lkKCksXG4gICAgICAgICAgICAgICAgY29tcGxldGUgPSBmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKCAkLm5pdGUgKVxuICAgICAgICAgICAgICAgICAgICAgICAgJGRvY3VtZW50Lm9mZignc2Nyb2xsLicgKyBldmVudF9uYW1lc3BhY2UpO1xuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAkd2luZG93Lm9mZignc2Nyb2xsLicrZXZlbnRfbmFtZXNwYWNlKTtcblxuICAgICAgICAgICAgICAgICAgICAkZWxlbWVudC5yZW1vdmVEYXRhKG5hbWVzcGFjZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgX2NvbXBsZXRlID0gdHJ1ZTtcblxuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGxldCBsb2FkX2luc3RhbmNlID0gJGVsZW1lbnQuZGF0YShuYW1lc3BhY2UpO1xuXG4gICAgICAgICAgICBpZiggdW5kZWZpbmVkICE9PSBsb2FkX2luc3RhbmNlICkge1xuXG4gICAgICAgICAgICAgICAgbG9hZF9pbnN0YW5jZS5hYm9ydCgpO1xuXG4gICAgICAgICAgICAgICAgY29tcGxldGUoKTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBsb2FkX2luc3RhbmNlID0gbmV3IFJlc291cmNlc0xvYWRlcihjb2xsZWN0aW9uLCBzZXR0aW5ncyk7XG5cbiAgICAgICAgICAgIGxvYWRfaW5zdGFuY2UucHJvZ3Jlc3MoZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgJGVsZW1lbnQudHJpZ2dlcihuYW1lc3BhY2VfcHJlZml4KydQcm9ncmVzcy4nK25hbWVzcGFjZV9wcmVmaXgsIFskZWxlbWVudF0pO1xuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgbG9hZF9pbnN0YW5jZS5kb25lKGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgIGlmKCBfY29tcGxldGUgKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICAgICBjb21wbGV0ZSgpO1xuXG4gICAgICAgICAgICAgICAgJGVsZW1lbnQudHJpZ2dlcihuYW1lc3BhY2VfcHJlZml4KydMb2FkLicrbmFtZXNwYWNlX3ByZWZpeCwgWyRlbGVtZW50XSk7XG5cbiAgICAgICAgICAgICAgICBjYWxsYmFjay5jYWxsKGVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrID0gJC5ub29wO1xuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgJGVsZW1lbnQuZGF0YShuYW1lc3BhY2UsIGxvYWRfaW5zdGFuY2UpO1xuXG4gICAgICAgICAgICBpZiggc2V0dGluZ3MudmlzaWJsZSApe1xuXG4gICAgICAgICAgICAgICAgaWYoICQubml0ZSApXG4gICAgICAgICAgICAgICAgICAgICQubml0ZS5zY3JvbGwoZXZlbnRfbmFtZXNwYWNlLCBmdW5jdGlvbigpeyBsb2FkX2luc3RhbmNlLmxvb3AoKTsgfSwgeyBmcHMgOiAyNSB9KTtcblxuICAgICAgICAgICAgICAgIGVsc2V7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdGhyb3R0bGVfc2Nyb2xsX2V2ZW50ID0gZnVuY3Rpb24oZm4sIHdhaXQpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHRpbWUgPSBEYXRlLm5vdygpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCh0aW1lICsgd2FpdCAtIERhdGUubm93KCkpIDwgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aW1lID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICAkd2luZG93Lm9uKCdzY3JvbGwuJytldmVudF9uYW1lc3BhY2UsIHRocm90dGxlX3Njcm9sbF9ldmVudChmdW5jdGlvbigpeyBsb2FkX2luc3RhbmNlLmxvb3AoKTsgfSwgMTAwMCkpO1xuXG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfSk7XG5cbiAgICB9O1xuXG59KSh3aW5kb3csIGRvY3VtZW50LCBqUXVlcnkpOyJdfQ==
