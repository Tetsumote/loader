"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(function(a,b,c){"use strict";if(!c)return console.error("jQuery is needed for $.fn.nitePreload(), $.nitePreload, $.niteLazyLoad to work!"),void 0;var d="nite",f=d+"Preload",g=d+"er",h=c(b),i=function(a){var b=c();if("string"!=typeof a)return!1;try{b=c(a)}catch(a){return!1}return b.length},j=function(){function a(){_classCallCheck(this,a),this._resource=null,this._$resource=c(),this._type=null,this._instance=null,this._processed=!1,this.callback=function(a){this._processed||(this._$resource.trigger(a.type+"."+d),h.trigger(a.type+"."+d,[this._$resource]))}}return _createClass(a,[{key:"complete",value:function(a){switch(this._type){case"image":this._$resource[this._processed?"on":"one"]("load."+this._instance+" error."+this._instance,function(b){this.callback(b,a)});var b=this._$resource.closest("picture");b.length?(this._$resource.removeData("srcset").removeAttr("data-srcset").removeData("src").removeAttr("data-src"),b.find("source[data-srcset]").attr("srcset",b.data("srcset")).removeData("srcset").removeAttr("data-srcset")):(this._$resource.is("[data-srcset]")&&this._$resource.attr("srcset",this._$resource.data("srcset")).removeData("srcset").removeAttr("data-srcset"),this._$resource.is("[data-src]")&&this._$resource.attr("src",this._$resource.data("src")).removeData("src").removeAttr("data-src")),!0===this._resource.complete&&0!==this._resource.naturalWidth&&0!==this._resource.naturalHeight&&(!this._processed&&this._$resource.off("."+this._instance),this.callback(new Event(void 0===this._resource.naturalWidth?"error":"load"),a));break;case"media":break;case"iframe":}this._processed||this._$resource.data(g,this._instance)}},{key:"resource",set:function(a){"string"==typeof a,"object"===("undefined"==typeof a?"undefined":_typeof(a))&&"element"in a&&(this._resource=a.element,this._type=a.type),this._$resource=c(this._resource),this._instance=this._$resource.data(g),this._processed=void 0!==this._instance,this._instance=this._processed?this._instance:g+"_unique_"+(c.nite?c.nite.uniqueId():Math.random(1e3,9999))}}]),a}(),k=function(){function a(b,d){if(_classCallCheck(this,a),this._collection=[],c.isArray(b)&&("string"==typeof b[0]||"object"===_typeof(b[0])&&"subject"in b[0])&&(this._collection=b),"string"==typeof b&&this._collection.push(b),this._settings=c.extend(!0,{sequential:!1,pipelineDelay:0,playthrough:!1},d),this._callback=c.noop(),this._progress=c.noop(),this._abort=!1,this._collection.length)if(!0!==this._settings.sequential)for(var f,g=0;g<this._collection.length&&!this._abort;g++)f=new j,f.resource=this._collection[g],f.complete(function(){this._abort});else{var h=-1,i=function a(){h++;var b=new j;b.resource=this._collection[h],b.complete(function(){this._abort||setTimeout(a,c.isNumeric(this._settings.pipelineDelay)?parseInt(this._settings.pipelineDelay):0)})};i()}}return _createClass(a,[{key:"done",value:function(a){if(c.isFunction(a)){var b=this,d=function(){a.call(b)};this.collection.length?this._callback=d:d()}}},{key:"progress",value:function(a){if(c.isFunction(a)){var b=this,d=function(){a.call(b)};this._collection.length?this._progress=d:d()}}},{key:"abort",value:function(){this._collection.length&&(this._abort=!0)}}]),a}();c[f]=k,c.fn[f]=function(a,b){c.isFunction(a)&&(b=a),c.isFunction(b)||(b=c.noop),"object"!==("undefined"==typeof a?"undefined":_typeof(a))&&(a={});var d=["src","data-src","srcset","data-nite-src"],f=c.extend(!0,{sequential:!1,pipelineDelay:0,attributes:d,backgrounds:!1,playthrough:!1},a);return c.isArray(f.attributes)||(f.attributes=d),"string"==typeof f.attributes&&(f.attributes=f.attributes.split(" ")),this.each(function(){var a=this,d=c(a),h=d.data(g);void 0!==h&&h.abort();var i=[],j="img, video, audio, iframe",l=j+", picture, source";if(i.concat(d.find(j).toArray()),d.is(j)&&i.add(d[0]),!0===f.backgrounds&&d.find("*").addBack().not(l).filter(function(){return"none"!==c(this).css("background-image")}).each(function(){i.push(c(this).css("background-image").replace(/url\(\"|url\(\'|url\(|((\"|\')\)$)/igm,""))}),f.attributes.length){var m=function(a){d.find("["+a+"]:not("+l+")").each(function(){i.push(c(this).attr(a))}),d.is("["+a+"]")&&!d.is(l)&&i.add(d.attr(a))};for(let a in f.attributes)m(a)}h=new k(i,f),h.progress(function(){}),h.done(function(){b.call(a)}),d.data(g,h)})},c[d+"Lazyload"]=function(a){return c.nite&&"inViewport"in c.nite&&"scroll"in c.nite?void c.nite.scroll(g,function(){c(i(a)?a:"[data-nite-src]").inViewport()[f](function(){var a=c(this);a.trigger(e.type+"."+d+"LazyLoad"),h.trigger(e.type+"."+d+"LazyLoad",[a])})},{fps:25}):void console.log("A recent version of $.nite is needed.")}})(window,document,jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5uaXRlLnByZWxvYWRlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiMGtCQUFBLENBQ0EsQ0FBQyxBQUFTLEFBQVEsQUFBVSxBQUFHLGVBQVUsQUFDckMsQ0FFQSxBQUNBLGdCQUFBLEFBQUksQUFBQyxBQUFJLEFBQ0wsR0FDQSxBQUFPLEFBQ1YsQUFDRCxBQUVBLEFBbUVBLGVBeEVJLEFBQVEsTUFBUixBQUFjLEFBQ2QsNkZBd0VBLEdBREosQUFDdUIsT0FDbkIsRUFBbUIsRUFGdkIsQUFFd0MsVUFDcEMsRUFBWSxFQUhoQixBQUdpQyxLQUU3QixFQUxKLEFBS2dCLEFBQUUsS0FFZCxFQUFBLEFBQW9CLEFBQVMsV0FBUyxBQUVsQyxJQUFJLEdBQUosQUFBZSxBQUVmLE9BQUEsQUFBMEIsUUFBckIsQUFBTyxXQUNSLEFBQU8sQUFFWCxZQUFJLEFBRUEsR0FBQSxBQUFXLEFBQUUsQUFFaEIsSUFKRCxDQUlFLEFBQU0sUUFBTyxBQUVYLENBQUEsQUFBTyxBQUVWLFFBRUQsT0FBTyxHQUFQLEFBQWdCLEFBQ25CLE1BdEdnQyxBQTZFckMsRUE3RXFDLEFBd0cvQixZQUVGLGFBQWEsaUJBRVQsYUFBQSxBQUFLLFVBQUwsQUFBa0IsQUFDbEIsVUFBQSxBQUFLLFdBQUwsQUFBa0IsQUFFbEIsU0FBQSxBQUFLLE1BQUwsQUFBa0IsQUFDbEIsVUFBQSxBQUFLLFVBQUwsQUFBa0IsQUFDbEIsVUFBQSxBQUFLLEFBQWEsQUFFbEIsbUJBQUEsQUFBSyxTQUFhLEFBQVMsV0FBRSxBQUV6QixDQUFJLEtBQUosQUFBUyxBQUNMLEFBRUosa0JBQUEsQUFBSyxXQUFMLEFBQWdCLFFBQVEsRUFBQSxBQUFFLEtBQTFCLEFBQXdCLEFBQVMsQUFBSSxBQUNyQyxTQUFBLEFBQVUsUUFBUSxFQUFBLEFBQUUsS0FBcEIsQUFBa0IsQUFBUyxBQUFJLE1BQWtCLENBQUMsS0FBbEQsQUFBaUQsQUFBTSxBQUUxRCxhQVJELEFBVUgsQ0E3SGdDLENBQUEsdUJBQUEsS0FBQSxp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aUIsQUFBUyxBQUVwRSxZQU1KLEFBQUUsS0FBRixBQUFPLEFBQU8sU0FBVyxVQUFVLEFBRS9CLEdBQUcsQUFBa0IsQUFBWSxPQUFqQyxBQUE0QyxtQkFBNUMsQUFBZ0UsQUFBYSxnQkFBa0IsVUFBVSxBQUVyRyxJQUFNLEdBQVEsRUFBZCxBQUFjLEFBQUUsQUFFaEIsUUFBQSxBQUFNLFFBQVEsRUFBQSxBQUFFLEtBQUYsQUFBUyxBQUFJLE1BQTNCLEFBQTRDLEFBQzVDLGNBQUEsQUFBVSxRQUFRLEVBQUEsQUFBRSxLQUFGLEFBQVMsQUFBSSxNQUEvQixBQUFnRCxXQUFoRCxBQUE0RCxBQUFDLEFBRWhFLElBUEQsQUFTSCxFQVhELEVBV0csQ0FBRSxJQVhMLEFBV0csQUFBUSxBQUVkLGtCQW5CTyxBQUFRLElBQVIsQUFBWSxBQUVaLEFBRUgsQUFFRCx3Q0FWSixBQXlCSCxDQXRjRCxHQUFBLEFBc2NHLE9BdGNILEFBc2NXLFNBdGNYLEFBc2NxQiIsImZpbGUiOiJqcXVlcnkubml0ZS5wcmVsb2FkZXIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyohIEpRdWVyeSBIZWF2eSBSZXNvdXJjZXNMb2FkZXIgfCBEYW5pZWxlIEZpb3JvbmkgfCBkZmlvcm9uaTkxQGdtYWlsLmNvbSAqL1xuKGZ1bmN0aW9uKHdpbmRvdywgZG9jdW1lbnQsICQsIHVuZGVmaW5lZCl7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgLy8gfiB+IH4gfiB+IH4gfiB+IH4gfiB+IH5cbiAgICBpZiggISQgKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ2pRdWVyeSBpcyBuZWVkZWQgZm9yICQuZm4ubml0ZVByZWxvYWQoKSwgJC5uaXRlUHJlbG9hZCwgJC5uaXRlTGF6eUxvYWQgdG8gd29yayEnKTtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgLy8gfiB+IH4gfiB+IH4gfiB+IH4gfiB+IH5cblxuICAgIC8qIHRvZG8gbmV3IHNwZWNzIGFzIGZvbGxvd2luZ1xuXG4gICAgLy8gZ2xvYmFsIGluc3RhbmNlIG1vZGVcbiAgICAvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG4gICAgbGV0IHNpdGVMb2FkZXIgPSBuZXcgJC5uaXRlUHJlbG9hZCh7IC8vIG5vIGFyZ3VtZW50cyBvciBvYmplY3Qgb2YgcGFyYW1ldGVyc1xuICAgICAgIHNlbGVjdG9yIDog4oCYZGF0YS1zcmPigJlcbiAgICB9KTtcbiAgICAvLyB1c2VzIGludGVyY2VwdGlvbiBvYnNlcnZlciB0byBmaW5kIGluVmlld3BvcnQgaW1hZ2VzXG4gICAgLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXG4gICAgLy8gc2luZ2xlIGluc3RhbmNlIG1vZGVcbiAgICAvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG4gICAgbGV0IGluc3RhbmNlID0gbmV3ICQubml0ZVByZWxvYWQoWyAvLyBhcnJheVxuICAgICAgIOKAmGltbWFnaW5lLmpwZ+KAmSxcbiAgICAgICDigJhpbW1hZ2luZS5wbmfigJksXG4gICAgICAg4oCYaW1tYWdpbmUuZ2lm4oCZXG4gICAgXSk7XG5cbiAgICBjb25zb2xlLmxvZyhpbnN0YW5jZS5wZXJjZW50YWdlKTtcblxuICAgIGluc3RhbmNlLmFib3J0KCk7XG5cbiAgICBpbnN0YW5jZS5sb2FkZWQoZnVuY3Rpb24odXJsKXtcbiAgICAgICAgLy8gdXJsIGlzIGxvYWRlZOKAplxuICAgIH0pO1xuXG4gICAgaW5zdGFuY2UuZXJyb3IoZnVuY3Rpb24odXJsKXtcbiAgICAgICAgLy8gdXJsIGhhcyBlbmNvdW50ZXJlZCBhIHByb2JsZW1cbiAgICB9KTtcblxuICAgIGluc3RhbmNlLmRvbmUoZnVuY3Rpb24oKXtcbiAgICAgICAvLyBmaW5pdG/igKZcbiAgICB9KTtcbiAgICAvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cbiAgICAvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG4gICAgdHJvdmEgdHV0dGUgbGUgaW1tYWdpbmksIGF1ZGlvIGUgdmlkZW8gZSBsaSBhc3BldHRhLlxuICAgIC8vIG5vdGhpbmcgbG9hZGVkIHlldOKAplxuICAgICQo4oCYZGl2LnBhcmVudCwgaW1nLnRlc3QtaW1hZ2VzLCB2aWRlbyNidW5ueSwgYXVkaW8jbWV0YWxsaWNh4oCZKS5uaXRlUHJlbG9hZCh7XG4gICAgICAgc3JjQXR0ciA6IOKAmGRhdGEtc3Jj4oCZLFxuICAgICAgIGZpbmRCYWNrZ3JvdW5kcyA6IGZhbHNlLFxuICAgICAgIGNhbnBsYXl0aHJvdWdoIDogdHJ1ZSAvLyB2aWRlbyBlIGF1ZGlvIHNlbnphIGludGVycnV6aW9uaVxuICAgIH0sIGZ1bmN0aW9uKCl7XG4gICAgICAgICAvLyBldmVyeXRoaW5nIGxvYWRlZCBhdCB0aGlzIHBvaW50IVxuICAgIH0pO1xuICAgIC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cblxuXG4gICAgLy8gZXZlbnRzXG4gICAgLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuICAgICQoZG9jdW1lbnQpLm9uKOKAmGxvYWQubml0ZSBlcnJvci5uaXRl4oCZLCBmdW5jdGlvbihldmVudCwgJGVsZW1lbnQpe1xuXG4gICAgICAgIC8vICRlbGVtZW50IGlzIGxvYWRlZCBhdCB0aGlzIHBvaW50XG5cbiAgICB9KTtcbiAgICAkKGRvY3VtZW50KS5vbijigJhsb2FkLm5pdGUgZXJyb3Iubml0ZeKAmSwg4oCYLmVsZW1lbnTigJksIGZ1bmN0aW9uKGV2ZW50KXtcblxuICAgICAgICAvLyB0aGlzIGlzIGxvYWRlZCBhdCB0aGlzIHBvaW50XG5cbiAgICB9KTtcbiAgICAkKOKAmC5lbGVtZW504oCZKS5vbijigJhsb2FkLm5pdGUgZXJyb3Iubml0ZeKAmSwgZnVuY3Rpb24oKXtcblxuICAgICAgIC8vIHRoaXMgaXMgbG9hZGVkXG5cbiAgICB9KTtcbiAgICAvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtICovXG5cbiAgICBjb25zdFxuICAgICAgICBuYW1lc3BhY2VfcHJlZml4ID0gJ25pdGUnLFxuICAgICAgICBuYW1lc3BhY2VfbWV0aG9kID0gbmFtZXNwYWNlX3ByZWZpeCsnUHJlbG9hZCcsXG4gICAgICAgIG5hbWVzcGFjZSA9IG5hbWVzcGFjZV9wcmVmaXgrJ2VyJyxcblxuICAgICAgICAkZG9jdW1lbnQgPSAkKGRvY3VtZW50KSxcblxuICAgICAgICBpc192YWxpZF9zZWxlY3RvciA9IGZ1bmN0aW9uKHNlbGVjdG9yKXtcblxuICAgICAgICAgICAgbGV0ICRlbGVtZW50ID0gJCgpO1xuXG4gICAgICAgICAgICBpZiAoIHR5cGVvZihzZWxlY3RvcikgIT09ICdzdHJpbmcnIClcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgIHRyeSB7XG5cbiAgICAgICAgICAgICAgICAkZWxlbWVudCA9ICQoc2VsZWN0b3IpO1xuXG4gICAgICAgICAgICB9IGNhdGNoKGVycm9yKSB7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuICRlbGVtZW50Lmxlbmd0aDtcbiAgICAgICAgfTtcblxuICAgIGNsYXNzIFJlc291cmNlTG9hZGVyIHtcblxuICAgICAgICBjb25zdHJ1Y3Rvcigpe1xuXG4gICAgICAgICAgICB0aGlzLl9yZXNvdXJjZSAgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5fJHJlc291cmNlID0gJCgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0aGlzLl90eXBlICAgICAgPSBudWxsO1xuICAgICAgICAgICAgdGhpcy5faW5zdGFuY2UgID0gbnVsbDtcbiAgICAgICAgICAgIHRoaXMuX3Byb2Nlc3NlZCA9IGZhbHNlO1xuXG4gICAgICAgICAgICB0aGlzLmNhbGxiYWNrICAgPSBmdW5jdGlvbihlKXtcblxuICAgICAgICAgICAgICAgIGlmKCB0aGlzLl9wcm9jZXNzZWQgKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICAgICB0aGlzLl8kcmVzb3VyY2UudHJpZ2dlcihlLnR5cGUgKyAnLicrbmFtZXNwYWNlX3ByZWZpeCk7XG4gICAgICAgICAgICAgICAgJGRvY3VtZW50LnRyaWdnZXIoZS50eXBlICsgJy4nK25hbWVzcGFjZV9wcmVmaXgsIFt0aGlzLl8kcmVzb3VyY2VdKTtcblxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBzZXQgcmVzb3VyY2UoIHJlc291cmNlICl7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmKCB0eXBlb2YgcmVzb3VyY2UgPT09ICdzdHJpbmcnICl7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmKCB0eXBlb2YgcmVzb3VyY2UgPT09ICdvYmplY3QnICYmICdlbGVtZW50JyBpbiByZXNvdXJjZSApe1xuICAgICAgICAgICAgICAgIHRoaXMuX3Jlc291cmNlID0gcmVzb3VyY2UuZWxlbWVudDtcbiAgICAgICAgICAgICAgICB0aGlzLl90eXBlID0gcmVzb3VyY2UudHlwZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdGhpcy5fJHJlc291cmNlID0gJCh0aGlzLl9yZXNvdXJjZSk7XG5cbiAgICAgICAgICAgIHRoaXMuX2luc3RhbmNlICA9IHRoaXMuXyRyZXNvdXJjZS5kYXRhKG5hbWVzcGFjZSk7XG4gICAgICAgICAgICB0aGlzLl9wcm9jZXNzZWQgPSB0aGlzLl9pbnN0YW5jZSAhPT0gdW5kZWZpbmVkO1xuXG4gICAgICAgICAgICB0aGlzLl9pbnN0YW5jZSAgPSB0aGlzLl9wcm9jZXNzZWQgPyB0aGlzLl9pbnN0YW5jZSA6IG5hbWVzcGFjZSArICdfdW5pcXVlXycgKyAoICQubml0ZSA/ICQubml0ZS51bmlxdWVJZCgpIDogTWF0aC5yYW5kb20oMTAwMCwgOTk5OSkgKTtcblxuICAgICAgICB9XG5cbiAgICAgICAgY29tcGxldGUoY2FsbGJhY2spe1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBzd2l0Y2goIHRoaXMuX3R5cGUgKSB7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdpbWFnZSc6XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fJHJlc291cmNlXG4gICAgICAgICAgICAgICAgICAgICAgICBbIHRoaXMuX3Byb2Nlc3NlZCA/ICdvbicgOiAnb25lJ10oJ2xvYWQuJyArIHRoaXMuX2luc3RhbmNlICsgJyBlcnJvci4nICsgdGhpcy5faW5zdGFuY2UsIGZ1bmN0aW9uIChlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNhbGxiYWNrKGUsIGNhbGxiYWNrKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgY29uc3QgJHBpY3R1cmUgPSB0aGlzLl8kcmVzb3VyY2UuY2xvc2VzdCgncGljdHVyZScpO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmICgkcGljdHVyZS5sZW5ndGgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fJHJlc291cmNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZURhdGEoJ3NyY3NldCcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZUF0dHIoJ2RhdGEtc3Jjc2V0JylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlRGF0YSgnc3JjJylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQXR0cignZGF0YS1zcmMnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgJHBpY3R1cmUuZmluZCgnc291cmNlW2RhdGEtc3Jjc2V0XScpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3NyY3NldCcsICRwaWN0dXJlLmRhdGEoJ3NyY3NldCcpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVEYXRhKCdzcmNzZXQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVBdHRyKCdkYXRhLXNyY3NldCcpO1xuXG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmKCB0aGlzLl8kcmVzb3VyY2UuaXMoJ1tkYXRhLXNyY3NldF0nKSApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fJHJlc291cmNlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5hdHRyKCdzcmNzZXQnLCB0aGlzLl8kcmVzb3VyY2UuZGF0YSgnc3Jjc2V0JykpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVEYXRhKCdzcmNzZXQnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAucmVtb3ZlQXR0cignZGF0YS1zcmNzZXQnKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYoIHRoaXMuXyRyZXNvdXJjZS5pcygnW2RhdGEtc3JjXScpIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl8kcmVzb3VyY2VcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoJ3NyYycsIHRoaXMuXyRyZXNvdXJjZS5kYXRhKCdzcmMnKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLnJlbW92ZURhdGEoJ3NyYycpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZW1vdmVBdHRyKCdkYXRhLXNyYycpO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBpZiAodHJ1ZSA9PT0gdGhpcy5fcmVzb3VyY2UuY29tcGxldGUgJiYgdGhpcy5fcmVzb3VyY2UubmF0dXJhbFdpZHRoICE9PSAwICYmIHRoaXMuX3Jlc291cmNlLm5hdHVyYWxIZWlnaHQgIT09IDApIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAhdGhpcy5fcHJvY2Vzc2VkIClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl8kcmVzb3VyY2Uub2ZmKCcuJyArIHRoaXMuX2luc3RhbmNlKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jYWxsYmFjayhuZXcgRXZlbnQodW5kZWZpbmVkICE9PSB0aGlzLl9yZXNvdXJjZS5uYXR1cmFsV2lkdGggPyAnbG9hZCcgOiAnZXJyb3InKSwgY2FsbGJhY2spO1xuXG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgIGNhc2UgJ21lZGlhJzpcblxuXG5cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICAgICAgICBjYXNlICdpZnJhbWUnOlxuXG5cblxuICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgfVxuXG5cbiAgICAgICAgICAgIGlmICggIXRoaXMuX3Byb2Nlc3NlZCApXG4gICAgICAgICAgICAgICAgdGhpcy5fJHJlc291cmNlLmRhdGEobmFtZXNwYWNlLCB0aGlzLl9pbnN0YW5jZSk7XG4gICAgICAgICAgICBcbiAgICAgICAgfTtcblxuICAgIH1cbiAgICBcbiAgICBjbGFzcyBSZXNvdXJjZXNMb2FkZXIge1xuXG4gICAgICAgIGNvbnN0cnVjdG9yKGNvbGxlY3Rpb24sIG9wdGlvbnMpIHtcblxuICAgICAgICAgICAgdGhpcy5fY29sbGVjdGlvbiA9IFtdO1xuXG4gICAgICAgICAgICBpZiAoJC5pc0FycmF5KGNvbGxlY3Rpb24pICYmICggdHlwZW9mIGNvbGxlY3Rpb25bMF0gPT09ICdzdHJpbmcnIHx8IHR5cGVvZiBjb2xsZWN0aW9uWzBdID09PSAnb2JqZWN0JyAmJiAnc3ViamVjdCcgaW4gY29sbGVjdGlvblswXSApKVxuICAgICAgICAgICAgICAgIHRoaXMuX2NvbGxlY3Rpb24gPSBjb2xsZWN0aW9uO1xuXG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvbGxlY3Rpb24gPT09ICdzdHJpbmcnKVxuICAgICAgICAgICAgICAgIHRoaXMuX2NvbGxlY3Rpb24ucHVzaChjb2xsZWN0aW9uKTtcblxuICAgICAgICAgICAgdGhpcy5fc2V0dGluZ3MgPSAkLmV4dGVuZCh0cnVlLCB7XG4gICAgICAgICAgICAgICAgc2VxdWVudGlhbDogZmFsc2UsXG4gICAgICAgICAgICAgICAgcGlwZWxpbmVEZWxheTogMCxcbiAgICAgICAgICAgICAgICBwbGF5dGhyb3VnaDogZmFsc2VcbiAgICAgICAgICAgIH0sIG9wdGlvbnMpO1xuXG4gICAgICAgICAgICB0aGlzLl9jYWxsYmFjayA9ICQubm9vcCgpO1xuICAgICAgICAgICAgdGhpcy5fcHJvZ3Jlc3MgPSAkLm5vb3AoKTtcbiAgICAgICAgICAgIHRoaXMuX2Fib3J0ID0gZmFsc2U7XG5cbiAgICAgICAgICAgIGlmICh0aGlzLl9jb2xsZWN0aW9uLmxlbmd0aCkge1xuXG4gICAgICAgICAgICAgICAgaWYgKHRydWUgIT09IHRoaXMuX3NldHRpbmdzLnNlcXVlbnRpYWwpIHtcblxuICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuX2NvbGxlY3Rpb24ubGVuZ3RoOyBpKyspIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX2Fib3J0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgbG9hZCA9IG5ldyBSZXNvdXJjZUxvYWRlcigpO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkLnJlc291cmNlID0gdGhpcy5fY29sbGVjdGlvbltpXTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgbG9hZC5jb21wbGV0ZShmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyB0b2RvXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fYWJvcnQpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgICAgICBsZXQgaSA9IC0xO1xuXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHNlcXVlbnRpYWxfcmVjdXJzaW9uID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBpKys7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBsb2FkID0gbmV3IFJlc291cmNlTG9hZGVyKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGxvYWQucmVzb3VyY2UgPSB0aGlzLl9jb2xsZWN0aW9uW2ldO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkLmNvbXBsZXRlKGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHRvZG9cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9hYm9ydClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc2V0VGltZW91dChzZXF1ZW50aWFsX3JlY3Vyc2lvbiwgJC5pc051bWVyaWModGhpcy5fc2V0dGluZ3MucGlwZWxpbmVEZWxheSkgPyBwYXJzZUludCh0aGlzLl9zZXR0aW5ncy5waXBlbGluZURlbGF5KSA6IDApO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICAgICAgICAgIHNlcXVlbnRpYWxfcmVjdXJzaW9uKCk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICB9XG5cbiAgICAgICAgZG9uZShjYWxsYmFjayl7XG5cbiAgICAgICAgICAgIGlmKCAhJC5pc0Z1bmN0aW9uKGNhbGxiYWNrKSApXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICBjb25zdFxuICAgICAgICAgICAgICAgIGNvbnRleHQgPSB0aGlzLFxuICAgICAgICAgICAgICAgIF9mdW5jID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2suY2FsbChjb250ZXh0KTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICBpZiggdGhpcy5jb2xsZWN0aW9uLmxlbmd0aCApXG4gICAgICAgICAgICAgICAgdGhpcy5fY2FsbGJhY2sgPSBfZnVuYztcbiAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICBfZnVuYygpO1xuXG4gICAgICAgIH07XG5cbiAgICAgICAgcHJvZ3Jlc3MoY2FsbGJhY2spe1xuXG4gICAgICAgICAgICBpZiggISQuaXNGdW5jdGlvbihjYWxsYmFjaykgKVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgY29uc3RcbiAgICAgICAgICAgICAgICBjb250ZXh0ID0gdGhpcyxcbiAgICAgICAgICAgICAgICBfZnVuYyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLmNhbGwoY29udGV4dCk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgaWYoIHRoaXMuX2NvbGxlY3Rpb24ubGVuZ3RoIClcbiAgICAgICAgICAgICAgICB0aGlzLl9wcm9ncmVzcyA9IF9mdW5jO1xuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAgICAgIF9mdW5jKCk7XG5cbiAgICAgICAgfTtcblxuICAgICAgICBhYm9ydCgpe1xuXG4gICAgICAgICAgICBpZiggIXRoaXMuX2NvbGxlY3Rpb24ubGVuZ3RoIClcbiAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgIHRoaXMuX2Fib3J0ID0gdHJ1ZTtcblxuICAgICAgICB9O1xuXG4gICAgfVxuXG4gICAgJFtuYW1lc3BhY2VfbWV0aG9kXSA9IFJlc291cmNlc0xvYWRlcjtcblxuICAgICQuZm5bbmFtZXNwYWNlX21ldGhvZF0gPSBmdW5jdGlvbihvcHRpb25zLCBjYWxsYmFjayl7XG5cbiAgICAgICAgaWYoICQuaXNGdW5jdGlvbihvcHRpb25zKSApXG4gICAgICAgICAgICBjYWxsYmFjayA9IG9wdGlvbnM7XG4gICAgICAgIGlmKCAhJC5pc0Z1bmN0aW9uKGNhbGxiYWNrKSApXG4gICAgICAgICAgICBjYWxsYmFjayA9ICQubm9vcDtcbiAgICAgICAgaWYoIHR5cGVvZiBvcHRpb25zICE9PSAnb2JqZWN0JyApXG4gICAgICAgICAgICBvcHRpb25zID0ge307XG5cbiAgICAgICAgY29uc3QgZGVmYXVsdF9hdHRyaWJ1dGVzID0gWyAnc3JjJywgJ2RhdGEtc3JjJywgJ3NyY3NldCcsICdkYXRhLW5pdGUtc3JjJyBdO1xuXG4gICAgICAgIGxldCBzZXR0aW5ncyA9ICQuZXh0ZW5kKHRydWUsIHtcbiAgICAgICAgICAgIHNlcXVlbnRpYWwgICAgOiBmYWxzZSxcbiAgICAgICAgICAgIHBpcGVsaW5lRGVsYXkgOiAwLFxuICAgICAgICAgICAgYXR0cmlidXRlcyAgICA6IGRlZmF1bHRfYXR0cmlidXRlcyxcbiAgICAgICAgICAgIGJhY2tncm91bmRzICAgOiBmYWxzZSxcbiAgICAgICAgICAgIHBsYXl0aHJvdWdoICAgOiBmYWxzZVxuICAgICAgICB9LCBvcHRpb25zKTtcblxuICAgICAgICBpZiggISQuaXNBcnJheShzZXR0aW5ncy5hdHRyaWJ1dGVzKSApXG4gICAgICAgICAgICBzZXR0aW5ncy5hdHRyaWJ1dGVzID0gZGVmYXVsdF9hdHRyaWJ1dGVzO1xuICAgICAgICBpZiggdHlwZW9mIHNldHRpbmdzLmF0dHJpYnV0ZXMgPT09ICdzdHJpbmcnIClcbiAgICAgICAgICAgIHNldHRpbmdzLmF0dHJpYnV0ZXMgPSBzZXR0aW5ncy5hdHRyaWJ1dGVzLnNwbGl0KCcgJyk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICBjb25zdCBlbGVtZW50ID0gdGhpcyxcbiAgICAgICAgICAgICAgICAgICRlbGVtZW50ID0gJChlbGVtZW50KTtcblxuICAgICAgICAgICAgbGV0IGluc3RhbmNlID0gJGVsZW1lbnQuZGF0YShuYW1lc3BhY2UpO1xuXG4gICAgICAgICAgICBpZiggdW5kZWZpbmVkICE9PSBpbnN0YW5jZSApXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuYWJvcnQoKTtcblxuICAgICAgICAgICAgLy8gLSAtIC1cbiAgICAgICAgICAgIGxldCBjb2xsZWN0aW9uID0gW107XG5cbiAgICAgICAgICAgIGNvbnN0IHRhcmdldHMgPSAnaW1nLCB2aWRlbywgYXVkaW8sIGlmcmFtZScsXG4gICAgICAgICAgICAgICAgdGFyZ2V0c19leHRlbmRlZCA9IHRhcmdldHMrJywgcGljdHVyZSwgc291cmNlJztcblxuICAgICAgICAgICAgY29sbGVjdGlvbi5jb25jYXQoJGVsZW1lbnQuZmluZCh0YXJnZXRzKS50b0FycmF5KCkpO1xuXG4gICAgICAgICAgICBpZiggJGVsZW1lbnQuaXModGFyZ2V0cykgKVxuICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24uYWRkKCRlbGVtZW50WzBdKTtcblxuICAgICAgICAgICAgaWYoIHRydWUgPT09IHNldHRpbmdzLmJhY2tncm91bmRzIClcbiAgICAgICAgICAgICAgICAkZWxlbWVudC5maW5kKCcqJykuYWRkQmFjaygpLm5vdCh0YXJnZXRzX2V4dGVuZGVkKS5maWx0ZXIoZnVuY3Rpb24oKXsgcmV0dXJuICQodGhpcykuY3NzKCdiYWNrZ3JvdW5kLWltYWdlJykgIT09ICdub25lJzsgfSkuZWFjaChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICBjb2xsZWN0aW9uLnB1c2goICQodGhpcykuY3NzKCdiYWNrZ3JvdW5kLWltYWdlJykucmVwbGFjZSgvdXJsXFwoXFxcInx1cmxcXChcXCd8dXJsXFwofCgoXFxcInxcXCcpXFwpJCkvaWdtLCAnJykgKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYoIHNldHRpbmdzLmF0dHJpYnV0ZXMubGVuZ3RoIClcbiAgICAgICAgICAgICAgICBmb3IoIGxldCBhdHRyIGluIHNldHRpbmdzLmF0dHJpYnV0ZXMgKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgJGVsZW1lbnQuZmluZCgnWycgKyBhdHRyICsgJ106bm90KCcrdGFyZ2V0c19leHRlbmRlZCsnKScpLmVhY2goZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbi5wdXNoKCQodGhpcykuYXR0cihhdHRyKSk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmKCAkZWxlbWVudC5pcygnWycgKyBhdHRyICsgJ10nKSAmJiAhJGVsZW1lbnQuaXModGFyZ2V0c19leHRlbmRlZCkgKVxuICAgICAgICAgICAgICAgICAgICAgICAgY29sbGVjdGlvbi5hZGQoJGVsZW1lbnQuYXR0cihhdHRyKSk7XG5cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyAtIC0gLVxuXG4gICAgICAgICAgICBpbnN0YW5jZSA9IG5ldyBSZXNvdXJjZXNMb2FkZXIoY29sbGVjdGlvbiwgc2V0dGluZ3MpO1xuXG4gICAgICAgICAgICBpbnN0YW5jZS5wcm9ncmVzcyhmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIC8vIHRvZG9cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpbnN0YW5jZS5kb25lKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2suY2FsbChlbGVtZW50KTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkZWxlbWVudC5kYXRhKG5hbWVzcGFjZSwgaW5zdGFuY2UpO1xuXG4gICAgICAgIH0pO1xuXG4gICAgfTtcblxuICAgICRbbmFtZXNwYWNlX3ByZWZpeCsnTGF6eWxvYWQnXSA9IGZ1bmN0aW9uKHNlbGVjdG9yKXtcblxuICAgICAgICBpZiggISQubml0ZSB8fCAhKCAnaW5WaWV3cG9ydCcgaW4gJC5uaXRlICkgfHwgISggJ3Njcm9sbCcgaW4gJC5uaXRlICkgKSB7XG5cbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdBIHJlY2VudCB2ZXJzaW9uIG9mICQubml0ZSBpcyBuZWVkZWQuJyk7XG5cbiAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICB9XG5cbiAgICAgICAgJC5uaXRlLnNjcm9sbChuYW1lc3BhY2UsIGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICQoIGlzX3ZhbGlkX3NlbGVjdG9yKHNlbGVjdG9yKSA/IHNlbGVjdG9yIDogJ1tkYXRhLW5pdGUtc3JjXScgKS5pblZpZXdwb3J0KClbbmFtZXNwYWNlX21ldGhvZF0oZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgICAgIGNvbnN0ICR0aGlzID0gJCh0aGlzKTtcblxuICAgICAgICAgICAgICAgICR0aGlzLnRyaWdnZXIoZS50eXBlICsgJy4nK25hbWVzcGFjZV9wcmVmaXgrJ0xhenlMb2FkJyk7XG4gICAgICAgICAgICAgICAgJGRvY3VtZW50LnRyaWdnZXIoZS50eXBlICsgJy4nK25hbWVzcGFjZV9wcmVmaXgrJ0xhenlMb2FkJywgWyR0aGlzXSk7XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH0sIHsgZnBzIDogMjUgfSk7XG5cbiAgICB9O1xuXG59KSh3aW5kb3csIGRvY3VtZW50LCBqUXVlcnkpOyJdfQ==
