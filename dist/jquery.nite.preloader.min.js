'use strict';(function(a,b,c){'use strict';if(!c)return console.error('jQuery is needed for $.fn.niteCrop() to work!'),void 0;var d=function(){this.image=function(a){a()},this.audio=function(a){a()},this.video=function(a){a()},this.iframe=function(a){a()}},e=function(){return{type:'audio',extension:'mp3'}},f=function(a){var b=[];c.isArray(a)&&(b=a),'string'==typeof a&&b.push(a);var f=c.extend(!0,{pipeline:!1,playthrough:!1},{}),g=c.noop(),h=c.noop(),j=!1,k=b.length;if(!0!==f.pipeline)for(var l=0;l<k&&!j;l++){var i=b[l],m=e(i);d[m](function(){})}else{var n=null,o=-1,p=function a(){o++,n=b[o];var c=e(n);d[c](function(){j||a()})};p()}this.done=function(a){if(c.isFunction(a)){var b=this;g=function(){a.call(b)}}},this.progress=function(a){if(c.isFunction(a)){var b=this;h=function(){a.call(b)}}},this.abort=function(){j=!0}},g=function(a){var b=c();if('string'!=typeof a)return!1;try{b=c(a)}catch(a){return!1}return b.length};c.nitePreload=f,c.niteLazyload=function(a){return c.nite&&'inViewport'in c.nite&&'scroll'in c.nite?void c.nite.scroll('nitePreloader',function(){c(g(a)?a:'[data-nite-src]').inViewport().nitePreload(function(){})},{fps:25}):void console.log('nite is needed, maybe outdated?')};var h=function(a,b,d){var e=[],f=function(a){if(a&&'string'==typeof a){d&&(a=a.replace(/url\(\"|url\(\'|url\(|((\"|\')\)$)/igm,''));var b='_'+Math.round(new Date().getTime()+100*Math.random())+'_';for(var f in a=a.replace(new RegExp('('+formats.image+'|'+formats.audio+'|'+formats.video+')(s|$|,)','igm'),function(a,c){return c+b}).split(new RegExp(b,'igm')),a)-1<c.inArray(e)&&e.push(a[f])}};return a.find('*').addBack().filter(function(){return'none'!==c(this).css('background-image')}).each(function(){f(c(this).css('background-image'))}),d&&a.find('*').addBack().filter(function(){return'none'!==c(this).css('background-image')}).each(function(){f(c(this).css('background-image'))}),e};c.nitePreloaderFinder=h,c.fn.nitePreload=function(a,b){c.isFunction(a)&&void 0===b&&(b=a,a={});var d=['src','data-src','srcset','data-nite-src'],e=c.extend(!0,{pipeline:!1,attributes:d,backgrounds:!1,playthrough:!1},a);return c.isArray(e.attributes)||(e.attributes=d),'string'==typeof e.attributes&&(e.attributes=e.attributes.split(' ')),this.each(function(){var a=c(this),d=a.data('nitePreloader');void 0!==d&&d.abort(),d=new f(h(a,e.attributes,!0===e.backgrounds)),d.progress(function(){}),d.done(function(){b.call(a[0])}),a.data('nitePreloader',d)})}})(window,document,jQuery);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImpxdWVyeS5uaXRlLnByZWxvYWRlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxhQUNBLENBQUMsQUFBUyxBQUFRLEFBQVUsQUFBRyxlQUFVLEFBQ3JDLENBRUEsQUFDQSxBQUNBLEFBQ0EsQUFJQSxBQUNBLGdCQUFBLEFBQUksQUFBQyxBQUFJLEFBQ0wsR0FDQSxBQUFPLEFBQ1YsQUFDRCxBQUVBLEFBb0NBLGVBekNJLEFBQVEsTUFBUixBQUFjLEFBQ2QsMkRBd0NBLEdBQUEsQUFBVSxVQUFVLEFBRWhCLE1BQUEsQUFBSyxNQUFRLEFBQVMsV0FBUyxBQUUzQixDQUVILEdBSkQsQUFNQSxPQUFBLEFBQUssTUFBUSxBQUFTLFdBQVMsQUFFM0IsQ0FFSCxHQUpELEFBTUEsT0FBQSxBQUFLLE1BQVEsQUFBUyxXQUFTLEFBRTNCLENBRUgsR0FKRCxBQU9BLE9BQUEsQUFBSyxPQUFTLEFBQVMsV0FBUyxBQUU1QixDQUVILEdBSkQsQUFNSCxDQTNCTCxFQTRCSSxFQUFBLEFBQW9CLFVBQVUsQUFFMUIsQUFFQSxPQUFPLEFBQ0gsTUFERyxBQUNJLEFBQVMsQUFDaEIsa0JBRkosQUFBTyxBQUVTLEFBR25CLE1BckNMLEVBc0NJLEVBQUEsQUFBc0IsQUFBUyxXQUFTLEFBRXBDLENBQUEsQUFBSSxBQUFVLEdBQWQsQUFDSSxBQUFhLEFBRWpCLE1BQUksRUFBSixBQUFJLEFBQUUsQUFBUSxhQUNWLEFBQWEsQUFFakIsS0FBQSxBQUF3QixRQUFwQixBQUFPLFlBQ1AsRUFBQSxBQUFXLEFBQUssQUFFcEIsV0FBSSxHQUFXLEVBQUEsQUFBRSxBQUFPLFVBQU0sQUFDdEIsQ0FEc0IsQUFDUixBQUNkLFlBRlIsQUFBZSxBQUFlLEFBRVIsQUFDZixvQkFDSCxFQUFXLEVBSmYsQUFJZSxBQUFFLE9BQ2IsRUFBVyxFQUxmLEFBS2UsQUFBRSxPQUxqQixBQU1JLEFBQVEsS0FDUixFQUFrQixFQVB0QixBQU9pQyxBQUVqQyxVQUFJLEtBQVMsRUFBYixBQUFzQixBQUFXLEFBRTdCLGFBQUssR0FBSSxHQUFULEFBQWEsRUFBYixBQUFnQixBQUFJLFFBQXBCLEFBQXFDLEFBQUssQUFFdEMsQUFBSSxBQUNBLEFBRUosUUFBSSxHQUFKLEFBQWUsQUFBVyxLQUN0QixFQURKLEFBQ29CLEFBQWtCLEFBRXRDLEtBQUEsQUFBUSxLQUFlLFVBQVksQUFFL0IsQUFBSSxBQUNBLEFBRUosQUFFSCxDQWpCVCxBQVVRLEFBU0gsQUFFSixPQUFJLEFBRUQsSUFBSSxHQUFKLEFBQWUsS0FDWCxFQUFJLENBRFIsQUFDUyxFQUNMLEVBQUEsQUFBcUIsWUFBVSxBQUUzQixDQUVBLE1BQUEsQUFBVyxBQUFXLEFBQ3RCLFFBQUksR0FBSixBQUFvQixBQUFrQixBQUV0QyxLQUFBLEFBQVEsS0FBZSxVQUFZLEFBRS9CLEFBQUksQUFDQSxBQUVKLEFBRUEsSUFFSCxHQVRELEFBV0gsRUFwQkwsQUFzQkEsRUFFSCxHQUVELE1BQUEsQUFBSyxLQUFPLEFBQVMsV0FBSyxBQUV0QixDQUFJLEdBQUMsRUFBTCxBQUFLLEFBQUUsQUFBVyxBQUNkLEFBRUosa0JBQUksR0FBSixBQUFjLEFBRWQsT0FBVyxVQUFVLEFBQ2pCLEdBQUEsQUFBSyxBQUFLLEFBQ2IsT0FGRCxBQUlILEVBWEQsQUFhQSxPQUFBLEFBQUssU0FBVyxBQUFTLFdBQUssQUFFMUIsQ0FBSSxHQUFDLEVBQUwsQUFBSyxBQUFFLEFBQVcsQUFDZCxBQUVKLGtCQUFJLEdBQUosQUFBYyxBQUVkLE9BQVcsVUFBVSxBQUNqQixHQUFBLEFBQUssQUFBSyxBQUNiLE9BRkQsQUFJSCxFQVhELEFBYUEsT0FBQSxBQUFLLE1BQVEsVUFBVSxBQUVuQixDQUFBLEFBQVEsQUFFWCxJQUpELEFBTUgsQ0EzSUwsRUE0SUksRUFBQSxBQUFvQixBQUFTLFdBQVMsQUFFbEMsSUFBSSxHQUFKLEFBQWUsQUFFZixPQUFBLEFBQTBCLFFBQXJCLEFBQU8sV0FDUixBQUFPLEFBRVgsWUFBSSxBQUVBLEdBQUEsQUFBVyxBQUFFLEFBRWhCLElBSkQsQ0FJRSxBQUFNLFFBQU8sQUFFWCxDQUFBLEFBQU8sQUFFVixRQUVELE9BQU8sR0FBUCxBQUFnQixBQUNuQixNQTlKTCxBQWdLQSxJQUFBLEFBQUUsQUFBYyxBQUVoQixnQkFBQSxBQUFFLGFBQWUsQUFBUyxXQUFTLEFBRS9CLE9BQUssR0FBRCxBQUFHLEFBQVEsSUFBWCxFQUFjLGNBQWdCLEdBQTlCLEFBQVcsQUFBcUIsQUFBVSxNQUFHLFVBQVksR0FBN0QsQUFBOEMsQUFBaUIsQUFBUyxBQUVwRSxZQU1KLEFBQUUsS0FBRixBQUFPLE9BQVAsQUFBYyxnQkFBaUIsVUFBVSxBQUVyQyxHQUFHLEFBQWtCLEFBQVksT0FBakMsQUFBNEMsbUJBQTVDLEFBQWdFLGFBQWhFLEFBQTZFLFlBQVksVUFBVSxBQUUvRixBQUVILENBSkQsQUFNSCxFQVJELEVBUUcsQ0FBRSxJQVJMLEFBUUcsQUFBUSxBQUVkLGtCQWhCTyxBQUFRLElBQVIsQUFBWSxBQUVaLEFBRUgsQUFFRCxrQ0FWSixBQXVCQSxBQXFDQSxLQUFJLEdBQUEsQUFBd0IsQUFBUyxBQUFVLEFBQVksZUFBWSxBQUVuRSxJQUFBLEFBQUksQUFBYSxNQUNiLEVBQUEsQUFBVSxBQUFTLFdBQUssQUFFcEIsSUFBSSxBQUFDLEdBQUwsQUFBNkIsQUFDekIsQUFFSixBQUFJLFFBSFMsQUFBTyxnQkFJaEIsRUFBTyxFQUFBLEFBQUssUUFBTCxBQUFhLHdDQUFwQixBQUFPLEFBQXNELEFBRWpFLFFBQUksR0FBVyxJQUFNLEtBQUEsQUFBSyxNQUFPLEdBQUEsQUFBSSxRQUFKLEFBQVcsVUFBN0IsQUFBTSxBQUFxRCxHQUFoQixNQUFBLEFBQUssVUFBL0QsQUFBb0YsQUFFcEYsUUFJSyxHQUFMLEFBQVMsQUFBSyxBQUNWLFFBTEcsRUFBQSxBQUNFLFFBQVEsR0FBQSxBQUFJLFFBQU8sSUFBTSxRQUFOLEFBQWMsTUFBZCxBQUFzQixJQUFNLFFBQTVCLEFBQW9DLE1BQXBDLEFBQTRDLElBQU0sUUFBbEQsQUFBMEQsTUFBckUsQUFBNkUsV0FEdkYsQUFDVSxBQUEyRixPQUFRLEFBQVMsQUFBTyxBQUFJLGFBQUcsQUFBRSxPQUFBLEFBQU8sQUFBSyxBQUFXLElBRDdKLEdBQUEsQUFFRSxNQUFNLEdBQUEsQUFBSSxBQUFPLFVBRjFCLEFBQU8sQUFFUSxBQUFxQixBQUVwQyxVQUNnQyxDQUE1QixBQUE2QixDQUF6QixHQUFBLEFBQUUsQUFBUSxZQUNWLEVBQUEsQUFBVyxLQUZuQixBQUVRLEFBQWdCLEFBQUssQUFFaEMsTUFuQkwsQUFxQkEsRUFTQSxBQUFPLEFBRVYsU0FYRyxBQUFTLEtBQVQsQUFBYyxLQUFkLEFBQW1CLFVBQW5CLEFBQTZCLE9BQU8sVUFBVSxBQUFFLE9BQUEsQUFBMkMsQUFBUyxNQUE3QyxLQUFBLEFBQUUsTUFBRixBQUFRLElBQVIsQUFBWSxtQkFBbkUsR0FBQSxBQUFzRyxLQUFLLFVBQVUsQUFDakgsR0FBUyxFQUFBLEFBQUUsTUFBRixBQUFRLElBQWpCLEFBQVMsQUFBWSxBQUN4QixvQkFGRCxBQUlBLEFBQUksTUFDQSxFQUFBLEFBQVMsS0FBVCxBQUFjLEtBQWQsQUFBbUIsVUFBbkIsQUFBNkIsT0FBTyxVQUFVLEFBQUUsT0FBQSxBQUEyQyxBQUFTLE1BQTdDLEtBQUEsQUFBRSxNQUFGLEFBQVEsSUFBUixBQUFZLG1CQUFuRSxHQUFBLEFBQXNHLEtBQUssVUFBVSxBQUNqSCxHQUFTLEVBQUEsQUFBRSxNQUFGLEFBQVEsSUFBakIsQUFBUyxBQUFZLEFBQ3hCLG9CQUZELEFBSUosSUFoQ0osQUFvQ0EsSUFBQSxBQUFFLEFBQXNCLEFBRXhCLHdCQUFBLEFBQUUsR0FBRixBQUFLLFlBQWMsQUFBUyxBQUFTLGFBQVMsQUFFMUMsQ0FBSSxFQUFBLEFBQUUsQUFBVyxlQUFqQixBQUE2QixBQUFjLEFBQVUsQUFDakQsYUFBQSxBQUFXLEFBQ1gsSUFBQSxBQUFVLEFBQ2IsQUFFRCxTQUFBLEFBQUksQUFBcUIsQUFBRSxBQUFPLEFBQVksQUFBVSwrQ0FDcEQsRUFBVyxFQUFBLEFBQUUsQUFBTyxVQUFNLEFBQ3RCLENBRHNCLEFBQ1IsQUFDZCxZQUZzQixBQUVSLEFBQ2QsYUFIc0IsQUFHUixBQUNkLGVBTFIsQUFDZSxBQUFlLEFBSVIsQUFDZixBQUVQLEFBQUkseUJBQUMsR0FBQSxBQUFFLFFBQVEsRUFBZixBQUFLLEFBQW1CLGNBQ3BCLEVBQUEsQUFBUyxBQUFhLEFBQzFCLGNBQUEsQUFBbUMsUUFBL0IsUUFBTyxHQUFQLEFBQWdCLGFBQ2hCLEVBQUEsQUFBUyxXQUFhLEVBQUEsQUFBUyxXQUFULEFBQW9CLE1BQTFDLEFBQXNCLEFBQTBCLEFBRXBELE1BQU8sS0FBQSxBQUFLLEtBQUssVUFBVSxBQUV2QixJQUFJLEdBQVcsRUFBZixBQUFlLEFBQUUsTUFDYixFQUFXLEVBQUEsQUFBUyxLQUR4QixBQUNlLEFBQWMsQUFHN0IsaUJBQUEsQUFBSSxBQUFjLFlBQ2QsRUFBQSxBQUFTLEFBRWIsVUFBVyxBQUFJLE1BQW9CLEFBQXNCLElBQVUsRUFBaEMsQUFBeUMsV0FBWSxLQUFTLEVBQWpHLEFBQVcsQUFBd0IsQUFBdUUsQUFFMUcsZ0JBQUEsQUFBUyxTQUFTLFVBQVUsQUFDeEIsQUFDSCxDQUZELEFBSUEsS0FBQSxBQUFTLEtBQUssVUFBVSxBQUNwQixHQUFBLEFBQVMsS0FBSyxFQUFkLEFBQWMsQUFBUyxBQUMxQixHQUZELEFBSUEsS0FBQSxBQUFTLEtBQVQsQUFBYyxBQUFpQixBQUdsQyxrQkF0QkQsQUFBTyxBQXdCVixFQTVDRCxBQThDSCxDQXZXRCxHQUFBLEFBdVdHLE9BdldILEFBdVdXLFNBdldYLEFBdVdxQiIsImZpbGUiOiJqcXVlcnkubml0ZS5wcmVsb2FkZXIubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLyohIEpRdWVyeSBIZWF2eSBQcmVsb2FkZXIgfCBEYW5pZWxlIEZpb3JvbmkgfCBkZmlvcm9uaTkxQGdtYWlsLmNvbSAqL1xuKGZ1bmN0aW9uKHdpbmRvdywgZG9jdW1lbnQsICQsIHVuZGVmaW5lZCl7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgLy8gdG9kbzogc3VwcG9ydCA8cGljdHVyZT4gP1xuICAgIC8vIHRvZG86IHN1cHBvcnQgPGlmcmFtZT4gLS0+ICRpZnJhbWVbMF0ubG9hZCgpO1xuICAgIC8vIHRvZG86IHByZWxvYWQgdmlkZW8gcG9zdGVyID9cbiAgICAvLyB0b2RvOiBtYWtlIHNyY3NldCB0byBsb2FkIG9ubHkgb25lIHBpYyAodGhlIGN1cnJlbnQgb25lKSAtLT4gZG9uZSBhbHJlYWR5P1xuXG5cblxuICAgIC8vIH4gfiB+IH4gfiB+IH4gfiB+IH4gfiB+XG4gICAgaWYoICEkICkge1xuICAgICAgICBjb25zb2xlLmVycm9yKCdqUXVlcnkgaXMgbmVlZGVkIGZvciAkLmZuLm5pdGVDcm9wKCkgdG8gd29yayEnKVxuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICAvLyB+IH4gfiB+IH4gfiB+IH4gfiB+IH4gflxuXG4gICAgLyogdG9kbyBuZXcgc3BlY3MgYXMgZm9sbG93aW5nXG5cbiAgICAvLyBnbG9iYWwgaW5zdGFuY2UgbW9kZVxuICAgIC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cbiAgICBsZXQgc2l0ZUxvYWRlciA9IG5ldyAkLm5pdGVQcmVsb2FkKHsgLy8gbm8gYXJndW1lbnRzIG9yIG9iamVjdCBvZiBwYXJhbWV0ZXJzXG4gICAgICAgc2VsZWN0b3IgOiDigJhkYXRhLXNyY+KAmVxuICAgIH0pO1xuICAgIC8vIHVzZXMgaW50ZXJjZXB0aW9uIG9ic2VydmVyIHRvIGZpbmQgaW5WaWV3cG9ydCBpbWFnZXNcbiAgICAvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG5cbiAgICAvLyBzaW5nbGUgaW5zdGFuY2UgbW9kZVxuICAgIC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cbiAgICBsZXQgaW5zdGFuY2UgPSBuZXcgJC5uaXRlUHJlbG9hZChbIC8vIGFycmF5XG4gICAgICAg4oCYaW1tYWdpbmUuanBn4oCZLFxuICAgICAgIOKAmGltbWFnaW5lLnBuZ+KAmSxcbiAgICAgICDigJhpbW1hZ2luZS5naWbigJlcbiAgICBdKTtcblxuICAgIGNvbnNvbGUubG9nKGluc3RhbmNlLnBlcmNlbnRhZ2UpO1xuXG4gICAgaW5zdGFuY2UuYWJvcnQoKTtcblxuICAgIGluc3RhbmNlLmxvYWRlZChmdW5jdGlvbih1cmwpe1xuICAgICAgICAvLyB1cmwgaXMgbG9hZGVk4oCmXG4gICAgfSk7XG5cbiAgICBpbnN0YW5jZS5lcnJvcihmdW5jdGlvbih1cmwpe1xuICAgICAgICAvLyB1cmwgaGFzIGVuY291bnRlcmVkIGEgcHJvYmxlbVxuICAgIH0pO1xuXG4gICAgaW5zdGFuY2UuZG9uZShmdW5jdGlvbigpe1xuICAgICAgIC8vIGZpbml0b+KAplxuICAgIH0pO1xuICAgIC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gKi9cblxuXG4gICAgbGV0IGRvX2xvYWQgPSBmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICB0aGlzLmltYWdlID0gZnVuY3Rpb24oY2FsbGJhY2spe1xuXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcblxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGhpcy5hdWRpbyA9IGZ1bmN0aW9uKGNhbGxiYWNrKXtcblxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG5cbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXMudmlkZW8gPSBmdW5jdGlvbihjYWxsYmFjayl7XG5cbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuXG4gICAgICAgICAgICB9O1xuXG5cbiAgICAgICAgICAgIHRoaXMuaWZyYW1lID0gZnVuY3Rpb24oY2FsbGJhY2spe1xuXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcblxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9LFxuICAgICAgICBnZXRfcmVzb3VyY2VfaW5mbyA9IGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgIC8vIHJlY29nbml0aW9uIHN0dWZmXG5cbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgdHlwZSA6ICdhdWRpbycsIC8vIHZpZGVvIGltYWdlIGlmcmFtZSBldGNcbiAgICAgICAgICAgICAgICBleHRlbnNpb24gOiAnbXAzJ1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0sXG4gICAgICAgIG5pdGVfcHJlbG9hZGVyX2NvcmUgPSBmdW5jdGlvbihhcmd1bWVudCl7XG5cbiAgICAgICAgICAgIGxldCBvcHRpb25zID0ge30sXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbiA9IFtdO1xuXG4gICAgICAgICAgICBpZiggJC5pc0FycmF5KGFyZ3VtZW50KSApXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbiA9IGFyZ3VtZW50O1xuXG4gICAgICAgICAgICBpZiggdHlwZW9mIGFyZ3VtZW50ID09PSAnc3RyaW5nJyApXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbi5wdXNoKGFyZ3VtZW50KTtcblxuICAgICAgICAgICAgbGV0IHNldHRpbmdzID0gJC5leHRlbmQodHJ1ZSwge1xuICAgICAgICAgICAgICAgICAgICBwaXBlbGluZSAgICA6IGZhbHNlLFxuICAgICAgICAgICAgICAgICAgICBwbGF5dGhyb3VnaCA6IGZhbHNlXG4gICAgICAgICAgICAgICAgfSwgb3B0aW9ucyksXG4gICAgICAgICAgICAgICAgY2FsbGJhY2sgPSAkLm5vb3AoKSxcbiAgICAgICAgICAgICAgICBwcm9ncmVzcyA9ICQubm9vcCgpLFxuICAgICAgICAgICAgICAgIGFib3J0ID0gZmFsc2UsXG4gICAgICAgICAgICAgICAgY29sbGVjdGlvbl9zaXplID0gY29sbGVjdGlvbi5sZW5ndGg7XG5cbiAgICAgICAgICAgIGlmKCB0cnVlICE9PSBzZXR0aW5ncy5waXBlbGluZSApIHtcblxuICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY29sbGVjdGlvbl9zaXplOyBpKyspIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoYWJvcnQpXG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICBsZXQgcmVzb3VyY2UgPSBjb2xsZWN0aW9uW2ldLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2VfdHlwZSA9IGdldF9yZXNvdXJjZV9pbmZvKHJlc291cmNlKTtcblxuICAgICAgICAgICAgICAgICAgICBkb19sb2FkW3Jlc291cmNlX3R5cGVdKGZ1bmN0aW9uICgpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFib3J0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZG8gc3R1ZmYuLi5cblxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgfWVsc2V7XG5cbiAgICAgICAgICAgICAgICBsZXQgcmVzb3VyY2UgPSBudWxsLFxuICAgICAgICAgICAgICAgICAgICBpID0gLTEsXG4gICAgICAgICAgICAgICAgICAgIHBpcGVsaW5lX3JlY3Vyc2lvbiA9IGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGkrKztcblxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzb3VyY2UgPSBjb2xsZWN0aW9uW2ldO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHJlc291cmNlX3R5cGUgPSBnZXRfcmVzb3VyY2VfaW5mbyhyZXNvdXJjZSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGRvX2xvYWRbcmVzb3VyY2VfdHlwZV0oZnVuY3Rpb24gKCkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFib3J0KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBkbyBzdHVmZi4uLlxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcGlwZWxpbmVfcmVjdXJzaW9uKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICBwaXBlbGluZV9yZWN1cnNpb24oKTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmRvbmUgPSBmdW5jdGlvbihmdW5jKXtcblxuICAgICAgICAgICAgICAgIGlmKCAhJC5pc0Z1bmN0aW9uKGZ1bmMpIClcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgbGV0IGNvbnRleHQgPSB0aGlzO1xuXG4gICAgICAgICAgICAgICAgY2FsbGJhY2sgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICBmdW5jLmNhbGwoY29udGV4dCk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdGhpcy5wcm9ncmVzcyA9IGZ1bmN0aW9uKGZ1bmMpe1xuXG4gICAgICAgICAgICAgICAgaWYoICEkLmlzRnVuY3Rpb24oZnVuYykgKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICAgICBsZXQgY29udGV4dCA9IHRoaXM7XG5cbiAgICAgICAgICAgICAgICBwcm9ncmVzcyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIGZ1bmMuY2FsbChjb250ZXh0KTtcbiAgICAgICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB9O1xuXG4gICAgICAgICAgICB0aGlzLmFib3J0ID0gZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgICAgIGFib3J0ID0gdHJ1ZTtcblxuICAgICAgICAgICAgfTtcblxuICAgICAgICB9LFxuICAgICAgICBpc192YWxpZF9zZWxlY3RvciA9IGZ1bmN0aW9uKHNlbGVjdG9yKXtcblxuICAgICAgICAgICAgbGV0ICRlbGVtZW50ID0gJCgpO1xuXG4gICAgICAgICAgICBpZiAoIHR5cGVvZihzZWxlY3RvcikgIT09ICdzdHJpbmcnIClcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgIHRyeSB7XG5cbiAgICAgICAgICAgICAgICAkZWxlbWVudCA9ICQoc2VsZWN0b3IpO1xuXG4gICAgICAgICAgICB9IGNhdGNoKGVycm9yKSB7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuICRlbGVtZW50Lmxlbmd0aDtcbiAgICAgICAgfTtcblxuICAgICQubml0ZVByZWxvYWQgPSBuaXRlX3ByZWxvYWRlcl9jb3JlO1xuXG4gICAgJC5uaXRlTGF6eWxvYWQgPSBmdW5jdGlvbihzZWxlY3Rvcil7XG5cbiAgICAgICAgaWYoICEkLm5pdGUgfHwgISggJ2luVmlld3BvcnQnIGluICQubml0ZSApIHx8ICEoICdzY3JvbGwnIGluICQubml0ZSApICkge1xuXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnbml0ZSBpcyBuZWVkZWQsIG1heWJlIG91dGRhdGVkPycpO1xuXG4gICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgfVxuXG4gICAgICAgICQubml0ZS5zY3JvbGwoJ25pdGVQcmVsb2FkZXInLCBmdW5jdGlvbigpe1xuXG4gICAgICAgICAgICAkKCBpc192YWxpZF9zZWxlY3RvcihzZWxlY3RvcikgPyBzZWxlY3RvciA6ICdbZGF0YS1uaXRlLXNyY10nICkuaW5WaWV3cG9ydCgpLm5pdGVQcmVsb2FkKGZ1bmN0aW9uKCl7XG5cbiAgICAgICAgICAgICAgICAvLyAuLi5cblxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgfSwgeyBmcHMgOiAyNSB9KTtcblxuICAgIH07XG5cblxuICAgIC8qIHRvZG8gbmV3IHNwZWNzIGFzIGZvbGxvd2luZ1xuXG5cblxuICAgIC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC1cbiAgICB0cm92YSB0dXR0ZSBsZSBpbW1hZ2luaSwgYXVkaW8gZSB2aWRlbyBlIGxpIGFzcGV0dGEuXG4gICAgLy8gbm90aGluZyBsb2FkZWQgeWV04oCmXG4gICAgJCjigJhkaXYucGFyZW50LCBpbWcudGVzdC1pbWFnZXMsIHZpZGVvI2J1bm55LCBhdWRpbyNtZXRhbGxpY2HigJkpLm5pdGVQcmVsb2FkKHtcbiAgICAgICBzcmNBdHRyIDog4oCYZGF0YS1zcmPigJksXG4gICAgICAgZmluZEJhY2tncm91bmRzIDogZmFsc2UsXG4gICAgICAgY2FucGxheXRocm91Z2ggOiB0cnVlIC8vIHZpZGVvIGUgYXVkaW8gc2VuemEgaW50ZXJydXppb25pXG4gICAgfSwgZnVuY3Rpb24oKXtcbiAgICAgICAgIC8vIGV2ZXJ5dGhpbmcgbG9hZGVkIGF0IHRoaXMgcG9pbnQhXG4gICAgfSk7XG4gICAgLy8gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLVxuXG5cbiAgICAvLyBldmVudHNcbiAgICAvLyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtXG4gICAgJChkb2N1bWVudCkub24o4oCYbG9hZC5uaXRlIGVycm9yLm5pdGXigJksIGZ1bmN0aW9uKGV2ZW50LCAkZWxlbWVudCl7XG5cbiAgICAgICAgLy8gJGVsZW1lbnQgaXMgbG9hZGVkIGF0IHRoaXMgcG9pbnRcblxuICAgIH0pO1xuICAgICQoZG9jdW1lbnQpLm9uKOKAmGxvYWQubml0ZSBlcnJvci5uaXRl4oCZLCDigJguZWxlbWVudOKAmSwgZnVuY3Rpb24oZXZlbnQpe1xuXG4gICAgICAgIC8vIHRoaXMgaXMgbG9hZGVkIGF0IHRoaXMgcG9pbnRcblxuICAgIH0pO1xuICAgICQo4oCYLmVsZW1lbnTigJkpLm9uKOKAmGxvYWQubml0ZSBlcnJvci5uaXRl4oCZLCBmdW5jdGlvbigpe1xuXG4gICAgICAgLy8gdGhpcyBpcyBsb2FkZWRcblxuICAgIH0pO1xuICAgIC8vIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gKi9cblxuXG4gICAgbGV0IG5pdGVfcHJlbG9hZGVyX2ZpbmRlciA9IGZ1bmN0aW9uKCRlbGVtZW50LCBhdHRyaWJ1dGVzLCBiYWNrZ3JvdW5kcyl7XG5cbiAgICAgICAgbGV0IGNvbGxlY3Rpb24gPSBbXSxcbiAgICAgICAgICAgIGNvbGxlY3QgPSBmdW5jdGlvbih1cmxzKXtcblxuICAgICAgICAgICAgICAgIGlmKCAhdXJscyB8fCB0eXBlb2YgdXJscyAhPT0gJ3N0cmluZycgKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICAgICBpZiggYmFja2dyb3VuZHMgKVxuICAgICAgICAgICAgICAgICAgICB1cmxzID0gdXJscy5yZXBsYWNlKC91cmxcXChcXFwifHVybFxcKFxcJ3x1cmxcXCh8KChcXFwifFxcJylcXCkkKS9pZ20sICcnKTtcblxuICAgICAgICAgICAgICAgIGxldCBzcGxpdHRlciA9ICdfJyArIE1hdGgucm91bmQoIG5ldyBEYXRlKCkuZ2V0VGltZSgpICsgKCBNYXRoLnJhbmRvbSgpICogMTAwICkgKSArICdfJztcblxuICAgICAgICAgICAgICAgIHVybHMgPSB1cmxzXG4gICAgICAgICAgICAgICAgICAgICAgICAucmVwbGFjZShuZXcgUmVnRXhwKCcoJyArIGZvcm1hdHMuaW1hZ2UgKyAnfCcgKyBmb3JtYXRzLmF1ZGlvICsgJ3wnICsgZm9ybWF0cy52aWRlbyArICcpKFxcc3wkfFxcLCknLCAnaWdtJyksIGZ1bmN0aW9uKG1hdGNoLCBwMSwgcDIpeyByZXR1cm4gcDEgKyBzcGxpdHRlcjsgfSlcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zcGxpdChuZXcgUmVnRXhwKHNwbGl0dGVyLCAnaWdtJykpO1xuXG4gICAgICAgICAgICAgICAgZm9yKCBsZXQgayBpbiB1cmxzIClcbiAgICAgICAgICAgICAgICAgICAgaWYoICQuaW5BcnJheShjb2xsZWN0aW9uKSA+IC0xIClcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbGxlY3Rpb24ucHVzaCh1cmxzW2tdKTtcblxuICAgICAgICAgICAgfTtcblxuICAgICAgICAkZWxlbWVudC5maW5kKCcqJykuYWRkQmFjaygpLmZpbHRlcihmdW5jdGlvbigpeyByZXR1cm4gJCh0aGlzKS5jc3MoJ2JhY2tncm91bmQtaW1hZ2UnKSAhPT0gJ25vbmUnOyB9KS5lYWNoKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBjb2xsZWN0KCAkKHRoaXMpLmNzcygnYmFja2dyb3VuZC1pbWFnZScpICk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGlmKCBiYWNrZ3JvdW5kcyApXG4gICAgICAgICAgICAkZWxlbWVudC5maW5kKCcqJykuYWRkQmFjaygpLmZpbHRlcihmdW5jdGlvbigpeyByZXR1cm4gJCh0aGlzKS5jc3MoJ2JhY2tncm91bmQtaW1hZ2UnKSAhPT0gJ25vbmUnOyB9KS5lYWNoKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgY29sbGVjdCggJCh0aGlzKS5jc3MoJ2JhY2tncm91bmQtaW1hZ2UnKSApO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGNvbGxlY3Rpb247XG5cbiAgICB9O1xuXG4gICAgJC5uaXRlUHJlbG9hZGVyRmluZGVyID0gbml0ZV9wcmVsb2FkZXJfZmluZGVyO1xuXG4gICAgJC5mbi5uaXRlUHJlbG9hZCA9IGZ1bmN0aW9uKG9wdGlvbnMsIGNhbGxiYWNrKXtcblxuICAgICAgICBpZiggJC5pc0Z1bmN0aW9uKG9wdGlvbnMpICYmIHVuZGVmaW5lZCA9PT0gY2FsbGJhY2sgKXtcbiAgICAgICAgICAgIGNhbGxiYWNrID0gb3B0aW9ucztcbiAgICAgICAgICAgIG9wdGlvbnMgPSB7fTtcbiAgICAgICAgfVxuXG4gICAgICAgIGxldCBkZWZhdWx0X2F0dHJpYnV0ZXMgPSBbICdzcmMnLCAnZGF0YS1zcmMnLCAnc3Jjc2V0JywgJ2RhdGEtbml0ZS1zcmMnIF0sXG4gICAgICAgICAgICBzZXR0aW5ncyA9ICQuZXh0ZW5kKHRydWUsIHtcbiAgICAgICAgICAgICAgICBwaXBlbGluZSAgICA6IGZhbHNlLFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMgIDogZGVmYXVsdF9hdHRyaWJ1dGVzLFxuICAgICAgICAgICAgICAgIGJhY2tncm91bmRzIDogZmFsc2UsXG4gICAgICAgICAgICAgICAgcGxheXRocm91Z2ggOiBmYWxzZVxuICAgICAgICAgICAgfSwgb3B0aW9ucyk7XG5cbiAgICAgICAgaWYoICEkLmlzQXJyYXkoc2V0dGluZ3MuYXR0cmlidXRlcykgKVxuICAgICAgICAgICAgc2V0dGluZ3MuYXR0cmlidXRlcyA9IGRlZmF1bHRfYXR0cmlidXRlcztcbiAgICAgICAgaWYoIHR5cGVvZiBzZXR0aW5ncy5hdHRyaWJ1dGVzID09PSAnc3RyaW5nJyApXG4gICAgICAgICAgICBzZXR0aW5ncy5hdHRyaWJ1dGVzID0gc2V0dGluZ3MuYXR0cmlidXRlcy5zcGxpdCgnICcpO1xuXG4gICAgICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24oKXtcblxuICAgICAgICAgICAgbGV0ICRlbGVtZW50ID0gJCh0aGlzKSxcbiAgICAgICAgICAgICAgICBpbnN0YW5jZSA9ICRlbGVtZW50LmRhdGEoJ25pdGVQcmVsb2FkZXInKTtcblxuXG4gICAgICAgICAgICBpZiggdW5kZWZpbmVkICE9PSBpbnN0YW5jZSApXG4gICAgICAgICAgICAgICAgaW5zdGFuY2UuYWJvcnQoKTtcblxuICAgICAgICAgICAgaW5zdGFuY2UgPSBuZXcgbml0ZV9wcmVsb2FkZXJfY29yZShuaXRlX3ByZWxvYWRlcl9maW5kZXIoJGVsZW1lbnQsIHNldHRpbmdzLmF0dHJpYnV0ZXMsIHRydWUgPT09IHNldHRpbmdzLmJhY2tncm91bmRzKSk7XG5cbiAgICAgICAgICAgIGluc3RhbmNlLnByb2dyZXNzKGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgLy8gdG9kb1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIGluc3RhbmNlLmRvbmUoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBjYWxsYmFjay5jYWxsKCRlbGVtZW50WzBdKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkZWxlbWVudC5kYXRhKCduaXRlUHJlbG9hZGVyJywgaW5zdGFuY2UpO1xuXG5cbiAgICAgICAgfSk7XG5cbiAgICB9O1xuXG59KSh3aW5kb3csIGRvY3VtZW50LCBqUXVlcnkpOyJdfQ==
